(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["284"],{"892":function(e,t,n){"use strict";n.d(t,"r",function(){return x});n.d(t,"t",function(){return T});n.d(t,"i",function(){return N});n.d(t,"s",function(){return k});n.d(t,"e",function(){return L});n.d(t,"n",function(){return A});n.d(t,"o",function(){return O});var r,i,s,o,u,a,f,l,c,h,p=n(0),d=n(487),v=n(1730),m=n(484),g=n(23),y=n(168),b=n(282),w=n(245),E=void 0,S={ODB:1469,ODC:"ChromiumDateFix"};function x(e,t){void 0===t&&(t=!1);return b.n(e,M(m.default.language),t)}function T(e,t,n,r,i){void 0===t&&(t=!1);void 0===n&&(n=!1);void 0===r&&(r=!1);var s=Date.now()-e.getTime(),o=(function(){var e=new Date;e.setHours(0,0,0,0);return e})(),u=H(o,-1),a=H(o,-6),f=i||{},l=f.displayMinutesToOneHour,c=void 0===l||l,h=f.displayHoursToOneDay,p=void 0===h||h,g=f.displayHoursInDates,y=void 0===g||g,E=f.displayShortenedWeekday,S=void 0===E||E,x=M(m.default.language);if(c&&s<-5*w.n)return e.toLocaleDateString(x,j({month:"short",day:"numeric"},r));if(s<w.o)return n?v.e.FriendlyDateTime_JustNow_withinSentence:v.e.FriendlyDateTime_JustNow_asSentence;if(c&&s<w.t)return B(s,v.e.FriendlyDateTime_minutesShort,w.n);if(w.l(o,e))return p?B(s,v.e.FriendlyDateTime_hoursShort,w.t):b.t("Today",n);if(e>=u)return t||!y?b.t("Yesterday",n):b.t("YesterdayAndTime",n).replace("{0}",e.toLocaleTimeString(x,j({hour:"numeric",minute:"2-digit"},r)));if(e>=a){var T=e.toLocaleDateString(x,j({weekday:"short"},r));return t?T:S||y?d.e.RelativeDateTime_DayAndTime.replace("{0}",T).replace("{1}",e.toLocaleTimeString(x,j({hour:"numeric",minute:"2-digit"},r))):e.toLocaleDateString(x,j({weekday:"long"},r))}return w.c(o,e)?x.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(x,j({month:"long",day:"numeric"},r)):e.toLocaleDateString(x,j({month:"short",day:"numeric"},r)):e.toLocaleDateString(x,j({month:"short",day:"numeric",year:"numeric"},r))}function N(e){return b.r(e,M(m.default.language))}function C(){var e=r(),t=_();if(window.Intl&&window.Intl.DateTimeFormat){var n={},i={hour:"2-digit",minute:"2-digit"};s=new Intl.DateTimeFormat(e,n);o=new Intl.DateTimeFormat(e,i);if(t){n.timeZone="UTC";i.timeZone="UTC"}u=new Intl.DateTimeFormat(e,n);a=new Intl.DateTimeFormat(e,i);f=s.format;l=o.format;c=u.format;h=a.format}else{f=c=function(t){return t.toLocaleDateString(e)};l=h=function(t){return t.toLocaleTimeString(e)}}}function k(e,t){if(!e)return"";f||C();var n=w.l(new Date,e);return(t?n?h:c:n?l:f)(e)}function L(e,t){if(!e)return"";f||C();return(t?c:f)(e).replace(/[:\/\\]/g,"-")}function A(e,t){f||C();var n=t?c(e):f(e),r=t?h(e):l(e);return Object(g.format)(v.e.DateAndTime,n,r)}function O(e,t){return w.p(e,M(m.default.language),t)}function M(e){if(void 0===E)try{E=y.default.isFeatureEnabled(S)}catch(e){E=!1}return E&&(function(e){void 0===P&&(function(){P={};var e=new Date(1900,0,1);try{for(var t={month:"long"},n=0,r=D;n<r.length;n++){var i=r[n];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(P[i]=!0)}}catch(e){}})();if(e){e=e.toLowerCase();return P[e]}return})(e)?"en":e}r=function(){for(var e,t=0,n=[window.$Config&&window.$Config.mkt,m.default.language,navigator.language,"en"].filter(function(e){return!!e});t<n.length;t++){var i=n[t];try{(new Date).toLocaleDateString(i);e=i;break}catch(e){}}e=M(e);r=function(){return e};return e};function _(){if(void 0===i)try{var e=r();(new Date).toLocaleDateString(e,{timeZone:"UTC"});i=!0}catch(e){i=!1}return i}var D=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],P=void 0;function H(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())}function B(e,t,n){var r=Math.round(e/n);return t.replace("{0}",String(r))}function j(e,t){return _()&&t&&e?Object(p.__assign)(Object(p.__assign)({},e),{timeZone:"UTC"}):e}},"1450":function(e,t,n){"use strict";n.r(t);n.d(t,"ItemType",function(){return r});var r;(function(e){e[e.File=0]="File";e[e.Folder=1]="Folder";e[e.Media=2]="Media";e[e.OneNote=3]="OneNote";e[e.Unknown=4]="Unknown";e[e.Error=5]="Error";e[e.App=6]="App";e[e.Subsite=7]="Subsite";e[e.Shortcut=8]="Shortcut"})(r||(r={}));t.default=r},"1452":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(384),s=(function(){function e(e,t){var n=this._pageContext=t.pageContext,s=t.tokenProvider,o=t.dataRequestorType,u=void 0===o?(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{pageContext:n,tokenProvider:s})||this}return t})(i.default):o,a=e.dataSourceName,f=void 0===a?"DataSource":a;this.dataRequestor=new u({qosName:f})}e.prototype.getDataSourceName=function(){return this.dataSourceName};e.prototype.needsRequestDigest=function(e){return!0};e.prototype.getData=function(e,t,n,r,i,s,o,u,a,f,l,c,h){void 0===i&&(i="POST");var p=e(),d=r&&r(),v=this.needsRequestDigest(p);return this.dataRequestor.getData({url:p,parseResponse:t,qosName:n,additionalPostData:d,method:i,additionalHeaders:s,contentType:o,maxRetries:u,noRedirect:a,crossSiteCollectionCall:f,telemetryHandler:l,qosExtraData:c,needsRequestDigest:v,authToken:h})};return e})();t.t=s},"1480":function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"s",function(){return a});n.d(t,"i",function(){return f});n.d(t,"n",function(){return l});n.d(t,"r",function(){return c});n.d(t,"t",function(){return h});var r,i=n(1484),s=n(1450),o=n(1486),u="genericfile",a="video",f="photo";function l(e){var t="";if(e.type===s.default.Folder){t=o.t(e.sharingType)?"folder":"sharedfolder";e.isDocSet&&(t="docset")}else t=e.type===s.default.OneNote?"one":e.listItem?"splist":"text/typescript"===e.textEditorMimeType?"code":e.panorama?"photo360":h(e.extension);return t}function c(e){var t;try{if(e){var n=h(e);if(i.e[n]){var r=i.e[n].type;void 0===r&&(r=s.default.File);t=r}}}catch(e){}void 0===t&&(t=s.default.Unknown);return t}function h(e){if(!r){r={};for(var t in i.e){var n=i.e[t].extensions;if(n)for(var s=0;s<n.length;s++)r[n[s]]=t}}e=e.replace(".","").toLowerCase();return r[e]||"genericfile"}},"1484":function(e,t,n){"use strict";var r=n(1450),i={accdb:{extensions:["accdb","mdb"]},archive:{type:r.default.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{type:r.default.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},css:{},csv:{extensions:["csv"]},docset:{type:r.default.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:r.default.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:r.default.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},folder:{type:r.default.Folder,iconType:"svg"},font:{type:r.default.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:r.default.Unknown},html:{extensions:["htm","html","mht"]},link:{type:r.default.Unknown,extensions:["lnk","link","url","website","webloc"]},splist:{type:r.default.Unknown,extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},one:{type:r.default.OneNote,extensions:["one"]},onetoc:{type:r.default.OneNote,extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},photo:{type:r.default.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{type:r.default.Folder,iconType:"svg"},spreadsheet:{extensions:["ods","gsheet","numbers"]},sysfile:{type:r.default.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vector:{type:r.default.Unknown,extensions:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{type:r.default.Media,extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4"," mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{type:r.default.Unknown,extensions:["zip"]}};t.e=i},"1486":function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});var r=n(1492);function i(e){return void 0===e||e===r.e.Private||e===r.e.Unknown}function s(e){return void 0!==e&&e!==r.e.Private&&e!==r.e.Unknown}function o(e){return e===r.e.Shared}},"1492":function(e,t,n){"use strict";var r;(function(e){e[e.Public=0]="Public";e[e.PublicUnlisted=2]="PublicUnlisted";e[e.Shared=3]="Shared";e[e.Private=4]="Private";e[e.Unknown=5]="Unknown"})(r||(r={}));t.e=r},"1519":function(e,t,n){"use strict";n.d(t,"r",function(){return h});var r=n(0),i=n(1440),s=n(1477);n.d(t,"t",function(){return s.e});var o=n(1482),u=n(1463),a=n(1476);n.d(t,"e",function(){return a});var f=n(10),l=n(18),c=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemsStore,s=void 0===i?r.resources.consume(u.t):i;r._itemsStore=s;r._itemUpdatesByKey={};return r}t.prototype.update=function(e,t){void 0===t&&(t=!1);for(var n=0,r=e;n<r.length;n++){var i=r[n];this._processTask(i)}};t.prototype.flush=function(){var e;e={};for(var t=this._itemUpdatesByKey,n=Object.keys(t).filter(function(e){return!!t[e].item}),i=0,s=n;i<s.length;i++){var u=s[i],f=t[u],l=new o.e(u),c=this._getStoreItem(u);if(c){c.parent;var h=Object(r.__rest)(c,["parent"]);Object(a.default)(l,h)}Object(a.default)(l,{revision:0});for(var p=0,d=f.item;p<d.length;p++){var v=d[p];Object(a.default)(l,v)}e[u]=l}for(var m=0,g=n;m<g.length;m++){var y=(l=e[u=g[m]]).parentKey;if(y){var b=e[y]||this._getStoreItem(y)||new o.e(y);e[y]=b;l.parent=b}else delete l.parent}this._pushItemsToStore(e);for(var w=0,E=n;w<E.length;w++){u=E[w];delete(f=t[u]).item}};t.prototype.reset=function(){this._itemUpdatesByKey={}};t.prototype.getItem=function(e){var t=e.key;return this._getStoreItem(t)};t.prototype.getChildren=function(e){var t,n,r,i=e.parentKey,s=e.startIndex,o=e.endIndex,u=[],a=this._itemUpdatesByKey[i];if(a){var f=a.set;if(f)if(f.childrenByIndex){s=void 0===(n=(t={startIndex:s,endIndex:o}).startIndex)?f.startIndex:n,o=void 0===(r=t.endIndex)?f.endIndex:r;for(var l=s;l<o;l++){var c=f.childrenByIndex[l],h=this._getStoreItem(c);u.push(h)}}else if(f.childrenBySibling)for(var p={},d="";d=f.childrenBySibling[d];){if(p[d])throw new Error("Circular reference encountered enumerating the children of '"+i+"'.");p[d]=!0;h=this._getStoreItem(d);u.push(h)}}return u};t.prototype._processTask=function(e){var t=e.key,n=e.output,r=n.item,i=n.set,s=this._itemUpdatesByKey,o=s[t];o||(o=s[t]={});if(r){o.item||(o.item=[]);o.item.push(r)}if(i){var u=s[i.parent.key];u||(u=s[i.parent.key]={});u.set||(u.set={});var a=u.set;if(void 0!==i.index){a.childrenByIndex||(a.childrenByIndex=[]);void 0===a.startIndex?a.startIndex=i.index:a.startIndex=Math.min(a.startIndex,i.index);var f=a.childrenByIndex.length;a.childrenByIndex[i.index]=t;void 0===a.endIndex?a.endIndex=i.index+1:a.endIndex>i.index+1?a.endIndex+=a.childrenByIndex.length-f:a.endIndex=Math.max(a.endIndex,i.index+1)}else if(i.after){a.childrenBySibling||(a.childrenBySibling={});a.childrenBySibling[i.after.key]=t}}};t.prototype._getStoreItem=function(e){var t=this._itemsStore.getItem(e);return this.peekUnwrapObservable(t)};t.prototype._pushItemsToStore=function(e){var t={};for(var n in e){(s=t[i=e[(a=e[n]).parentKey]&&a.parentKey||""]||(t[i]=[])).push(n)}for(var r=[""];r.length;){var i,s;if(s=t[i=r.shift()]){for(var o=0,u=s;o<u.length;o++){var a;if(!(a=e[n=u[o]]))throw new Error("Attempted to update the same item multiple times.");this._itemsStore.setItem(a,n)}r.push.apply(r,s)}}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemsStore:u.t});return t})(i.n),h=new f.t({name:"ItemTaskObserver",factory:new l.r(c)});t.n=c},"1541":function(e,t,n){"use strict";var r=n(1567);n.d(t,"e",function(){return r.e});n.d(t,"t",function(){return r.t});n.d(t,"n",function(){return r.r})},"1549":function(e,t,n){"use strict";var r=n(434),i=n(788),s=(function(){function e(e,t){void 0===e&&(e=new r.e);void 0===t&&(t=1);this.translate=e;this.scale=t}e.areEqual=function(e,t,n){void 0===n&&(n=1e-6);return r.e.areEqual(e.translate,t.translate,n)&&Math.abs(Math.log(e.scale/t.scale))<n};e.zoom=function(t,n,r){return new e(t.subtract(n).scale(r-1),r)};e.centerWithinBounds=function(t,n,s){return new e(new i.e(r.e.ORIGIN,t).getCenter().subtract(r.e.getCenter([n,s])))};e.prototype.apply=function(e){return e.scale(this.scale).add(this.translate)};e.prototype.multiply=function(t){return new e(this.translate.add(t.translate.scale(this.scale)),this.scale*t.scale)};e.prototype.invert=function(){return new e(this.translate.scale(-1/this.scale),1/this.scale)};e.IDENTITY=new e;return e})();t.e=s},"1567":function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"s",function(){return f});n.d(t,"i",function(){return l});n.d(t,"t",function(){return m});n.d(t,"n",function(){return b});n.d(t,"r",function(){return E});var r,i=n(1549),s=n(434);(function(e){e[e.cover=0]="cover";e[e.center=1]="center";e[e.fit=2]="fit";e[e.fitExpand=3]="fitExpand";e[e.fitExpandHeight=4]="fitExpandHeight";e[e.fitExpandWidth=5]="fitExpandWidth";e[e.fitWidth=6]="fitWidth";e[e.fitHeight=7]="fitHeight";e[e.top=8]="top"})(r||(r={}));var o=function(e,t){this.name=e;this.getTransform=t};function u(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new o(e.map(function(e){return e.name}).join("-"),function(t,n){for(var r=i.e.IDENTITY,s=0,o=e;s<o.length;s++){var u=o[s],a={width:t.width*r.scale,height:t.height*r.scale};r=u.getTransform(a,n).multiply(r)}return r})}var a=new o(r[r.center],function(e,t){var n=new s.e((t.width-e.width)/2,(t.height-e.height)/2);return new i.e(n)}),f=new o(r[r.top],function(e,t){var n=new s.e((t.width-e.width)/2,0);return new i.e(n)}),l=new o(r[r.fitWidth],function(e,t){var n=t.width/e.width;return new i.e(s.e.ORIGIN,Math.min(n,1))}),c=new o(r[r.fitHeight],function(e,t){var n=t.height/e.height;return new i.e(s.e.ORIGIN,Math.min(n,1))}),h=new o(r[r.fit],function(e,t){return(e.width/e.height>t.width/t.height?l:c).getTransform(e,t)}),p=new o(r[r.fitExpandWidth],function(e,t){var n=t.width/e.width;return new i.e(s.e.ORIGIN,n)}),d=new o(r[r.fitExpandHeight],function(e,t){var n=t.height/e.height;return new i.e(s.e.ORIGIN,n)}),v=new o(r[r.fitExpand],function(e,t){return(e.width/e.height>t.width/t.height?p:d).getTransform(e,t)}),m=new o(r[r.cover],function(e,t){return(e.width/e.height>t.width/t.height?c:l).getTransform(e,t)}),g=u(h,a),y=u(v,a),b=u(m,a);function w(e){var t,n;if("string"==typeof e)t=r[e];else{if((function(e){return"object"==typeof e})(e))return e;t=e}switch(t){case r.top:n=f;break;case r.fitHeight:n=c;break;case r.fitWidth:n=l;break;case r.fit:n=g;break;case r.fitExpand:n=y;break;case r.center:n=a;break;default:n=b}return n}function E(e){var t;t=e instanceof Array?e:[e];return u.apply(void 0,t.map(w))}},"1685":function(e,t,n){"use strict";var r=n(0),i=n(1440),s=n(485),o=n(69),u=n(114),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,void 0,n)||this;r._pageContext=t||r.resources.consume(o.h);var i=null==n?void 0:n.dataRequestorType;r._makeDataRequestor=i?function(e){return new i(e)}:function(e){return new s.e(e,{pageContext:r._pageContext})};r.dataRequestor=r._makeDataRequestor({qosName:r.getDataSourceName()});return r}t.prototype.getDataSourceName=function(){return"DataSource"};t.prototype.updateContext=function(e){u.e(this._pageContext,e);this.dataRequestor=this._makeDataRequestor({qosName:this.getDataSourceName()})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{dataRequestorType:s.n});return t})(i.n);t.e=a},"1706":function(e,t,n){"use strict";n.r(t);var r=n(1672),i=n(63),s=n(128),o=n(170),u=(function(){function e(){}e.getFilterList=function(e,t,n,i){return o.default.getFilterList(e,t,n,i,r.e.EmptyFilterValue)};e.clearFilterInfo=function(t,n){n=n||0;for(var r=e.getFilterList(t),i=n;i<r.length;i++){var s=r[i];t=o.default.addFilterInfo(t,s.fieldName,null,!0)}return t};e.getInplviewHash=function(e,t){var n="#InplviewHash"+(e=s.default.normalizeLower(e||"",!1))+"=";t&&(n+=Object.keys(t).map(function(e){var n=i.e.encodeURIComponent(t[e]);return i.e.encodeURIComponent((e+"="+n).replace(/-/g,"--"))}).join("-"));return n};return e})();t.default=u},"1738":function(e,t,n){"use strict";n.r(t);n.d(t,"getItemName",function(){return f});n.d(t,"updateListContext",function(){return l});n.d(t,"updateListContextGroupInfo",function(){return c});var r=n(0),i=n(1450),s=n(88),o=n(441),u=n(277),a=n(28);function f(e,t,n){return n&&!n.isDocLib&&t!==i.default.Folder&&(e.Title||e["URL.desc"])||e.FileLeafRef}function l(e,t){if(Number(e.ListTemplateType)){t.listTemplateType=Number(e.ListTemplateType);t.isDocLib=Object(a.i)(t.listTemplateType)}"boolean"==typeof e.ContentTypesEnabled&&(t.contentTypesEnabled=e.ContentTypesEnabled);if(e.ListSchema){t.listId=e.listName;t.rawListSchema=e.ListSchema;t.viewTitle=e.viewTitle;t.openInClient="0"===t.rawListSchema.DefaultItemOpen}e.ListTitle&&(t.listTitle=e.ListTitle);e.listUrlDir&&(t.listUrl=decodeURIComponent(e.listUrlDir));e.EnableAttachments&&(t.enableAttachments="true"===e.EnableAttachments);e.Flags2&&(t.flags2=e.Flags2);var n=e.BasePermissions;n&&(t.permissions={manageLists:n.ManageLists,managePersonalViews:n.ManagePersonalViews,openItems:n.OpenItems});"boolean"!=typeof e.ExcludeFromOfflineClient&&"boolean"!=typeof e.WebExcludeFromOfflineClient||(t.excludeFromOfflineClient=!(!e.ExcludeFromOfflineClient&&!e.WebExcludeFromOfflineClient));"boolean"==typeof e.TenantTagPolicyEnabled&&(t.tenantTagPolicyEnabled=e.TenantTagPolicyEnabled);"boolean"==typeof e.verEnabled&&(t.enableVersions=e.verEnabled);"boolean"==typeof e.checkPowerAppState&&(t.checkPowerAppState=e.checkPowerAppState);"boolean"==typeof e.EnableMinorVersions&&(t.enableMinorVersions=e.EnableMinorVersions);"boolean"==typeof e.NewWOPIDocumentEnabled&&(t.newWOPIDocumentEnabled=e.NewWOPIDocumentEnabled);"number"==typeof e.NewWOPIDocumentTypes&&(t.newWOPIDocumentTypes=e.NewWOPIDocumentTypes);"boolean"==typeof e.isForceCheckout&&(t.isForceCheckout=e.isForceCheckout);"boolean"==typeof e.isModerated&&(t.isModerated=e.isModerated);"boolean"==typeof e.EnableRequestSignOff&&(t.enableRequestSignOff=e.EnableRequestSignOff);"boolean"==typeof e.AllowCreateFolder&&(t.allowCreateFolder=e.AllowCreateFolder);s.e.isActivated("F5795B0F-8820-4A74-9281-EC1C68E4929C","2/9/2021","Implement list level comment setting")||"boolean"!=typeof e.DisableCommenting||(t.disableCommenting=e.DisableCommenting);"boolean"==typeof e.AllowGridMode?t.allowGridMode=e.AllowGridMode:"boolean"!=typeof t.allowGridMode&&(t.allowCreateFolder=!0);e.displayFormUrl&&(t.displayFormUrl=e.displayFormUrl);e.editFormUrl&&(t.editFormUrl=e.editFormUrl);e.newFormUrl&&(t.newFormUrl=e.newFormUrl);e.metadataNavFeatureEnabled&&(t.metadataNavFeatureEnabled=e.metadataNavFeatureEnabled);e.AvailableContentTypes&&(t.availableContentTypes=e.AvailableContentTypes);if(e.ViewMetadata){var i=void 0;i=s.e.isActivated("F5D38A68-8774-425A-BC0B-1650EAA9C41D","9/21/2018","avoid mutate the original serverView object in the spdata")?e.ViewMetadata:Object(r.__assign)({},e.ViewMetadata);if(e.VisualizationInfo)try{i.VisualizationInfo=JSON.parse(e.VisualizationInfo)}catch(e){}i.CustomFormatter=e.ListSchema&&e.ListSchema.CustomFormatter;t.viewResult=new o.e(i)}t.isPlaceholder=!1}function c(e){var t=void 0;if(e.groupByOverride)t=[e.groupByOverride];else if(e.rawListSchema&&e.rawListSchema.group1){(t=[]).push(e.rawListSchema.group1);e.rawListSchema.group2&&t.push(e.rawListSchema.group2)}var n=-1,r=e.rawListSchema&&"TRUE"===e.rawListSchema.Collapse;if(t&&t.length>0){n=0;if(e.filterParams&&!r){var i=Boolean(Object(u.getFilterFieldByName)(e.filterParams,t[0])),s=!(!i||!t[1])&&Boolean(Object(u.getFilterFieldByName)(e.filterParams,t[1]));(i&&1===t.length||s&&2===t.length)&&(n=-1)}}e.groupLevel=n;e.groupBy=n>-1?t:void 0;e.isGrouped=Boolean(e.groupBy)}},"1744":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(441),s=n(1685),o=n(28),u=n(1517),a=n(638),f=n(913);var l=n(786),c=n(1706),h=n(109),p=n(97),d=n(47),v=n(18),m=n(69),g=n(63),y=n(134),b=n(437),w=n(12),E=n(276);n.d(t,"resourceKey",function(){return T});var S=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(","),x=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext,n)||this;r._apiUrlHelper=n.apiUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._identityDataSource=n.identityDataSource;return r}t.prototype.getView=function(e,t){var n=this;return this.dataRequestor.getData({url:this._getViewApiUrl(e,t).oDataParameter("$select",S).toString(),parseResponse:function(e){var t=JSON.parse(e);return n._viewFromServerView(t.d,!0)},qosName:"GetView",method:"GET"})};t.prototype.getViews=function(e,t){var n=this;return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("Views").oDataParameter("$select",S).toString(),parseResponse:function(e){return JSON.parse(e).d.results.map(function(e){return n._viewFromServerView(e,!1,t)}).filter(function(e){return!!e})},qosName:"GetViews",method:"GET"})};t.prototype.createView=function(e,t){var n,r=this,i=e.viewParams,s=e.sourceView,o=i.useFiltersInViewXml?void 0:this._getFilterParams(i),u=!1,a=!1,f=!1,l=!1;return p.e.instrumentPromise({name:"ListDataSource.CreateView"},function(){return r._addView(e,t).then(function(e){if(!e)throw new Error("No view returned by /Views/Add");n=e;u=!0;if(o){l=!0;return r._saveLegacyFilters(n,o,t)}}).then(function(){a=!0;if(s.scope){l=!0;return r.modifyView({id:n.id,scope:s.scope},t)}}).then(function(){f=!0;return l?r.getView({id:n.id},t):n}).then(null,function(e){u&&o&&!a&&r.deleteView(n.id,t);return e})},null,function(e){return h.n.isCanceled(e)?{resultType:d.e.ExpectedFailure,resultCode:"Canceled"}:{resultType:d.e.Failure,resultCode:u?a?f?l?"SecondGetView":"Unknown":"SaveScope":"SaveFilters":"CreateView",error:e}})};t.prototype.saveView=function(e,t,n){var r=this,i=e.sourceView,s=e.viewParams,o=e.updateViewXml,u=s.useFiltersInViewXml?void 0:this._getFilterParams(s),a=!1,f=!1;return p.e.instrumentPromise({name:"ListDataSource.SaveView"},function(){return r._setViewXml(e,t,n).then(function(){a=!0;if(u)return r._saveLegacyFilters(i,u,t)}).then(function(){f=!0;return o?r.getView({id:i.id},t):null}).then(function(e){o&&e&&(i.baseViewXml=e.baseViewXml);return{}})},null,function(e){return h.n.isCanceled(e)?{resultType:d.e.ExpectedFailure,resultCode:"Canceled"}:{resultType:d.e.Failure,resultCode:a?f?"UpdateView":"SaveAsNewView":"SetViewXml",error:e}}).then(function(){})};t.prototype.deleteView=function(e,t){return this.dataRequestor.getData({url:this._getViewApiUrl({id:e},t).toString(),qosName:"DeleteView",method:"POST",additionalHeaders:{"X-HTTP-Method":"DELETE"}})};t.prototype.modifyView=function(e,t){var n={__metadata:{type:"SP.View"},DefaultView:e.isDefault,Title:e.title};"number"==typeof e.scope&&(n.Scope=e.scope);return this.dataRequestor.getData({url:this._getViewApiUrl({id:e.id},t).toString(),parseResponse:function(e){return e},qosName:"ModifyView",additionalPostData:JSON.stringify(n),method:"PATCH",additionalHeaders:{"X-HTTP-Method":"PATCH"}})};t.prototype.createMappedView=function(e,t,n){var r=this,i={appViewCreationInfo:{Title:e.title,AppId:e.appId,IsPrivate:e.isPrivate},visualizationTarget:t};return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("CreateMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"CreateMappedView",additionalPostData:JSON.stringify(i),method:"POST"})};t.prototype.getMappedApp=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("GetMappedApp").oDataParameter("$expand","AppMappedViews").toString(),parseResponse:function(e){return r.appSynchronizationResultFromMappedApps(e,!0)},qosName:"GetMappedApp",additionalPostData:JSON.stringify({appId:e,visualizationAppTarget:t}),method:"POST"})};t.prototype.getMappedApps=function(e,t){var n=this;return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("GetMappedApps").oDataParameter("$expand","AppMappedViews").toString(),parseResponse:function(e){return n.appSynchronizationResultFromMappedApps(e,!1)},qosName:"GetMappedApps",additionalPostData:JSON.stringify({visualizationAppTarget:e}),method:"POST"})};t.prototype.publishMappedView=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("PublishMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"PublishMappedView",additionalPostData:JSON.stringify({appId:e,visualizationTarget:t}),method:"POST"})};t.prototype.unpublishMappedView=function(e,t,n){var r=this;return this.dataRequestor.getData({url:this.getListApiUrl(n).segment("UnpublishMappedView").toString(),parseResponse:function(e){var t=JSON.parse(e);return r._viewFromServerView(t.d)},qosName:"UnpublishMappedView",additionalPostData:JSON.stringify({appId:e,visualizationTarget:t}),method:"POST"})};t.prototype.getFlowTemplates=function(e,t){var n=t?JSON.stringify({category:t}):void 0;return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("SyncFlowTemplates").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowTemplates",additionalPostData:n,method:"POST",noRedirect:!0})};t.prototype.getFlowInstance=function(e,t){return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("SyncFlowInstance").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowInstance",additionalPostData:JSON.stringify({flowID:e}),method:"POST",noRedirect:!0})};t.prototype.getFlowInstances=function(e){return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("SyncFlowInstances").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowInstances",method:"POST",noRedirect:!0})};t.prototype.getFlowCallbackUrl=function(e,t){return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("SyncFlowCallbackUrl").toString(),parseResponse:function(e){var t={synchronizationData:null,synchronizationDataObject:null,synchronizationStatus:null};t.synchronizationData=e;var n=JSON.parse(e);t.synchronizationDataObject=n.d;t.synchronizationStatus=n.d.SynchronizationStatus;return t},qosName:"GetFlowCallbackUrl",additionalPostData:JSON.stringify({flowId:e}),method:"POST",noRedirect:!0})};t.prototype.ensureSignoffStatusField=function(e){return this.dataRequestor.getData({url:this.getListApiUrl(e).segment("EnsureSignoffStatusField").toString(),parseResponse:function(e){return JSON.parse(e).d},qosName:"EnsureSignoffStatusField",method:"POST"})};t.prototype.modifyFieldProperties=function(e,t,n,i,s){var o=this,u=e.id,a=e.displayName,f=e.fieldDescription,l=e.showInFiltersPane,c=new y.e(s).authority,p=function(e,t){var c={__metadata:{type:"SP.Field"},Title:a,SchemaXml:f,ShowInFiltersPane:l},h=Object(r.__assign)({"X-HTTP-Method":"MERGE"},i),p=o.getListApiUrl(e).method("Fields",u).toString();if(!w.e.isActivated("5d911417-d0d1-4989-9ec5-5cf2ecdf8e97","4/23/2020","Retreve list by name")&&n){var d=o._apiUrlHelper;s&&(d=new E.t({webAbsoluteUrl:s}));p=d.build().segment("web").methodWithAliases("GetListUsingPath",{DecodedUrl:e}).method("Fields",u).toString()}return o.dataRequestor.getData({url:p,qosName:"ModifyFieldProperties",additionalPostData:JSON.stringify(c),method:"POST",additionalHeaders:h,authToken:t})};return s&&new y.e(this._pageContext.webAbsoluteUrl).authority!==c?h.n.resolve(this._identityDataSource.getSharePointToken(c).then(function(e){var n=e&&e.accessToken||"";return p(t,n)})):p(t)};t.prototype.setContentApproval=function(e,t){var n={__metadata:{type:"SP.List"},EnableModeration:e};return this.dataRequestor.getData({url:this.getListApiUrl(t).toString(),qosName:"SetContentApproval",additionalPostData:JSON.stringify(n),method:"POST",additionalHeaders:{"IF-MATCH":"*","X-HTTP-Method":"MERGE"}})};t.prototype.setListPropertiesAsString=function(e,t,n){var i=this,s=n,o=new y.e(e).authority,u=function(n,s){var o=Object(r.__assign)({__metadata:{type:"SP.List"}},t),u=i._itemUrlHelper.getUrlParts({path:e,listUrl:e}),a=n+"/_api/web/GetList(@a1)?@a1='"+g.e.encodeRestUriStringToken(""+u.serverRelativeListUrl)+"'";return i.dataRequestor.getData({url:a,parseResponse:function(e){return e},qosName:"setListPropertiesAsString",additionalPostData:JSON.stringify(o),method:"POST",additionalHeaders:{"IF-MATCH":"*","X-HTTP-Method":"MERGE"},authToken:s})},a=function(t){return s?u(s,t):h.n.resolve(i._getWebUrlPromise(e,t).then(function(e){return u(e,t)}))};return new y.e(this._pageContext.webAbsoluteUrl).authority!==o?h.n.resolve(this._identityDataSource.getSharePointToken(o).then(function(e){var t=e&&e.accessToken||"";return a(t)})):a()};t.prototype.appSynchronizationResultFromMappedApps=function(e,t){var n=this,r=JSON.parse(e),i=r&&r.d;if(!i)return null;var s=[];i.AppMappedViews&&i.AppMappedViews.results&&(s=i.AppMappedViews.results.map(function(e){return n._viewFromServerView(e)}));var o=null;try{o=JSON.parse(i.SynchronizationData);(t?o&&o.name&&o.properties:o&&o.value)||(o={id:null,name:null,properties:{createdBy:null,createdTime:null,displayName:null,isPrivate:!0,permissions:null}});for(var u=t?[o]:o.value,a=0,f=u;a<f.length;a++){var l=f[a].properties;l.isPrivate=!l.permissions||!l.permissions.some(function(e){return e.properties&&e.properties.principal&&"Tenant"===e.properties.principal.type})}}catch(e){}return{appMappedViews:s,synchronizationData:r.d.SynchronizationData,synchronizationDataObject:o,synchronizationStatus:r.d.SynchronizationStatus}};t.prototype.getListApiUrl=function(e){var t=this._itemUrlHelper.getUrlParts({path:e,listUrl:e});return this._apiUrlHelper.build().webByItemUrl(t).method("GetList",t.serverRelativeListUrl)};t.prototype.getDataSourceName=function(){return"ListDataSource"};t.prototype._addView=function(e,t){var n=e.title,r=e.sourceView,s=e.viewParams,o=e.isPublic,u=this._combineViewParamsAndXml(r,s);u.prepareForSaving();return this.dataRequestor.getData({url:this.getListApiUrl(t).segment("Views").segment("Add").toString(),parseResponse:function(e){var t=JSON.parse(e);return new i.e(t.d)},qosName:"AddView",additionalPostData:JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:n,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:r.getEffectiveFieldNames()},Query:u.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!o,RowLimit:r.rowLimit}})})};t.prototype._combineViewParamsAndXml=function(e,t){var n=new i.e(e.getEffectiveViewXml());if(t){if(t.sortField){var r={fieldName:t.sortField,isAscending:"false"!==t.isAscending};n.updateSort(r,{overwriteAll:!0})}t.groupBy&&n.updateGroupBy({group1:{fieldName:t.groupBy,isAscending:!0}});var s=localStorage.getItem("SPColumnSize-Unsaved-"+e.id);if(s){n.updateColumnWidths(JSON.parse(s));localStorage.removeItem("SPColumnSize-Unsaved-"+e.id)}var o=e.customFormatter;n.updateCustomFormatter(o)}return n};t.prototype._getFilterParams=function(e){for(var t={},n=!1,r=0,i=Object.keys(e||{});r<i.length;r++){var s=i[r];if(f.e.test(s)){n=!0;t[s]=e[s]}}return n?t:void 0};t.prototype._saveLegacyFilters=function(e,t,n){return this.dataRequestor.getData({url:this.getListApiUrl(n).methodWithAliases("SaveAsNewView",{oldName:e.id,newName:e.title,privateView:!!e.isPersonal,uri:this._pageContext.webAbsoluteUrl+c.default.getInplviewHash(e.id,t)}).toString(),parseResponse:function(e){var t=JSON.parse(e);return t&&t.d&&t.d.SaveAsNewView},qosName:"SaveViewFilters"})};t.prototype._setViewXml=function(e,t,n){var r=e.sourceView,i=e.viewParams,s=this._combineViewParamsAndXml(r,i);s.prepareForSaving();return r.isDirty()||s.isDirty()?this.dataRequestor.getData({url:this._getViewApiUrl({id:r.id},t,n).method("SetViewXml").toString(),qosName:"UpdateView",additionalPostData:JSON.stringify({viewXml:s.getEffectiveViewXml()})}):h.n.wrap()};t.prototype._getViewApiUrl=function(e,t,n){return n?this.getListApiUrl(t).segment("DefaultView"):(function(e){return e&&!!e.id})(e)?this.getListApiUrl(t).method("Views",e.id):(function(e){return e&&!!e.url})(e)?this._apiUrlHelper.build().webByUrl({path:t,listUrl:t}).method("GetViewFromUrl",e.url):this.getListApiUrl(t).method("Views",e.title)};t.prototype._viewFromServerView=function(e,t,n){if(e.ViewType&&e.Id){var r=Object(l.isFeatureEnabled)(l.PowerApps)&&i.e.isAppView(e),s=e.Hidden&&!r,u=n===o.n.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!s&&!u){var a=new i.e(e);if(a.viewType)return a}}return null};t.prototype._getWebUrlPromise=function(e,t){return this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(e),parseResponse:function(e){return JSON.parse(e).d.GetContextWebInformation.WebFullUrl},qosName:"GetContextInfoInListDataSource",method:"POST",authToken:t})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.e.dependencies),{pageContext:m.h,apiUrlHelper:u.e,itemUrlHelper:a.n,identityDataSource:b.t});return t})(s.e),T=(t.default=x,Object(v.s)("ListDataSource",x))},"1745":function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(105),i=n(130);function s(e,t){var n=Object(r.deserializeQuery)(e).id;t&&t.urlParts&&(n===t.urlParts.fullListUrl||n===t.urlParts.serverRelativeListUrl)&&(n=void 0);return n}function o(e,t){var n=e;0!==n.indexOf("id")&&(n=Object(i.e)({id:e,listurl:t}));return n}},"1892":function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["glb","gltf"],i=["cool","fbx","obj","ply","stl","3mf"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},"1901":function(e,t,n){"use strict";var r=n(0),i=n(1452),s=n(63),o=n(30),u=n(177),a=n(1304),f=n(277),l=n(1745);n.d(t,"e",function(){return c});var c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{},{pageContext:t.pageContext})||this;n._listContext=t.listContext;n._itemUrlHelper=t.itemUrlHelper||new u.e({},{pageContext:t.pageContext});n._apiUrlHelper=t.apiUrlHelper||new a.e({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper});n._folderPath=t.folderPath;void 0===n._folderPath&&(n._folderPath=Object(l.t)(t.parentKey,n._listContext));return n}t.prototype.getFilterData=function(e,t,n,r){var i=this;return this.getData(function(){return i._getFilterDataUrl(e,t,n,r)},function(e){return e},"GetFilterData")};t.prototype._getFilterDataUrl=function(e,t,n,r){var i=this._itemUrlHelper.getUrlParts({path:this._listContext.listUrl,listUrl:this._listContext.listUrl}),u=this._apiUrlHelper.build().webByItemUrl(i).method("GetList",i.serverRelativeListUrl).segment("RenderListFilterData").parameter("FieldInternalName",e);n&&"f9ebc8b2-a976-48f0-a8fa-0846164c0466"!==n&&(u=u.parameter("ViewId",n));this._folderPath&&(u=u.parameter("RootFolder",{raw:s.e.encodeURIComponent(this._folderPath)}));r&&r===o.e.Taxonomy&&(u=u.parameter("ExcludeFieldFilteringHtml",!0));var a=Object(f.getFilterParams)(t,!0);return(u=u.rawParameter(a)).toString()};return t})(i.t)},"1906":function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["htm","html","svg"],i=["eml","msg","md","mdown","markdown"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},"1918":function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=["ai","pdf"],i=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],s=["dwg","dxf"];function o(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function u(e,t){return o(i,e)||!!t&&o(s,e)}function a(e){return o(r,e)}},"1952":function(e,t,n){"use strict";n.r(t);n.d(t,"previewImageUrl",function(){return i});n.d(t,"previewImageUrlFromProps",function(){return s});n.d(t,"previewImageUrlFromUrl",function(){return o});var r=n(1541);function i(e,t,n,r){if(n.isSPO){var i=e.SiteId||e.SiteID||e.siteId||n.siteId,u=e.WebId||e.webId||n.webId,a=e.UniqueId||e.UniqueID||e.uniqueId,f=e.Url||e.url||e.Path;return a&&i&&u&&!r?s(i,u,a,t,n):o(f,t,n)}}function s(e,t,n,r,i){if(i.isSPO){var s;n&&(s=u(function(s){var o=s?"":"&resolution=Width1024";return r+"/"+i.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&guidFile="+n+"&guidSite="+e+"&guidWeb="+t+o}));return s}}function o(e,t,n){if(n.isSPO){var r;e&&(r=u(function(r){var i=r?"":"&resolution=Width1024";return t+"/"+n.layoutsUrl+"/getpreview.ashx?clientType=docLibGrid&path="+e+i}));return r}}function u(e){return{url:e(!0),width:0,height:0,getAligned:function(t,n){return{url:e(n.name===r.t.name),width:0,height:0}}}}},"1953":function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(1440),s=n(71),o=n(18),u=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getUrlParts=function(e){return new a(e)};return t})(i.n),a=(function(){function e(e){this._url=e}Object.defineProperty(e.prototype,"driveId",{get:function(){return this._getDriveId()},enumerable:!1,configurable:!0});Object.defineProperty(e.prototype,"itemId",{get:function(){return this._getItemId()},enumerable:!1,configurable:!0});e.prototype._getDriveId=function(){var e,t=this._getIndexOfDrivesSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getDriveId=function(){return e};return e};e.prototype._getItemId=function(){var e,t=this._getIndexOfItemsSegment();if(t>-1){var n=this._getPathSegments();e=n[t+1]}this._getItemId=function(){return e};return e};e.prototype._getPathSegments=function(){var e,t=this._url;e=t?new s.default(t).getPathSegments():[];this._getPathSegments=function(){return e};return e};e.prototype._getIndexOfDrivesSegment=function(){var e=this._getPathSegments().indexOf("drives");this._getIndexOfDrivesSegment=function(){return e};return e};e.prototype._getIndexOfItemsSegment=function(){var e=this._getPathSegments().indexOf("items");this._getIndexOfItemsSegment=function(){return e};return e};return e})(),f=Object(o.s)("VroomUrlHelper",u)},"2012":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e.fromHexString=function(e,t){var n=t?{High:2147483647,Low:2147483647}:{High:0,Low:0},r=e&&e.match(/^(0x)?([0-9a-f]*)$/i);if(r){var i=void 0,s=void 0;if((e=(e=r[2]||"0").slice(-16)).length<=8){i=0;s=parseInt(e,16)}else{i=parseInt(e.slice(0,-8),16);s=parseInt(e.slice(-8),16)}if(!isNaN(i)&&!isNaN(s)){n.High=i;n.Low=s}}return n};e.or=function(e){return(e||[]).reduce(function(e,t){return{High:e.High|t.High,Low:e.Low|t.Low}},{High:0,Low:0})};e.and=function(e){return e&&e.length?e.reduce(function(e,t){return{High:e.High&t.High,Low:e.Low&t.Low}}):{High:0,Low:0}}})(r||(r={}));t.t=r},"2026":function(e,t,n){"use strict";n.d(t,"t",function(){return c});var r=n(0),i=n("knockout-lib"),s=n(30),o=n(787),u=n(69),a=n(142),f=n(272),l=n(1217);function c(e){var t=e.listSchema,n=e.resources,r=e.groupSchema,i=e.hasFixedSchema,s=e.listContext,c=e.getItemContext,h=e.sortFallback,d=n.consume(o.p.optional),v=n.consume(f.e).isMobile&&n.consume(o.D.optional);s||(s=n.consume(u.o));var m={hasFixedSchema:i,serverSupportsAutoHyperLink:!1,useCustomColumn:v,disableShareHeroCommand:d},g=l.e.buildSchema(t,s,m,r,c),y=n.consume(u.h),b=Number(y.webTemplate)===a.t.mySite;return g.filter(function(e){return!b||"ItemChildCount"!==e.internalName&&"FolderChildCount"!==e.internalName}).map(function(e){e.groupable=!b&&e.groupable;if(h.sortField===e.internalName&&h.sortDirection){e.isSorted=!0;e.isAscending="ascending"===h.sortDirection}return p(e,s)})}var h=(function(){function e(){}e.getCustomColumns=function(e,t,n){var r=this,i=this._convertToSPColumn(e),s=t.map(function(e){return e.map(function(e){return r._convertToSPColumn(e)})}),o=n.map(function(e){return r._convertToSPColumn(e)});return l.e.getCustomColumns(i,s,o).map(function(e){return p(e)})};e.getMappedColumnType=function(e){return l.e.getMappedColumnType(e)};e.getIconColumnWidth=function(e){return e.consume(f.e).isMobile&&e.consume(o.D.optional)?48:16};e.getIconColumnMinWidth=function(e){return e.consume(f.e).isMobile&&e.consume(o.D.optional)?48:16};e.fillColumnDefinitionDefaults=function(e,t,n){void 0===t&&(t={});void 0===n&&(n={});var o=t.isCollapsible,u=void 0===o||o;return e.map(function(e,o){var a=e.isIcon,f=void 0!==a&&a,l=e.sortable,c=void 0===l?!!t.sortable:l,h=e.resizable,p=void 0===h?!!t.resizable:h,d=e.isCollapsable,v=void 0===d?u:d,m=e.fieldType,g=void 0===m?s.e.Text:m,y=e.name,b=e.getValue,w=e.key,E=e.width,S=!!n.sortField&&n.sortField===e.internalName,x=!!n.groupBy&&n.groupBy===e.internalName;return Object(r.__assign)(Object(r.__assign)({},e),{key:w,name:y,width:E,index:o,fieldType:g,isCollapsable:v,isIcon:f,isVisible:!0,isVisibleMobile:!0,isGrouped:x,sortable:c,isSorted:S,isAscending:S&&n.isAscending,filterable:!1,isFocused:i.observable(!1),getValue:b,resizable:p})})};e._convertToSPColumn=function(e){var t=this;return Object(r.__assign)(Object(r.__assign)({},e),{isFiltered:e.isFiltered&&e.isFiltered.peek(),filterValues:e.filterValues&&e.filterValues.peek(),customWidth:e.customWidth&&e.customWidth.peek(),clientSideColumnAdapter:e.clientSideColumnAdapter,customFields:e.customFields&&e.customFields.map(function(e){return t._convertToSPColumn(e)})})};return e})();t.e=h;function p(e,t){return Object(r.__assign)(Object(r.__assign)({},e),{key:d(e.key),clientSideColumnAdapter:e.clientSideColumnAdapter,isFiltered:i.observable(e.isFiltered),isMenuOpen:i.observable(!1),isFocused:i.observable(!1),customWidth:i.observable(0),filterValues:i.observable(e.filterValues),customFields:e.customFields?e.customFields.map(function(e){return p(e,t)}):void 0})}function d(e){var t;switch(e){case"FileSizeDisplay":t="size";break;default:t=e}return t}},"2099":function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(786);function i(e){var t=!!e&&!!e.folder,n=e&&e.properties.ProgId;return s()&&t&&o(n)}function s(){return Object(r.isFeatureEnabled)(r.TeamChannelFolder)}function o(e){return!!e&&0===e.toLowerCase().indexOf("team.channel")}},"2142":function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"r",function(){return a});n.d(t,"n",function(){return f});n.d(t,"i",function(){return l});n.d(t,"s",function(){return c});var r=n(1652),i=n(2895),s=n(23);function o(e){return e?s.format(r.e.gridViewSubTitle,e):""}function u(e){var t=e&&e[e.length-1];return t?t.title||t.Title:""}function a(e){var t=e&&e[e.length-1];return{title:t&&t.title,email:t&&t.email,picture:t&&Object(i.t)({userLoginName:t.email})}}function f(e){return e?e.substr(e.lastIndexOf("\n")+1):""}function l(e){if(!e)return"";try{var t=window.DOMParser,n=t&&(new t).parseFromString(e,"text/html");return n&&n.body&&n.body.innerText}catch(e){return""}}function c(e){return e&&"0x0120"===e.slice(0,6)}},"2181":function(e,t,n){"use strict";n.d(t,"e",function(){return T});var r=n(171),i=n(24),s=n(325),o=n(1477),u=n(1704),a=n(69),f=n(114),l=n(231),c=n(2012),h=n(28),p=n(1476),d=n(638),v=n(1953),m=n(436),g=n(274),y=n(10),b=n(18),w=n(2374),E=n(12),S=!1;var x=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._pageContext=t.pageContext;this._itemUrlHelper=t.itemUrlHelper;this._vroomUrlHelper=t.vroomUrlHelper}e.prototype.processResponse=function(e){var t=e.response,n=e.response,r=n.WebUrl,i=n.HttpRoot,s=n.ListData,o=n.rootFolder,a=n.ListSchema,f=(void 0===a?{}:a).Collapse,l=void 0===f?"FALSE":f,h=e.requestKey,p=e.observer,d=this._urlDataSource.getKeyParams(h),v="TRUE"===l,m=this._itemUrlHelper.getItemUrlParts(h),g=this._itemUrlHelper.getUrlParts({path:m.serverRelativeListUrl,listUrl:m.fullListUrl});(r||i)&&this._processWeb({list:t,requestKeyParts:d,observer:p});var y=this._processList({list:t,listUrlParts:g,requestKeyParts:d,observer:p}).listRootItemKey,b=[];if(o){var w=this._processRootFolder({list:t,listUrlParts:g,requestKeyParts:d,observer:p});b.push.apply(b,w.parentItemUrls)}if(s&&!v){w=this._processListData({listData:s,listUrlParts:g,parentKey:h,requestKeyParts:d,observer:p});b.push.apply(b,w.parentItemUrls)}var E={};if(t.ParentInfo)for(var S=0,x=t.ParentInfo.ParentFolderInfo;S<x.length;S++){var T=x[S];E[T.ServerRelativeUrl]=c.t.fromHexString(T.Permissions)}for(var N=0,C=Object(u.e)(b);N<C.length;N++){var k=C[N];this._processParentItem({itemUrl:k,listUrlParts:g,parentInfo:E,requestKeyParts:d,observer:p})}return{listRootItemKey:y}};e.prototype._processListData=function(e){for(var t=e.listData.Row,n=e.parentKey,r=e.requestKeyParts,i=e.listUrlParts,s=e.observer,u=[],a="",f=0,l=t;f<l.length;f++){var c=l[f],h=c.FileRef,p=this._processRow({row:c,observer:s,requestKeyParts:r,listUrlParts:i}).key;u.push.apply(u,this._getParentItemUrls({listUrlParts:i,itemUrl:h}));s.update([new o.e(p).succeed({set:{parent:{key:n},after:{key:a}}})]);a=p}return{parentItemUrls:u}};e.prototype._processRow=function(e){var t,n,r=e.row,s=e.row.FileRef,u=e.listUrlParts,a=e.requestKeyParts,l=e.observer,c=this._itemUrlHelper.getUrlParts({path:s,listUrl:u.fullListUrl});n=((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t);if(this._isFolder(r)){var h={},p=this._urlDataSource.getQueryType(a),d=a.typeFilters;p!==i.e.Search&&(h.view=a.view);d&&(h.typeFilters=d);f.e(n,h)}var v=this._urlDataSource.getKey(n),m=this._getParentKeyForListItem({listUrlParts:u,itemUrl:s,requestKeyParts:a}),g={key:v};m&&(g.parentKey=m);l.update([new o.e(v).succeed({item:g})]);return{key:v}};e.prototype._processRootFolder=function(e){var t,n,r,i=e.list,s=e.listUrlParts,u=e.requestKeyParts,a=e.observer,f=i.rootFolder,c=this._itemUrlHelper.getUrlParts({path:f,listUrl:s.fullListUrl}),h=this._urlDataSource.getKey(((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t.view=u.view,t.q=u.q,t.typeFilters=u.typeFilters,t)),d=this._getParentKeyForListItem({listUrlParts:s,itemUrl:f,requestKeyParts:u}),v={key:h,type:l.e.Folder,newWOPIDocumentEnabled:p.optional(i.NewWOPIDocumentEnabled)};d&&(v.parentKey=d);var m=!E.e.isActivated("D661752A-9F1F-4AF8-89A9-2C0CA6688A00","03/19/2019","Infer rootFolder content-type");if(i.ListData){n=i.ListData.FolderId;if(m&&"Sharepoint.DocumentSet"===i.ListData.CurrentFolderProgId){v.isDocSet=!0;if(i.AvailableContentTypes)for(var g=0,y=i.AvailableContentTypes;g<y.length;g++){var b=y[g],w=b.contentTypeId;if(w&&0===w.indexOf("0x0120D520")){v.contentTypeId=w;r=b.displayName;break}}}if(i.ListData.CurrentFolderSpItemUrl){var S=this._vroomUrlHelper.getUrlParts(i.ListData.CurrentFolderSpItemUrl);v.itemId=p.optional(S.itemId);v.graph={itemId:p.optional(S.itemId),driveId:p.optional(S.driveId)}}}m&&r&&v.contentTypeId?v.properties={ID:p.optional(n),ContentType:r,ContentTypeId:v.contentTypeId}:v.properties={ID:p.optional(n)};if(!this._isListRoot({itemUrl:f,listUrlParts:s})){var x=f.split("/").slice(-1)[0];v.name=x;v.displayName=x}a.update([new o.e(h).succeed({item:v})]);return{parentItemUrls:this._getParentItemUrls({listUrlParts:s,itemUrl:f})}};e.prototype._processWeb=function(e){var t,n=e.list,r=e.requestKeyParts,s=e.observer,u=n.HttpRoot,a=n.SiteTitle,f=n.WebUrl||u&&m.i(decodeURIComponent(u)),c=this._itemUrlHelper.getUrlParts({path:f,webUrl:f}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=i.e.DocumentLibraries,t.typeFilters=r.typeFilters,t)),p={},d={key:h,type:l.e.Folder,subsite:p};if(this._pageContext.webAbsoluteUrl===f){d.name=a;d.displayName=a;p.webTemplateId=Number(this._pageContext.webTemplate);p.serverRelativeUrl=this._pageContext.webAbsoluteUrl;p.id=this._pageContext.webId;p.siteCollectionId=this._pageContext.siteId;p.title=this._pageContext.webTitle;p.icon=this._pageContext.webLogoUrl}s.update([new o.e(h).succeed({item:d})])};e.prototype._processList=function(e){var t,n,s,u,a,f=e.list,c=e.listUrlParts,d=e.requestKeyParts,v=e.observer,y=f.ListTitle,b=f.HttpRoot,x=f.ListUrl,T=f.listUrlDir,N=x||T&&decodeURIComponent(T),C=this._urlDataSource.getKey(((t={}).id=c.serverRelativeItemUrl,t.listurl=c.normalizedListUrl,t.view=d.view,t.q=d.q,t.typeFilters=d.typeFilters,t)),k=f.AllowCreateFolder,L=f.EnableMinorVersions,A=f.verEnabled,O=f.AllowGridMode,M=f.DisableGridEditing,_=f.ListTemplateType,D=f.BasePermissions,P=void 0===D?{}:D,H=P.ManageLists,B=void 0===H?void 0:H,j=P.ManagePersonalViews,F=void 0===j?void 0:j,I=P.OpenItems,q=void 0===I?void 0:I,R=P.UseClientIntegration,U=void 0===R?void 0:R,z=f.ListSchema,W=void 0===z?{}:z,X=W.DefaultItemOpen,V=void 0===X?void 0:X,$=W[".driveAccessTokenV21"],J=void 0===$?void 0:$,K=W[".driveAccessToken"],Q=void 0===K?void 0:K,G=W[".driveUrl"],Y=void 0===G?void 0:G,Z=W[".driveUrlV21"],ee=void 0===Z?void 0:Z,te=f.ExcludeFromOfflineClient,ne=f.WebExcludeFromOfflineClient,re=f.listBaseType,ie=Q,se=J,oe=Y,ue=ee,ae=this._pageContext.driveInfo;if(f.isFromServiceWorkerCache&&N===this._pageContext.listUrl&&ae){ae[".driveAccessToken"]&&(ie=ae[".driveAccessToken"]);ae[".driveAccessTokenV21"]&&(se=ae[".driveAccessTokenV21"]);ae[".driveUrl"]&&(oe=ae[".driveUrl"]);ae[".driveUrlV21"]&&(ue=ae[".driveUrlV21"])}if(ie){s={accessToken:(fe=Object(g.e)(ie)).access_token,proofToken:fe.prooftoken,tokenUrl:oe}}if(se){var fe;u={accessToken:(fe=Object(g.e)(se)).access_token,proofToken:fe.prooftoken,tokenUrl:ue}}var le=f.WebUrl||b&&m.i(decodeURIComponent(b));if(le){var ce=this._itemUrlHelper.getUrlParts({path:le,webUrl:le});a=this._urlDataSource.getKey(((n={}).id=ce.normalizedItemUrl,n.view=i.e.DocumentLibraries,n.typeFilters=d.typeFilters,n))}var he="string"==typeof V?"0"===V:void 0;he&&(function(){if(!S){r.e.logData({name:"List.openInClient"});S=!0}})();var pe=oe&&this._vroomUrlHelper.getUrlParts(oe)||void 0;s&&Object(w.e)({authToken:s.accessToken,proofToken:s.proofToken})&&(s=void 0);u&&Object(w.e)({authToken:u.accessToken,proofToken:u.proofToken})&&(u=void 0);var de="number"==typeof re?Object(h.r)(String(re)):void 0;v.update([new o.e(C).succeed({item:{key:C,parentKey:p.optional(a),itemId:p.backup("root"),graph:{itemId:p.backup("root"),driveId:p.optional((null==pe?void 0:pe.driveId)||void 0),sessionToken:p.optional(s),sessionTokenV21:p.optional(u)},type:l.e.Folder,name:p.optional(y),displayName:p.optional(y),isRootFolder:!0,isDropEnabled:!0,folder:{},newWOPIDocumentEnabled:p.optional(f.rootFolder?void 0:f.NewWOPIDocumentEnabled),list:{id:p.optional(f.listName),allowGridMode:"boolean"==typeof O?O:p.backup(!0),allowCreateFolder:p.optional(k),disableCommenting:!E.e.isActivated("F5795B0F-8820-4A74-9281-EC1C68E4929C","2/9/2021","Implement list level comment setting")&&"boolean"==typeof f.DisableCommenting&&f.DisableCommenting,disableGridEditing:"boolean"==typeof M?M:p.backup(!1),enableMinorVersions:p.optional(L),enableVersions:p.optional(A),templateType:p.optional("string"==typeof _?Number(_):void 0),isDocumentLibrary:p.optional(de),isPromotedLinks:p.optional("string"==typeof _?Object(h.o)(_):void 0),isModerated:p.optional(f.isModerated),newWOPIDocumentEnabled:p.optional(f.NewWOPIDocumentEnabled),newWOPIDocumentTypes:p.optional(f.NewWOPIDocumentTypes),permissions:{manageLists:p.optional(B),managePersonalViews:p.optional(F),openItems:p.optional(q),useClientIntegration:p.optional(U)},openInClient:p.optional(he),excludeFromOfflineClient:p.optional("boolean"==typeof te||"boolean"==typeof ne?te||ne:void 0),contentTypesEnabled:p.optional(f.ContentTypesEnabled),metadataNavFeatureEnabled:p.optional(f.metadataNavFeatureEnabled),canUserCreateMicrosoftForm:p.optional(f.canUserCreateMicrosoftForm),itemCount:p.optional(f.ListSchema&&f.ListSchema.ItemCount),rowLimit:p.optional(f.ListData.RowLimit),listUrlDir:N,createdFromExcel:p.optional(f.CreatedFromExcel),createdFromExisting:p.optional(f.CreatedFromExisting)},properties:{commandsSupported:p.optional(f.CanShareLinkForNewDocument&&{canShareLinkForNewDocument:"1"})}}})]);return{listRootItemKey:C}};e.prototype._processParentItem=function(e){var t,n=e.itemUrl,r=e.listUrlParts,i=e.parentInfo,s=e.requestKeyParts,u=e.observer,a=this._itemUrlHelper.getUrlParts({path:n,listUrl:r.fullListUrl}),f=this._urlDataSource.getKey(((t={}).id=a.serverRelativeItemUrl,t.listurl=a.normalizedListUrl,t.view=s.view,t.q=s.q,t.typeFilters=s.typeFilters,t)),c={key:f,parentKey:this._getParentKeyForListItem({listUrlParts:r,itemUrl:n,requestKeyParts:s}),queryType:this._urlDataSource.getQueryType(s)};if(this._isListRoot({itemUrl:n,listUrlParts:r}))c.list={};else{var h=m.r(n);c.name=h;c.displayName=h;c.type=l.e.Folder;c.isDropEnabled=!0;c.folder={};i&&i[n]&&(c.permissions=i[n])}u.update([new o.e(f).succeed({item:c})])};e.prototype._getParentKeyForListItem=function(e){var t,n,r=e.listUrlParts,i=e.itemUrl,s=e.requestKeyParts;if(r.serverRelativeListUrl!==i){var o=i.split("/").slice(0,-1).join("/"),u=this._itemUrlHelper.getUrlParts({path:o,listUrl:r.fullListUrl});n=this._urlDataSource.getKey(((t={}).id=u.serverRelativeItemUrl,t.listurl=u.normalizedListUrl,t.view=s.view,t.q=s.q,t.typeFilters=s.typeFilters,t))}return n};e.prototype._getParentItemUrls=function(e){var t=e.listUrlParts,n=e.itemUrl,r=[],i=t.serverRelativeListUrl;if(0===n.indexOf(i))for(var s="",o=0,u=n.substring(i.length).split("/").slice(1,-1);o<u.length;o++){var a=""+i+(s+="/"+u[o]);r.push(a)}return r};e.prototype._isListRoot=function(e){var t=e.itemUrl;return e.listUrlParts.serverRelativeListUrl===t};e.prototype._isFolder=function(e){var t;if("1"===e.FSObjType){var n=e["File_x0020_Type.mapapp"],r=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];t=!(n&&"onenote"===n.substring(0,7)||r&&-1!==r.indexOf("onenote"))}else t=!1;return t};e.dependencies={urlDataSource:s.me,pageContext:a.h,itemUrlHelper:d.n,vroomUrlHelper:v.e,resources:y.o};return e})(),T=Object(b.s)("ListItemResultProcessor",x)},"2186":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(2138),i=n(18),s=(function(){function e(e,t){this._microServiceDataSourceType=t.microServiceDataSourceType;this._store=new Map}e.prototype.getOrCreateMicroServiceDataSource=function(e){var t=this._store.get(e);if(!t){t=new this._microServiceDataSourceType;this._store.set(e,t)}return t};return e})(),o=Object(i.s)("MicroServiceDataSourceStore",s,{microServiceDataSourceType:r.t})},"2374":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(921);function i(e,t){void 0===t&&(t=0);if(!e.expiry){var n=(function(e){return Object(r.t)(e)})(e.authToken);e.expiry=n&&(function(e){try{return new Date(parseInt(e+"000",10))}catch(e){}})(n.exp)}return(e.expiry?e.expiry.getTime():0)-Date.now()<t}},"2381":function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=[".dcm",".dcm30",".dic",".dicm",".dicom"],i={".docm":!0,".dotm":!0,".dotx":!0,".docx":!0,".bmp":!0,".jpg":!0,".jpeg":!0,".tiff":!0,".tif":!0,".png":!0,".gif":!0,".emf":!0,".wmf":!0,".psd":!0,".svg":!0,".ai":!0,".eps":!0,".pdf":!0,".pptm":!0,".pptx":!0,".potm":!0,".potx":!0,".ppsm":!0,".ppsx":!0,".xlsm":!0,".xlsx":!0,".aspx":!0};function s(e){return!!e&&i[e.toLowerCase()]}function o(e){return r.indexOf(e)>=0}},"2467":function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(4),i=n(10),s=new i.t({name:"ItemActivityFieldFeature.key.isActivityFieldVisible",factory:new i.e(Object(r.sr)(r.Pe))}),o=new i.t({name:"ItemActivityFieldFeature.key.isActivityFieldEnabled",factory:new i.e(Object(r.sr)(r.Pe))})},"2683":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(10).t)("vroom.dataContext")},"2893":function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=n(650),s=n(300),o=n(1452),u=n(109),a=n(47),f=n(171),l=n(128),c=n(168),h={ODB:1201},p=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,{dataSourceName:"ListItemDataSource"},{pageContext:t.pageContext})||this}t.prototype.getItem=function(t,n,r,i){var s=this;t.postDataContext.isOnePage=!!t.newTargetListUrl||!!t.isOnePageNavigation;var o=t.remoteItem&&c.default.isFeatureEnabled(h)?this._getRemoteItemPostData():this.getAdditionalPostData(t.postDataContext,n,t.pageSize);return e.prototype.getData.call(this,function(){return s.getUrl(n,t)},function(e,t){return s._parseResponse(e,r.qosEvent,t)},r.qosName,function(){return o},"POST",this._getListRequestHeaders(t,n),void 0,void 0,void 0,void 0,function(e){var t=s._telemetryHandler(e);i&&i(t.eventData);return t},void 0,t.authToken).then(function(e){return e},function(e){s._errorHandler(r.qosName,e);return u.n.reject(e)})};t.prototype.getUrl=function(e,t){var n,r=t&&t.postDataContext;n=c.default.isFeatureEnabled(h)?{webUrl:this._pageContext.webAbsoluteUrl,listId:t.remoteItem?t.remoteItem.ListId:e.listId,urlParts:t.remoteItem?{}:e.urlParts,searchTerm:e.searchTerm,rootFolder:t.remoteItem?void 0:e.folderPath,isOnePageNavigation:t.isOnePageNavigation,remoteWebUrl:t.remoteItem?t.remoteItem.SiteUrl:t.remoteWebUrl,uniqueId:t.remoteItem&&t.remoteItem.UniqueId}:{webUrl:this._pageContext.webAbsoluteUrl,listId:e.listId,urlParts:e.urlParts||{},searchTerm:e.searchTerm,rootFolder:e.folderPath,isOnePageNavigation:t.isOnePageNavigation};if(this._isSpecifiedItemRequest(e))n.viewId=e.viewIdForRequest;else{(!e.viewXmlForRequest||r&&r.isOnePage)&&e.viewIdForRequest!==l.default.Empty&&(n.view=e.viewIdForRequest);!n.view&&e.viewPathForRequest&&(n.viewPath=e.viewPathForRequest);t&&t.ignoreFilterParams||(n.filterParams=e.filterParams);if(e.sortField){n.sortField=e.sortField;n.sortDir="false"===e.isAscending?"Desc":"Asc"}r&&r.groupReplace?n.requestToken=this._isExpandingGroup(n)?void 0:e.requestToken:n.requestToken=e.group?void 0:e.requestToken;!this._isExpandingGroup(e)||r&&r.groupReplace||(n.groupString=e.group.groupString);r&&r.webId&&(n.webId=r.webId)}return i.t(n)};t.prototype.getAdditionalPostData=function(e,t,n){return s.e(e,t,n)};t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};t.prototype._getListRequestHeaders=function(e,t){var n=i.r(t,e.postDataContext);n["X-ServiceWorker-Strategy"]=e.skipServiceWorkerCache?"SkipCache":"CacheFirst";return n};t.prototype._isSpecifiedItemRequest=function(e){return e.itemIds&&e.itemIds.length>0};t.prototype._isExpandingGroup=function(e){return e.group&&"__next__"!==e.group.groupingId};t.prototype._parseResponse=function(e,t,n){var r=n.getServiceWorkerDataSourceHeader();try{if(void 0!==e)return this._getListItemResponse(e,r)}catch(n){if("{}"!==e.substring(0,2)){t.end({resultType:a.e.Failure,resultCode:"BadJSON"});throw n}return this._getListItemResponse(e.substring(2),r)}};t.prototype._getListItemResponse=function(e,t){var n;n=JSON.parse(e);"ServiceWorker-FromCache"===t&&(n.isFromServiceWorkerCache=!0);return n};t.prototype._telemetryHandler=function(e){var t=e.errorData,n=Object(r.__assign)({},e.eventData);if(t){var i=void 0,s=t.code?t.code:"";if(s.indexOf("2147024860")>-1)s="ListViewTreshold";else if(s.indexOf("2147024749")>-1)s="LookupColumnTreshold";else if(s.indexOf("2147024809")>-1&&s.indexOf("requestUrl")>-1)s="RequestURLFailure";else if(s.indexOf("2147024809")>-1&&s.indexOf("range")>-1)s="RangeError";else if(s.indexOf("2147024809")>-1&&s.indexOf("view")>-1)s="InvalidView";else if(s.indexOf("2130575340")>-1&&s.indexOf("field")>-1)s="FieldTypesNotInstalledProperly";else if(s.indexOf("2146232832")>-1){s="DefaultDoclibNotFound";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else if(s.indexOf("2147024895")>-1){s="PrefetchWebMismatch";if(500===t.status){i=!1;n.resultType=a.e.ExpectedFailure}}else s=n.resultCode;n.resultCode=s;return{canRetry:i,eventData:n}}return{eventData:n}};t.prototype._errorHandler=function(e,t){var n=t&&t.code?t.code:"";n.indexOf("2147024860")>-1?f.e.logData({name:e+".ListViewTreshold"}):n.indexOf("2147024749")>-1&&f.e.logData({name:e+".LookupColumnTreshold"})};return t})(o.t)},"2895":function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return s});var r,i=n(895);(function(e){e.Small="S";e.Medium="M";e.Large="L"})(r||(r={}));function s(e){var t;switch(e.size){case r.Large:t=3;break;case r.Medium:t=2;break;default:t=1}return Object(i.getUserPhotoUrl)(e.userLoginName,t)}},"3120":function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(1477),i=n(325),s=n(24),o=n(231),u=n(1480),a=n(638),f=n(18),l=(function(){function e(e,t){this._urlDataSource=t.urlDataSource;this._itemUrlHelper=t.itemUrlHelper}e.prototype.processSubsite=function(e){var t,n=e.subsite,i=e.requestKey,a=e.unique,f=e.observer,l=this._urlDataSource.getKeyParams(i),c=this._itemUrlHelper.getUrlParts({path:n.serverRelativeUrl,webUrl:n.serverRelativeUrl}),h=this._urlDataSource.getKey(((t={}).id=c.normalizedItemUrl,t.view=s.e.DocumentLibraries,t.typeFilters=l.typeFilters,t.u=a,t)),p=Object(u.n)({type:o.e.Folder}),d={key:h,isRootFolder:!0,isPlaceholder:!1,name:n.title,displayName:n.title,type:o.e.Folder,iconName:p,subsite:n,queryType:s.e.DocumentLibraries};f.update([new r.e(h).succeed({item:d})]);return{key:h}};e.dependencies={urlDataSource:i.me,itemUrlHelper:a.n};return e})(),c=Object(f.s)("SubsiteItemResultProcessor",l)},"3121":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(10),i=n(18),s=new r.t({name:"RecycleBinDataSource.key",loader:new i.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("289")]).then(n.bind(null,3583)).then(function(e){return e.resourceKey})})})},"3301":function(e,t,n){"use strict";var r=n(0),i=n(1440),s=n(903),o=n(1952),u=n(24),a=n(71),f=["AverageRating","RatedBy","Ratings","LikesCount","LikedBy"],l=n(1480),c=n(436),h=n(1582),p=n(10),d=n(18),v=new p.t({name:"ListItemTrendingStatusProcessor.key",loader:new d.t(function(){return n.e("464").then(n.bind(null,4130)).then(function(e){return e.resourceKey})})}),m=new p.t({name:"ItemActivityFieldDataSource.key",loader:new d.t(function(){return n.e("278").then(n.bind(null,4125)).then(function(e){return e.resourceKey})})}),g=n(231),y=n(892),b=n(871),w=n(2302),E=n(1699),S=n(2012),x=n(786),T=n(1580),N=n(2142),C=n(63),k=n(128),L=n(28),A=n(325),O=n(2381),M=n(69),_=n(2683),D=n(149),P=n(1477),H=n(1476),B=n(638),j=n(1953),F=n(1684),I=n(114),q=n(3654),R=n(916),U=n(12),z=n(90),W=n(1892),X=n(1906),V=n(2467);function $(e){var t={};t.isCommentDisabled=(function(e){if(void 0===e||null==e)return!0;return(1&e)>0})(e);return t}var J=n(61),K=n(1918);n.d(t,"e",function(){return Y});var Q=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;r._urlDataSource=n.urlDataSource;r._listContext=n.listContext;r._navigation=n.navigation;r._microServiceDataSource=n.microServiceDataSource;r._vroomUrlHelper=n.vroomUrlHelper;r._itemUrlHelper=n.itemUrlHelper;r._vroomDataContext=n.vroomDataContext;r._shortcutLinkDataSource=n.shortcutLinkDataSource;r._isActivityFeatureEnabled=n.isActivityFeatureEnabled;r._allowWrsExcel=!U.e.isActivated("4F4F63D5-6B0D-4B6E-B98F-93975947DEED","6/13/2019","Use OneUpWrs instead of OneUpWAC for Excel");r._allowWrsVisio=!1;r._htmlDecodeDiv=document.createElement("textarea");return r}t.prototype.getItemResult=function(e){try{return this._getItemResult(e)}catch(e){z.default.log(e,"ListItemBuilder.getItemResult");throw e}};t.prototype._getItemResult=function(e){var t,n,i,f,p=e.itemFromServer;if(!p)return null;var d,w=e.microServiceDataSource||this._microServiceDataSource,A=this._urlDataSource,M=e.requestKey,_=e.parentItemKey,D=e.queryType,B=void 0===D?A.getQueryType():D,j=e.groupBy,F=e.itemGroups,z=e.contentTypes,W=e.supportsNestedGroups,V=e.isItemDataOnly,K=e.listTemplateType,Q=void 0===K?this._listContext.listTemplateType:K,Y=e.observer,Z=A.getKeyParams(M),ee=this._itemUrlHelper.getUrlParts({path:p.id||p.FileRef||p.ServerRelativeUrl,listUrl:Z.listurl});d=((t={}).id=ee.serverRelativeItemUrl,t.listurl=ee.normalizedListUrl,t);var te=p.File_x0020_Type,ne=te?"."+te:"",re=this._parseMediaServiceMetadata(p.MediaServiceFastMetadata),ie=this._parseMediaServiceMetadata(p.MediaServiceMetadata),se=this._getItemType({itemFromServer:p,listTemplateType:Q,microServiceDataSource:w,mediaServiceFastMetadata:re});if(se===g.e.Folder){var oe=Z.id===d.id,ue=A.getItemTypeFilter(Z),ae={};if(oe)ae=((n={}).view=Z.view,n.q=Z.q,n.typeFilters=Z.typeFilters,n);else{B!==u.e.Search&&(ae=((i={}).view=B,i));ue&&I.e(ae,A.saveItemTypeFilter(ue))}I.e(d,ae)}var fe=A.getKey(d),le={key:fe,extension:ne},ce=p.id||p.FileRef;le.id=ce;var he,pe,de=S.t.fromHexString(p.PermMask),ve=J.e.hasPermission(de,J.e.openItems),me=this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled||!ve,ge=p[".spItemUrl"];if(ge){var ye=this._vroomUrlHelper.getUrlParts(ge);he=ye.itemId;pe=ye.driveId}else he=p["name.FileSystemItemId"]||(p.isRootFolder?"root":void 0);this._vroomDataContext&&he&&this._vroomDataContext.setFileSystemIdMapping(he,ce);var be=p[".etag"];be&&(le.eTag=be);le.itemId=H.optional(he);var we=Q===L.t.mySiteDocumentLibrary;le.graph=H.optional(he&&{itemId:he,driveId:pe,driveType:Q?we?"business":"documentLibrary":void 0});var Ee=Number(p._ip_UnifiedCompliancePolicyUIAction)||0;"1"===this._navigation.viewParams.showpolicytips&&(Ee=Number(p.ID)%6);le.policyTip=H.optional(Ee);var Se=Object(O.t)(ne);(Se||".ai"===ne||".eps"===ne||".psd"===ne)&&w.getThumbnail({fileExtension:ne,item:p,itemKey:fe,mediaServiceMetadata:re})&&(se=g.e.Media);if(X.t(ne))le.htmlConversion={};else if(X.e(ne)){if(xe=w.getHtmlConversionUrl({fileExtension:ne,item:p,mediaServiceMetadata:re})){se=g.e.Media;le.htmlConversion={url:xe+"&inlineImages=true"}}}if(Object(x.isFeatureEnabled)(x.EnableZipFilePreviewing)&&(".zip"===ne||".rar"===ne)){var xe=w.getZipMetaDataUrl({fileExtension:ne,item:p,mediaServiceMetadata:re}),Te=w.getDownloadZipContentsUrl(p);if(xe&&Te){se=g.e.Media;le.zip={zipMetaDataUrl:xe,downloadZipContentsUrl:Te}}}var Ne,Ce,ke,Le,Ae,Oe,Me={},_e=w.getDownloadAsZipUrl(p),De=Object(x.isFeatureEnabled)(x.EnableOpenInImmersiveReader)&&w.getImmersiveReaderUrl({fileExtension:ne,item:p});_e&&(Me[s.t.downloadAsZip]=_e);De&&(Me[s.t.immersiveReaderUrl]=De);ge&&(Me[s.t.itemUrl]=ge);var Pe=this._listContext,He=Number(p.File_x0020_Size)||Number(p.FileSizeDisplay)||void 0,Be=re&&re.video,je=".ts"===ne&&He<1<<19&&!Be;je&&(se=g.e.File);var Fe=re&&re.media,Ie=U.e.isActivated("AE18621B-70BE-46AB-B681-F87FE63EBAA4","12/10/2019","Obtain item openUrl from full item path")?this._itemUrlHelper.getUrlParts({path:p.FileRef,listUrl:ee.normalizedListUrl}).normalizedItemUrl:ee.fullItemUrl,qe=Ie?c.e(Ie):void 0;if(se===g.e.Folder)Ne=p.ProgId&&"sharepoint.documentset"===p.ProgId.toLowerCase();else if(se!==g.e.Media&&!re||Object(L.o)(Q))se===g.e.File&&Pe&&void 0!==Pe.isDocLib&&!Pe.isDocLib&&(Ce={});else{var Re=l.t(ne),Ue=re&&re.photo||(Se||"photo"===Re?{}:void 0),ze=Be||("video"===Re?{}:void 0),We=re&&re.audio||("audio"===Re?{}:void 0);if(Ue){ke={originalUrl:H.optional("photo"===Re?qe:void 0),width:Ue.width||0,height:Ue.height||0};Object(x.isFeatureEnabled)(x.Image360Viewer)&&he&&(Le=this._getImage360(p,re,Ue,ie))}ze&&(Ae={fourCC:H.optional(ze.fourCC||(".mp4"===ne.toLowerCase()?"H264":void 0)),bitrate:H.optional(ze.encodingBitrate),width:ze.frameWidth||0,height:ze.frameHeight||0,duration:G(Fe&&Fe.duration),audioFormat:H.optional(We&&We.format),manifestMetadata:ze.manifestMetadata,altManifestMetadata:ze.altManifestMetadata});We&&(Oe={duration:G(Fe&&Fe.duration)})}var Xe=Fe&&Fe.title;le.caption=H.optional(Xe);le.photo=H.optional(ke);le.image360=H.optional(Le);le.video=H.optional(Ae);le.audio=H.optional(Oe);le.listItem=H.optional(Ce);_&&(le.parentKey=_);le.isDocSet=H.optional(Ne);ee.serverRelativeItemUrl===ee.serverRelativeListUrl&&(le.isRootFolder=!0);var Ve,$e=q.e.getItemName(p,se,Pe);le.name=H.optional($e);le.displayName=H.optional($e);var Je,Ke=!0;if(p.Modified&&"21"===this._pageContext.webTemplate&&Object(x.isFeatureEnabled)(x.RequestDatesInUtc))try{var Qe=new Date(p.Modified);le.dateModifiedTime=Qe;le.dateModifiedValue=Qe.getTime();Ve=Object(y.s)(Qe);Ke=!1}catch(e){}if(Ke){le.dateModifiedValue=H.optional(p.Modified);Ve=p["Modified.FriendlyDisplay"]?Object(b.e)(p["Modified.FriendlyDisplay"]):p.Modified?""+p.Modified:""}le.dateModified=H.optional(Ve||void 0);le.permissions=H.optional(de);if(F&&j&&j.length>0)if(W){F[0]||(F[0]=[]);var Ge=F[0]&&F[0].length>0?F[0][F[0].length-1]:null,Ye=j[0],Ze=j[1];if(Ye&&"1"===p[Ye+".newgroup"]){var et=Ge?Ge.startIndex+Ge.count:0,tt=R.e.buildGroup(Pe,p,Ye,0,!1,et),nt=this._convertToODNGroup(tt);F[0].push(nt);Ge=nt}if(Ze&&"1"===p[Ze+".newgroup"]){var rt=Ge&&Ge.children&&Ge.children.length>0?Ge.children[Ge.children.length-1]:null;et=rt?rt.startIndex+rt.count:Ge?Ge.startIndex:0;R.e.buildGroup(Pe,p,Ze,1,!1,et,Ge);var it=Ge.children.pop();Ge.children.push(this._convertToODNGroup(it))}}else for(var st=0;st<j.length;st++){var ot=j[st];if(ot){var ut=F[st]&&F[st].length>0?F[st][F[st].length-1]:null;if("1"===p[ot+".newgroup"]){et=ut?ut.startIndex+ut.count:0,nt=R.e.buildGroup(Pe,p,ot,st,!1,et);F[st]||(F[st]=[]);F[st].push(this._convertToODNGroup(nt))}}}if(z&&z.length>0&&p.ContentTypeId)for(var at=0,ft=z;at<ft.length;at++){var lt=ft[at];if(p.ContentTypeId===lt.contentTypeId){Je=!1;if(lt.requiredFields)for(var ct=0,ht=lt.requiredFields.split(",");ct<ht.length;ct++){var pt=p[ht[ct]];if(!pt||Array.isArray(pt)&&0===pt.length){Je=!0;break}}}}le.hasMissingMetadata=H.optional(Je);le.contentTypeId=H.optional(p.ContentTypeId);var dt,vt,mt,gt,yt,bt=p.folder,wt=[];if(bt){le.folder={};le.isDropEnabled=!0;dt=[];if(bt.children){for(var Et=0,St=bt.children,xt=St.length,Tt=0,Nt=0;Nt<xt;Nt++){var Ct=this.getItemResult({requestKey:M,queryType:B,itemFromServer:St[Nt],groupBy:j,itemGroups:wt,contentTypes:z,listTemplateType:Q,supportsNestedGroups:W,isItemDataOnly:V,observer:Y});if(Ct){dt[Nt]=Ct.item;Tt<10&&Ct.itemType===g.e.Media&&Et++;Tt++}}xt>0&&(Et>=10||Et>=xt)&&(le.displayType=u.e.Photos)}}else{mt=(mt=p["serverurl.progid"])?mt.substring(1):qe;Me[s.t.original]=mt;if(Object(x.isFeatureEnabled)(x.ShortcutLink)&&E.e.isShortcutItem({key:fe,extension:ne})){se=g.e.Shortcut;if(p._ShortcutUrl){le.shortcutInfo={shortcutLinkRewritten:!0};Me[s.t.shortcutTarget]=this._shortcutLinkDataSource.generateShortcutsOpenUrl(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl,p._ShortcutUrl,p._ShortcutSiteId,p._ShortcutWebId,p._ShortcutUniqueId);p._ShortcutUniqueId&&(vt=o.previewImageUrl({url:p._ShortcutUrl,siteId:p._ShortcutSiteId,webId:p._ShortcutWebId,uniqueId:p._ShortcutUniqueId},this._pageContext.webAbsoluteUrl,this._pageContext))}else{le.shortcutInfo=H.backup({shortcutLinkRewritten:!1});this._shortcutLinkDataSource.enqueueParseShortcut(fe,e.itemFromServer.ID);Me[s.t.shortcutTarget]=a.default.concatenate(this._pageContext.webAbsoluteUrl,this._pageContext.layoutsUrl)+"/ShortcutLink.aspx?shortcut="+C.e.encodeURIComponent(p.FileRef)}}Me[s.t.open]=mt;gt=p["File_x0020_Type.mapapp"]||p["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"];if(ee.isCrossDomain&&ee.isCrossList){var kt=p[".fileType"],Lt=T.u(kt||"");gt=void 0===Lt?kt?void 0:gt:Lt;"OneNote.Notebook"===p.HTML_x0020_File_x0020_Type&&(gt="onenote|UsePlain");"pdf"===p.File_x0020_Type&&(gt=void 0)}le.size=H.optional(He);le.totalSize=H.optional(Number(p.SMTotalSize)||void 0);vt||(vt=this._getThumbnail({itemFromServer:p,listTemplateType:Q,extension:ne,key:fe,type:se,mediaServiceFastMetadata:re,microServiceDataSource:w}));le.openUrl=mt;var At=p["IconOverlay.mapoly"];At&&(le.overlayUrl="/"+this._pageContext.layoutsUrl+"/images/"+At);le.thumbnail=vt;var Ot=this._getPdfConversionFacet({extension:ne,blockDownload:me,itemFromServer:p,microServiceDataSource:w,mediaServiceFastMetadata:re});Ot&&(le.pdfConversion=Ot);var Mt=this._get3dFacet({extension:ne,itemFromServer:p,microServiceDataSource:w,mediaServiceFastMetadata:re});Mt&&(le.model3d=Mt);if(se===g.e.Folder){var _t=Number(p.ItemChildCount)+Number(p.FolderChildCount);le.childCount=_t;var Dt=Number(p.SMTotalFileCount);le.folder={totalCount:Dt>0?Dt:_t,childCount:_t};le.isDropEnabled=!0}var Pt=p.ServerRedirectedEmbedUrl;Pt&&(this._itemUrlHelper.getUrlParts({path:Pt}).isCrossDomain||(yt=Pt))}le.previewIFrameUrl=yt;le.type=se;le.appMap=H.optional(gt);this._pageContext.blockDownloadsExperienceEnabled&&(le.type===g.e.Media||mt&&gt)?le.itemStatus=4:this._pageContext.blockDownloadsExperienceEnabled&&se!==g.e.Folder?le.itemStatus=3:this._pageContext.viewOnlyExperienceEnabled&&(le.itemStatus=4);var Ht={};for(var Bt in p)p.hasOwnProperty(Bt)&&(Ht[Bt]=p[Bt]);var jt=k.default.normalizeLower(p.UniqueId)||void 0;jt&&(Ht.uniqueId=jt);var Ft=p.RemoteItem;le.remoteItem=Ft&&JSON.parse(Ft);le.reputationProperties=this.getReputationProperties(p);var It,qt=$e;ne&&(qt=$e.substring(0,$e.toLowerCase().lastIndexOf(ne.toLowerCase())));le.sharingRole=0;It=Number(p.PrincipalCount)>0?h.e.Shared:void 0===p.PrincipalCount?x.isOneDrive?void 0:h.e.Unknown:h.e.Private;le.sharingType=H.optional(It);Ht.FileName=qt;var Rt=l.n({extension:ne,isDocSet:Ne,listItem:Ce,sharingType:It,type:se,textEditorMimeType:je?"text/typescript":void 0,panorama:Le});le.iconName=Rt;var Ut="ms-excel"===gt,zt="ms-powerpoint"===gt,Wt="ms-visio"===gt,Xt="ms-word"===gt;if(mt&&(Xt||Ut||zt||Wt)){var Vt=this._getOfficeBundleFacet({isWord:Xt,extension:ne,itemUrlParts:ee,isPowerPoint:zt,itemFromServer:p,microServiceDataSource:w,mediaServiceFastMetadata:re});!Vt||Ut&&!this._allowWrsExcel||Wt&&!this._allowWrsVisio||(le.officeBundle=Vt);Vt&&(Xt||zt)&&(Me[s.t.viewInBrowser]=w.getPdfConversionUrl({fileExtension:ne,item:p,mediaServiceMetadata:re},!0));le.wopiFrameUrl=mt}le.defaultSubText=N.e(N.t(p.Editor));le.isPlaceholder=!p.PermMask;le.queryType=B;le.displayType=H.backup(le.queryType);le.isDraggable=le.queryType===u.e.Files;p.folder||(Ht.modifiedByUser=N.r(p.Editor));Ht.MediaServiceOCR=N.i(p.MediaServiceOCR);le.properties=Ht;le.lifeCycleStatus=H.optional(this._getItemLifeCycleStatus(p));le.comments={settings:$(p._CommentFlags)};le.urls=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Me),this._getVideoUrl({extension:ne,itemFromServer:p,microServiceDataSource:w,mediaServiceFastMetadata:re})),((f={})[s.t.mediaBaseUrl]=w.getMediaBaseUrl({fileExtension:ne,item:p,mediaServiceMetadata:re}),f));Y.update([new P.e(fe).succeed({item:le})]);Object(x.isFeatureEnabled)(x.ItemAnalytics)&&Object(x.isFeatureEnabled)(x.EnableTrendingSignalInListView)&&fe&&this.resources.consumeAsync(v).then(function(e){e.queueNewItem(fe)});var $t=this._isActivityFeatureEnabled;U.e.isActivated("5FB0B159-1F05-4A77-99C9-AF50F3EC8435","4/2/2020","Use ItemsScope activity column")&&$t&&!V&&jt&&he&&!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isEmailAuthenticationGuestUser&&!this._pageContext.isExternalGuestUser&&this.resources.consumeAsync(m).then(function(e){e.enqueue(fe)});var Jt=this._getGroupings({itemFromServer:p,supportsNestedGroups:W,groupBy:j,groups:wt}),Kt=Jt.groupings,Qt=Jt.totalChildren;return{item:{key:fe},itemType:se,children:dt,groupings:Kt,totalChildren:Qt,nextRequestToken:p.nextRequestToken}};t.prototype._getItemLifeCycleStatus=function(e){var t={};1===Number(e["Created_x0020_Date.ifnew"])&&(t.isNew=!0);var n=Number(e._VirusStatus)||0;Object(x.isFeatureEnabled)(x.EnableATPFilesListView)&&0!==n&&3!==n&&(t.isMalwareDetected=!0);return t};t.prototype._getGroupings=function(e){var t=this,n=e.itemFromServer,r=e.supportsNestedGroups,i=e.groupBy,s=e.groups,o=null,u=this._listContext.groupLevel,a=n.folder?n.folder.childCount:0;if(n.folder&&n.folder.children&&i&&"__ItemType"===i[0])o=this._getItemTypeGroupings({itemFromServer:n});else if(-1!==u)if(n.groups){var f=[],l=0;if(r){var c=R.e.buildCollapsedGroups(n.groups,this._listContext,i),h=c.groups,p=c.totalCount;f=h.map(function(e){return t._convertToODNGroup(e)});l=p}else for(var d=0,v=n.groups;d<v.length;d++){var m=v[d],g=i[u];if(m[g+".newgroup"]){var y=R.e.buildGroup(this._listContext,m,g,u,!0,l);f.push(this._convertToODNGroup(y));l+=y.count}}if(f&&f.length>0){o=[{name:void 0,itemGroups:f,isAllCollapsed:this.createObservable(!0)}];a=l}}else s&&s.length>0&&s[u]&&s[u].length>0&&(o=[{name:void 0,itemGroups:s[u],isAllCollapsed:this.createObservable(!1)}]);return{groupings:o,totalChildren:a}};t.prototype._getItemTypeGroupings=function(e){for(var t,n=e.itemFromServer,r=[],i=n.folder.children,s=n.nextRequestToken?2:0,o=i.length+s,u=0;u<o;u++){var a=i[u];if(a){if(!(this._getItemTypeOneNoteOrFolder(a)===g.e.Folder)){t=u;break}}}(void 0===t&&o>0||t>0)&&r.push({count:void 0!==t?t:o,groupingId:"folder",startIndex:0,state:this.createObservable({isCollapsed:!1})});void 0!==t&&r.push({count:o-t,startIndex:t,groupingId:"document",state:this.createObservable({isCollapsed:!1})});return r.length?[{name:"FoldersDocumentsPhotos",itemGroups:r,isAllCollapsed:this.createObservable(!1)}]:void 0};t.prototype._getImage360=function(e,t,n,r){var i,s=t&&t.panorama,o=!1;if(s&&"equirectangular"===s.projectionType){i={projectionType:s.projectionType};o=!0}else e.FileLeafRef&&-1!==e.FileLeafRef.indexOf(".360")?i={projectionType:"equirectangular"}:n.width>0&&n.height>0&&n.width/n.height==2&&(o=!0);if(o&&r){var u=r.panorama;if(u)i={projectionType:H.optional(s.projectionType||void 0),croppedAreaImageHeightPixels:H.optional(u.croppedAreaImageHeightPixels||void 0),croppedAreaImageWidthPixels:H.optional(u.croppedAreaImageWidthPixels||void 0),croppedAreaLeftPixels:H.optional(u.croppedAreaLeftPixels||void 0),croppedAreaTopPixels:H.optional(u.croppedAreaTopPixels||void 0),fullPanoHeightPixels:H.optional(u.fullPanoHeightPixels||void 0),fullPanoWidthPixels:H.optional(u.fullPanoWidthPixels||void 0),initialHorizontalFOVDegrees:H.optional(u.initialHorizontalFOVDegrees||void 0),initialVerticalFOVDegrees:H.optional(u.initialVerticalFOVDegrees||void 0),initialViewHeadingDegrees:H.optional(u.initialViewHeadingDegrees||void 0),initialViewPitchDegrees:H.optional(u.initialViewPitchDegrees||void 0),initialViewRollDegrees:H.optional(u.initialViewRollDegrees||void 0),poseHeadingDegrees:H.optional(u.poseHeadingDegrees||void 0),posePitchDegrees:H.optional(u.posePitchDegrees||void 0),poseRollDegrees:H.optional(u.poseRollDegrees||void 0)};else{var a=r.photo;if(a&&a.cameraModel){var f=a.cameraModel.toLowerCase();["gopro fusion 360","kodak pixpro – 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(f)>=0&&(i={projectionType:"equirectangular"})}}}return i};t.prototype.getReputationProperties=function(e){for(var t={},n=0,r=f;n<r.length;n++){var i=r[n];t[i]=H.optional(e[i])}return t};t.prototype._getPdfConversionFacet=function(e){var t,n={fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata};if(t=e.blockDownload&&K.t(e.extension)?e.microServiceDataSource.getPassthroughUrl(n):e.microServiceDataSource.getPdfConversionUrl(n))return{url:t}};t.prototype._get3dFacet=function(e){if(this._pageContext.isSPO){var t=e.microServiceDataSource.getFbxConversionUrl({fileExtension:e.extension,item:e.itemFromServer}),n=W.t(e.extension);if(t||n)return{canConvert:!0,canRenderNative:n,conversionUrl:t&&t.replace("/bxf?","/glb?")}}};t.prototype._getOfficeBundleFacet=function(e){var t=e.isWord,n=e.extension,r=e.itemUrlParts,i=e.isPowerPoint,s=e.itemFromServer,o=e.microServiceDataSource,u=e.mediaServiceFastMetadata,a=r.isCrossDomain;if(!a&&("21"===this._pageContext.webTemplate||Object(x.isFeatureEnabled)(x.EnableWrsPreviewOutsideODB))){var f,l,c,h=!a&&(t&&Object(x.isFeatureEnabled)(x.EnableWordWrsPreview)||i&&Object(x.isFeatureEnabled)(x.EnablePowerPointWrsPreview)),p=t||i?o.getOfficeBundleGenerateUrl({fileExtension:n,item:s,mediaServiceMetadata:u}):"",d=o.getOfficeBundleGetFragmentUrl({fileExtension:n,item:s,mediaServiceMetadata:u}),v=!1,m="",g=s[".ctag"],y=u&&u.officeBundle;if(y){f=y.ctag;c=y.version;v=y.fatalError||!1;y.generationTime&&(l=new Date(y.generationTime));m=y.errorInfo||""}return{officeBundleGenerateUrl:p,officeBundleGetFragmentUrl:d,bundleCTag:f,bundleVersion:c,hasBundleGenerationFailed:v,bundleErrorInfo:m,generationTime:l,cTag:g,enableDefaultClick:h}}};t.prototype._getThumbnail=function(e){var t=e.itemFromServer;if(e.type!==g.e.Folder){if(Object(L.o)(e.listTemplateType))return{url:t.BackgroundImageLocation,width:0,height:0};var n=e.microServiceDataSource.getThumbnail({fileExtension:e.extension,allowCookieAuth:e.listTemplateType===L.t.mySiteDocumentLibrary,itemKey:e.key,item:t,mediaServiceMetadata:e.mediaServiceFastMetadata});if(n)return n;if(Object(O.e)(e.extension)){if(this._listContext.remoteParentWeb){var r=new a.default(this._listContext.remoteParentWeb.serverRelativeUrl).getLeftPart(a.UriPartial.authority),i=encodeURI(t.FileRef);return o.previewImageUrlFromUrl(C.e.encodeURIComponent(r+i),this._pageContext.webAbsoluteUrl,this._pageContext)}return o.previewImageUrl(t,this._pageContext.webAbsoluteUrl,this._pageContext)}}};t.prototype._getVideoUrl=function(e){var t=e.microServiceDataSource.getVideoUrl({fileExtension:e.extension,item:e.itemFromServer,mediaServiceMetadata:e.mediaServiceFastMetadata}),n={};t&&(n[s.t.video]=t);return n};t.prototype._getItemType=function(e){var t=e.itemFromServer,n=e.listTemplateType,r=e.microServiceDataSource,i=e.mediaServiceFastMetadata,s=this._getItemTypeOneNoteOrFolder(t);if(s===g.e.Unknown){var o=t.File_x0020_Type,u=o?"."+o:"";if(Object(x.isFeatureEnabled)(x.ShortcutLink)&&E.e.isShortcutFileType(o))return g.e.Shortcut;if(Object(x.isFeatureEnabled)(x.UseWebPdfViewer)&&("pdf"===o||this._getPdfConversionFacet({itemFromServer:t,extension:u,mediaServiceFastMetadata:i,blockDownload:!0,microServiceDataSource:r})))return g.e.Media;if(this._get3dFacet({itemFromServer:t,extension:u,microServiceDataSource:r,mediaServiceFastMetadata:i}))return g.e.Media;if("audio"===l.t(u))return g.e.Media;if(i)return g.e.Media;if((s=l.r(u))===g.e.Unknown)return Object(L.s)(n)?g.e.File:Object(L.o)(n)?g.e.Media:s}return s||g.e.File};t.prototype._getItemTypeOneNoteOrFolder=function(e){var t;if(e.folder)t=g.e.Folder;else if("1"===e.FSObjType){var n=e["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],r=e["File_x0020_Type.mapapp"];t=r&&"onenote"===r.substring(0,7)||n&&-1!==n.indexOf("onenote")?g.e.OneNote:g.e.Folder}else t=g.e.Unknown;return t};t.prototype._convertToODNGroup=function(e){var t=this,n=e;n.state=this.createObservable({isCollapsed:e.isCollapsed});n.children&&n.children.length>0&&(n.children=e.children.map(function(e){return t._convertToODNGroup(e)}));return n};t.prototype._parseMediaServiceMetadata=function(e){if(e&&"{}"!==e)try{var t=e;if("&"===e[1]){this._htmlDecodeDiv.innerHTML=e;t=this._htmlDecodeDiv.innerText}return JSON.parse(t)}catch(e){}finally{this._htmlDecodeDiv.innerHTML=""}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{pageContext:M.h,urlDataSource:A.me,listContext:M.o,navigation:D.e,microServiceDataSource:F.e,vroomUrlHelper:j.e,itemUrlHelper:B.n,vroomDataContext:_.e.optional,shortcutLinkDataSource:w.e,isActivityFeatureEnabled:V.e});return t})(i.n);function G(e){return"number"!=typeof e||U.e.isActivated("7F572FB6-3D81-4762-8499-379671FD5F86","9/20/2017","Convert 100ns video durations to ms")?e:e/1e4}var Y=Object(d.s)("ListItemBuilder",Q)},"3538":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(2026),s=n(1685),o=n(190),u=n(1799),a=n(1652),f=n(3439),l=n(441),c=n(24),h=n(644),p=n(1684),d=n(2186),v=n(231),m=n(28),g=n(1463),y=n(142),b=n(1046),w=n(61),E=n(325),S=n(69),x=n(352),T=n(18),N=n(109),C=n(63),k=n(786),L=n(128),A=n(170),O=n(1447),M=n(97),_=n(47),D=n(385),P=n(328),H=P.APICallPerformanceData,B=n(23),j=n(10),F=new j.t({name:"AuthTokenMonitor.key",loader:new T.t(function(){return n.e("375").then(n.bind(null,4007)).then(function(e){return e.resourceKey})})}),I=n(3301),q=n(2181),R=n(3120),U=n(1519),z=n(1477),W=n(638),X=n(2893),V=n(300),$=new j.t({name:"PopularDataSource.key",loader:new T.t(function(){return n.e("287").then(n.bind(null,4008)).then(function(e){return e.resourceKey})})}),J=new j.t({name:"RecentDataSource.key",loader:new T.t(function(){return n.e("288").then(n.bind(null,4009)).then(function(e){return e.resourceKey})})}),K=n(3121),Q=n(1049),G=new j.t({name:"SiteDocumentLibrariesDataSource.key",loader:new T.t(function(){return n.e("290").then(n.bind(null,4140)).then(function(e){return e.resourceKey})})}),Y=new j.t({name:"SubsiteItemDataSource.key",loader:new T.t(function(){return n.e("292").then(n.bind(null,4010)).then(function(e){return e.resourceKey})})}),Z=new j.t({name:"RemoteSiteService.key",loader:new T.t(function(){return n.e("273").then(n.bind(null,3511)).then(function(e){return e.resourceKey})})}),ee=new j.t({name:"SharedItemDataSource.key_1",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("531")]).then(n.bind(null,4139)).then(function(e){return e.resourceKey})})}),te=new j.t({name:"SharedItemDataSource.key",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("523")]).then(n.bind(null,4108)).then(function(e){return e.resourceKey})})}),ne=new j.t({name:"ListItemsDataSourceDeferred.key",loader:new T.t(function(){return Promise.all([n.e("deferred.resx-deferred"),n.e("285")]).then(n.bind(null,4137)).then(function(e){return e.resourceKey})})}),re=n(2375),ie=n(274),se=n(3654),oe=n(91),ue=n(869),ae=n(1901),fe=n(354),le=n(99),ce=n(27),he=n(1604),pe=n(71),de=n(1744),ve=new j.t({name:"MruRecentListDataSource.key.mruRecentListDataSource",loader:new T.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("286")]).then(n.bind(null,4136)).then(function(e){return e.resourceKey})})}),me=n(1160),ge=n(787),ye=n(1517),be=n(1468),we=n(933),Ee=n(1518),Se=n(2099),xe=n(791),Te=n(645),Ne=n(12);n.d(t,"resourceKey",function(){return Oe});var Ce=new XMLSerializer,ke=Ne.e.isActivated("D349E556-140B-4BFA-8B14-5DD337AAFB41","7/2/2020","Use per-list store for MicroServiceDataSource"),Le=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,n.pageContext,n)||this,i=new M.e({name:r.getDataSourceName()+".constructor"});Ee.ABExperiment.Init(r._pageContext);try{r._itemsStore=n.itemsStore;r.apiUrlHelper=n.apiUrlHelper;r.itemUrlHelper=n.itemUrlHelper;r.itemParentHelper=n.itemParentHelper;r._urlDataSource=n.urlDataSource;r._engagement=r.resources.consume(O.e);r._useFolderScopedSearch=r.resources.consume(re.t);r._alwaysRenderFilesTitle=r.resources.consume(re.e);r._microServiceDataSource=n.microServiceDataSource;r._microServiceDataSourceStore=n.microServiceDataSourceStore;r._listDataSource=n.listDataSource;r._listContext=n.listContext;r._itemsPerGroup=r.createObservable(-1);r.resources.isExposed(S.s)||r.resources.expose(S.s,r._itemsPerGroup);r.resources.isExposed(ge.p)||r.resources.expose(ge.p,!1);r._enableComments=Object(k.isFeatureEnabled)(k.EnableCommentsInActivityFeed);var s=[r._urlDataSource.getRootItemKey(c.e.Files),r._urlDataSource.getRootItemKey(c.e.Recent),r._urlDataSource.getRootItemKey(c.e.SharedWithMe),r._urlDataSource.getRootItemKey(c.e.RecycleBin)],o=new(r.resources.consume(U.r));o.update(s.map(function(e){return new z.e(e).succeed({item:{key:e,type:v.e.Folder,isRootFolder:!0}})}));o.flush();r._listItemBuilder=n.listItemBuilder;r._listItemResultProcessor=n.listItemResultProcessor;r._subsiteItemResultProcessor=n.subsiteItemResultProcessor;n.identity&&(r._userIsAnonymous=n.identity.getIdentity().type===b.e.anonymous);r._spotlightDataSource=n.spotlightDataSource;r._onePageContext=n.onePageContext;r._contentTypes=n.contentTypes;i.end({resultType:_.e.Success})}catch(e){var u=void 0;u=e.message?e.message+" "+e.stack:"object"==typeof e?JSON.stringify(e):e;i.end({resultType:_.e.Failure,error:u})}return r}t.prototype.restoreAll=function(e){return null};t.prototype.createMountPoint=function(e){return null};t.prototype.removeMountPoint=function(e){return N.n.wrap(!1)};t.prototype.changeFolderType=function(e){return null};t.prototype.saveSortOrder=function(e){return null};t.prototype.addCoverPhotos=function(e){return null};t.prototype.removeCoverPhotos=function(e){return null};t.prototype.getOpenInClientDetails=function(e){return null};t.prototype.removeFromRecent=function(e){return N.n.wrap(!1)};t.prototype.rotateItems=function(e){return N.n.wrap()};t.prototype.updateBundle=function(e){return null};t.prototype.reportAbuse=function(e){return null};t.prototype.requestReview=function(e){return null};t.prototype.updateItemOcrInfo=function(e,t,n){return null};t.prototype.getItemOcrTextContent=function(e){var t=e.properties.MediaServiceOCR||"";return N.n.wrap(t)};t.prototype.updateItemProperty=function(e){return null};t.prototype.redeemPermissionToken=function(e){return N.n.wrap(null)};t.prototype.updateViewCount=function(e){return N.n.wrap(null)};t.prototype.processReferral=function(e,t){return null};t.prototype.getItem=function(e){function t(t){return t.then(function(t){return t.getItem(e)})}var n=this._urlDataSource.getKeyParams(e.parentKey),r=this._urlDataSource.getQueryType(n);e.qosName=e.qosName||"Odb."+c.e[r]+".ListItemsDataSource.getItem";switch(r){case c.e.RecycleBin:case c.e.SecondStageRecycleBin:return t(this._getRecycleBinDataSource());case c.e.Search:return this._useFolderScopedSearch?this._getItem(e):t(this._getSearchDataSource());case c.e.SearchOdbScope:return t(this._getSearchDataSource());case c.e.SharedWithMe:return t(this._pageContext.groupId?this._getSharedItemDataSource():this._getVroomSharedItemDataSource());case c.e.SharedByMe:case c.e.DocsInCommon:return t(this._getSharedItemDataSource());case c.e.Recent:return t(Number(this._pageContext.webTemplate)===y.e.mySite?this.resources.consumeAsync(ve.bypass):this.resources.consumeAsync(J.bypass));case c.e.Popular:case c.e.RecentUnpopular:return t(this.resources.consumeAsync($.bypass));case c.e.DocumentLibraries:return t(this.resources.consumeAsync(G.bypass));case c.e.Subsites:return t(this.resources.consumeAsync(Y.bypass));default:return this._getItem(e)}};t.prototype.getSpecifiedItems=function(e){var t=this,n={parentKey:e.parentKey||this._urlDataSource.getDefaultRootItemId(),itemKeys:e.itemKeys,recurseInFolders:e.recurseInFolders,getRootFolderFromParentKey:e.getRootFolderFromParentKey,viewId:null,needContentTypes:e.needContentTypes,itemSetKey:""},i=Object(r.__assign)({itemIds:null,recurseInFolders:!1,folderPath:null},this._listContext);this._listContext.itemIds=e.itemKeys;this._listContext.recurseInFolders=e.recurseInFolders;this._listContext.needSchema=!!e.needSchema;this._listContext.needForm=!!e.needForm;this._listContext.isGrouped=!1;this._listContext.group=null;this._listContext.groupBy=null;this._listContext.groupByOverride=null;this._listContext.groupLevel=null;this._listContext.groupSchema=null;this._listContext.isGrouped=!1;this._listContext.lastGroup=null;this._listContext.viewResult=null;this._listContext.viewIdForRequest=null;this._listContext.viewXmlForRequest=null;this._listContext.filterParams="";this._listContext.sortField=null;this._listContext.searchTerm=null;this._listContext.requestToken=null;n.parentKey&&(this._listContext.folderPath=this._getFolderPath(n.parentKey));var s=new M.e({name:this.getDataSourceName()+".GetSpecifiedItems"});return this._getItemInternal(n).then(function(e){e.children&&e.children[0]?s.end({resultType:_.e.Success}):s.end({resultType:_.e.Failure,resultCode:"ItemNotFound"});for(var n=0,r=Object.keys(i);n<r.length;n++){var o=r[n];t._listContext[o]=i[o]}return e},function(e){s.end({resultType:_.e.Failure,resultCode:"ServerError",extraData:{error:e}});for(var n,r=0,o=Object.keys(t._listContext);r<o.length;r++){n=o[r];t._listContext[n]=null}for(var u=0,a=Object.keys(i);u<a.length;u++){n=a[u];t._listContext[n]=i[n]}return e})};t.prototype.getFilterData=function(e,t,n,r){if(this._urlDataSource.isCurrentQuery(c.e.SharedWithMe))return N.n.wrap();var i=this._urlDataSource.getCurrentItemKey(ie.e(t)),s=this._getFolderPath(i);return new ae.e({parentKey:i,listContext:this._listContext,pageContext:this._pageContext,folderPath:s,itemUrlHelper:this.itemUrlHelper,apiUrlHelper:this.apiUrlHelper}).getFilterData(e,t,n,r)};t.prototype.createDocument=function(e,t,n,r){return this._getDeferredDataSource().then(function(i){return i.createDocument(e,t,n,r)})};t.prototype.createCustomDocument=function(e,t,n){return this._getDeferredDataSource().then(function(r){return r.createCustomDocument(e,t,n)})};t.prototype.createFolder=function(e){return this._getDeferredDataSource().then(function(t){return t.createFolder(e)})};t.prototype.deleteItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.deleteItems(e)})};t.prototype.moveItems=function(e){return this._getDeferredDataSource().then(function(t){return t.moveItems(e)})};t.prototype.copyItems=function(e){return this._getDeferredDataSource().then(function(t){return t.copyItems(e)})};t.prototype.getWorkProgress=function(e){return this._getDeferredDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.cancelWork=function(e){return this._getDeferredDataSource().then(function(t){return t.cancelWork(e)})};t.prototype.restoreItems=function(e){return this._getRecycleBinDataSource().then(function(t){return t.restoreItems(e)})};t.prototype.renameItem=function(e){return this._getDeferredDataSource().then(function(t){return t.renameItem(e)})};t.prototype.removeFromSharedList=function(e){return this._getDeferredDataSource().then(function(t){return t.removeFromSharedList(e)})};t.prototype.updateContentType=function(e,t,n){return this._getDeferredDataSource().then(function(r){return r.updateContentType(e,t,n)})};t.prototype.getDataSourceName=function(){return"ListItemDataSource"};t.prototype._isRequestingListViewData=function(e){return new RegExp("web/.*?/RenderListDataAsStream").test(e)};t.prototype._getPostDataContext=function(e){var t=!!this._listContext.needSchema||!this._listContext.listSchema||this._listContext.isGrouped&&!this._isExpandingGroup()||e.isGrouped,n=!!e.needContentTypes||!!this._listContext.needContentTypes;this._isFirstGroupOnlyQuery=!this._supportsNestedGroups&&0===this._listContext.groupLevel&&this._listContext.groupBy&&this._listContext.groupBy.length>1;var r=!1;if(e.parentKey&&this._spotlightDataSource&&!this._isSpecifiedItemRequest()){var i=this._listContext.viewIdForRequest;r=this._spotlightDataSource.shouldFetchSpotlight(e.parentKey,i,this._listContext)}var s=!!this._listContext.viewIdForRequest&&!this._listContext.viewResult,o=this._userIsAnonymous,u=this._fetchNextGroup(),a=e.additionalFiltersXml;if(u){var f=V.t(this._listContext.lastGroup);if(this._listContext.viewXmlForRequest){var l=fe.t(this._listContext.viewXmlForRequest);if(l&&l.where){var c=l.where.innerHTML?le.e([l.where.innerHTML,f]):f,h=B.format("<{0}>{1}</{0}>",ce.n.where,c),p=Ce.serializeToString(l.where);this._listContext.viewXmlForRequest=this._listContext.viewXmlForRequest.replace(p,h)}}else a=a?"<And>"+a+f+"</And>":f}var d=!(e.sortField||Number(this._pageContext.webTemplate)!==y.e.mySite||!this._pageContext.isSiteAdmin||this.itemUrlHelper.getItemUrlParts(e.parentKey).isCrossList),v=!this._listContext.needUpdatePageContext&&e.needClientSideComponentManifest,m=!!e.needsMountPoint;return{needsSchema:t,needsContentTypes:n,needsForms:!!this._listContext.needForm,needsQuickLaunch:!1,needsSpotlight:r,needsViewMetadata:s,needsParentInfo:o,viewXml:this._getViewXml(),firstGroupOnly:this._isFirstGroupOnlyQuery,expandGroups:this._expandGroup,allowMultipleValueFilterForTaxonomyFields:!!this._pageContext.isSPO||void 0,fieldNames:this._listContext.fieldNames,requestToken:this._listContext.requestToken,isListDataRenderOptionChangeFeatureEnabled:Object(k.isFeatureEnabled)(k.ListDataRenderOptionChange),isSpotlightFeatureEnabled:Object(k.isFeatureEnabled)(k.Spotlight),groupByOverride:this._listContext.groupByOverride,requestDatesInUtc:Number(this._pageContext.webTemplate)===y.e.mySite&&Object(k.isFeatureEnabled)(k.RequestDatesInUtc),needUpdatePageContext:!!this._listContext.needUpdatePageContext,needClientSideComponentManifest:v,groupReplace:!!this._groupReplace,additionalFiltersXml:a,webId:e.webId,siteId:e.siteId,mergeDefaultView:d,needsMountPoint:m}};t.prototype._processData=function(e,t,n){oe.n.mark("EUPL.ListItemDataSource.ProcessData.Start");var s,o=e.parentKey,u=n.ListData||n,a=u.Row,f=this._urlDataSource.getKeyParams(o),l=f.id,c=this._listContext.listSchema,p=n.ListContenTypes,d=this._onePageContext,v=d&&d.handleOnePageNavigationFallback,g=null;e.itemSetKey&&(s=this._itemsStore.getItemSet(e.itemSetKey));n.ListSchema&&(g=n.ListSchema.CustomFormatter);var y=n.NewExperienceRendering,b=void 0===y||y,w=n.ListSchema,E=n.ListData;if(!b&&v){v("modern UX is not supported");throw{code:"-4, onePageNavigationError"}}n.PageContextInfo&&this._updatePageContextInfo(n.PageContextInfo);se.e.updateListContext(n,this._listContext);if(w){var S={};c=this._listContext.listSchema=Object(i.t)({listSchema:w,resources:this.resources,groupSchema:S,hasFixedSchema:this._listContext.listTemplateType===m.t.mySiteDocumentLibrary,listContext:this._listContext,getItemContext:e,sortFallback:{sortField:E.SortField,sortDirection:E.SortDir}});w.group1&&(this._listContext.groupSchema=S)}else s&&s.schema&&s.schema.peek()&&(c=this._listContext.listSchema=s.schema.peek());n.Navigation&&(this._listContext.leftNavigationData={quickLaunchNodes:n.Navigation.Nodes});if(n.ViewMetadata&&d){var x=this._listContext.viewResult.serverRelativeUrl,T=this._listContext.viewResult.id,N=d.newTargetListViewUrl,C=d.newTargetListViewId;if(x&&N&&-1===N.toLowerCase().indexOf(x.toLowerCase())&&T&&C!==T&&v){v("view does not match");throw{code:"-4, onePageNavigationError"}}d.newTargetListViewId=d.newTargetListViewUrl=void 0}var A=w&&"TRUE"===w.Collapse,O=!A&&a?a.slice(0):[];l&&l!==this._urlDataSource.getDefaultRootItemId()||(l=this._listContext.listUrl);var M="";u.NextHref&&(M=(M=u.NextHref).replace("&View="+L.default.Empty,""));var _=new(this.resources.consume(U.r));this._processResponse({response:n,observer:_,requestKey:o});this.resources.consumeAsync(F.optional).then(function(e){e&&e.trackListToken(o)});var D={id:f.id,folder:{childCount:O.length,children:O},nextRequestToken:M,PermMask:u.FolderPermissions,groups:A?a:null,isRootFolder:!1};if(Object(Se.t)()){var P=n&&n.ListData&&n.ListData.CurrentFolderProgId;D.ProgId=P}Object(h.e)(t)&&this._engagement.logData({name:"Search.InpageNumResults",extraData:{count:O.length}});var H=null;if(this._listContext.groupByOverride)H=[this._listContext.groupByOverride];else if(this._listContext.rawListSchema&&this._listContext.rawListSchema.group1){(H=[]).push(this._listContext.rawListSchema.group1);this._listContext.rawListSchema.group2&&H.push(this._listContext.rawListSchema.group2);this._isFirstGroupOnlyQuery||(this._listContext.groupBy=H)}this._listContext.groupLevel=this._getGroupLevel();this._listContext.isGrouped=!!H;1===e.groupingType&&(H=["__ItemType"]);this._contentTypes&&(p?this._contentTypes(p):p=this._contentTypes.peek());if(c&&p){for(var B={},j=0,I=c;j<I.length;j++){var q=I[j];B[q.internalName]=Object(r.__assign)(Object(r.__assign)({},q),{requiredForContentTypes:{}})}for(var R=0,z=p;R<z.length;R++){if(Z=(Y=z[R]).requiredFields&&Y.requiredFields.split(","))for(var W=0,X=Z;W<X.length;W++){var V=X[W];B[V]&&(B[V].requiredForContentTypes[Y.contentTypeId]=!0)}}c=c.map(function(e){return B[e.internalName]})}if(p&&p.length>0){for(var $={},J={},K={},Q=0,G=p;Q<G.length;Q++){var Y,Z=(Y=G[Q]).requiredFields&&Y.requiredFields.split(","),ee=Y.requiredLookups&&Y.requiredLookups.split(",");$[Y.contentTypeId]=Z;if(Z)for(var te=0;te<Z.length;te++){var ne=Z[te];J[ne]||(J[ne]=!0);K[ne]=ee&&"True"===ee[te]}}this._listContext.contentTypeRequiredFields=$;this._listContext.requiredFieldsAreLookups=K;this._listContext.requiredFields=Object.keys(J);this._listContext.needContentTypes=!1}var re=this._listItemBuilder.getItemResult({requestKey:o,queryType:t,itemFromServer:D,groupBy:H,itemGroups:null,contentTypes:p,supportsNestedGroups:this._supportsNestedGroups,observer:_}),ie=re.children,ue=re.item,ae=re.groupings,fe=re.totalChildren;this._processListTitleOverride({response:n,listUrl:this._getListUrl(o),requestKey:o,observer:_});e.skipStoreResults||_.flush();Object(k.isFeatureEnabled)(k.Spotlight)&&this._cacheSpotlightItemsFromServerData({requestKey:o,parentItem:this._itemsStore.getItem(o),queryType:t,spdata:n});var le,ce,he=this._itemsStore.getItem(ue.key);if(ie){le=[];for(var pe=0,de=ie;pe<de.length;pe++){var ve=de[pe];le.push(this.peekUnwrapObservable(this._itemsStore.getItem(ve.key)))}}if(ae&&ae[0]){var me=ae[0].itemGroups,ge=me[me.length-1];ge.fieldSchema&&this._listContext.groupSchema[ge.fieldSchema.Name]&&(this._listContext.lastGroup=ge)}for(var ye=0,be=c;ye<be.length;ye++){if((q=be[ye]).internalName===this._listContext.sortField){ce=q.key;break}}var we={item:this.peekUnwrapObservable(he),groupings:ae,children:le,totalChildren:fe,schema:c,contentTypes:p,nextRequestToken:M,sortField:ce,isAscending:"true"===this._listContext.isAscending,customViewRenderer:g,viewId:this._listContext.viewResult?this._listContext.viewResult.id:void 0};this._listContext.group?we.startIndex=this._listContext.group.startIndex:u.FirstRow&&(we.startIndex=u.FirstRow-1);n.isFromServiceWorkerCache?we.isFromBrowserCache=!0:we.isFromBrowserCache=!1;oe.n.mark("EUPL.ListItemDataSource.ProcessData.End");return we};t.prototype._processResponse=function(e){var t,n,r=e.response,i=e.requestKey,s=e.observer,o=this.itemUrlHelper.getItemUrlParts(i);if(Ae(r)){t=r;n=r.ListSchema}else t={ListData:r};var u=this._listItemResultProcessor.processResponse({response:t,requestKey:i,observer:s}).listRootItemKey;if(n){var a={data:n,allowCookies:this._isOneDrive(o.normalizedListUrl)};if(!ke){this._microServiceDataSourceStore.getOrCreateMicroServiceDataSource(u).setBaseInfo(a)}this._microServiceDataSource.setBaseInfo(a)}};t.prototype._updatePageContextInfo=function(e){try{var t=JSON.parse(e);t.serverRequestPath=void 0;this.updateContext(t);this._defaultListUrl=t.listUrl}catch(e){}};t.prototype._getFolderPath=function(e,t){var n=this._urlDataSource.getKeyParams(e).id;return n&&n!==this._urlDataSource.getDefaultRootItemId()?n:null};t.prototype._getListUrl=function(e){var t=this._urlDataSource.getKeyParams(e),n=t&&t.listurl;n||(n=this._listContext.listUrl);return n};t.prototype._isOneDrive=function(e){return!this.itemUrlHelper.getItemUrlParts(e).isCrossList&&this._listContext.listTemplateType===m.t.mySiteDocumentLibrary};t.prototype._processListTitleOverride=function(e){var t,n,i=e.response,s=e.requestKey,o=e.observer;n=Ae(i)?i:{ListData:i};var u,l,h=this._urlDataSource.getKeyParams(s),p=h.q,d=this.itemUrlHelper.getItemUrlParts(s),v=this.itemUrlHelper.getUrlParts({path:d.serverRelativeListUrl,listUrl:d.fullListUrl}),g=n.ListTemplateType;if(this._urlDataSource.isCurrentQuery(c.e.Search,h)&&p){!Ne.e.isActivated("5631af76-a985-4c61-8139-789b19820d3d","9/21/2020","Align SP list search result title with odb shared library")&&Object(k.isFeatureEnabled)(k.CSISpoScopeControl)||(u=B.format(f.e.SearchResultsTitle,p));l=c.e.Search}else(this._alwaysRenderFilesTitle||Number(g)===m.t.mySiteDocumentLibrary)&&(u=a.e.Files);if(u){var y=this._urlDataSource.getKey(((t={}).id=v.serverRelativeItemUrl,t.listurl=v.normalizedListUrl,t.view=h.view,t.q=h.q,t.typeFilters=h.typeFilters,t));o.update([new z.e(y).succeed({item:Object(r.__assign)({key:y,name:u,displayName:u},void 0!==l?{queryType:l}:{})})])}};t.prototype._setContext=function(e){var t=this,n=this._urlDataSource.getKeyParams(e.parentKey),r=e.newTargetListUrl||n.listurl||this._defaultListUrl,i=this._urlDataSource.getItemTypeFilter(n);this._supportsNestedGroups=e.supportsNestedGroups;this._expandGroup=e.expandGroup;this._groupReplace=e.groupReplace;var s=e.baseViewId,o=e.viewXml,u=e.filters,a=void 0===u?{}:u,f=e.sortField,l=e.isAscending,c=e.requestToken,h=e.needSchema,p=e.pageSize,d=void 0===p?30:p,v=e.parentKey,m=e.groupBy,g=e.group,y=e.query,b=e.queryType,w=e.needUpdatePageContext,E=e.resultSetOptions,S=(void 0===E?{}:E).fieldNames,x=void 0===S?[]:S,T=e.viewPath;r&&(this._listContext.listUrl=r);this._listContext.filterParams=Object.keys(a||{}).map(function(e){return"&"+e+"="+C.e.encodeURIComponent(a[e])}).join("");this._listContext.itemIds=null;this._listContext.requestToken=c;this._listContext.needSchema=!!h;this._listContext.pageSize=d;this._listContext.folderPath=this._getFolderPath(v,e);this._listContext.groupByOverride=m;this._listContext.groupLevel=this._getGroupLevel();this._listContext.group=g;this._listContext.searchTerm=y;this._listContext.queryType=b;this._listContext.typeFilter=i;this._listContext.fieldNames=x;var N=this._urlDataSource.getKeyParams(v);!N.listurl&&e.newTargetListUrl&&(N.listurl=e.newTargetListUrl);var k=this._urlDataSource.getKey(N);this._listContext.urlParts=this.itemUrlHelper.getItemUrlParts(k);this._listContext.needUpdatePageContext=!!w;!this._listContext.refreshClientForm&&this._listContext.needUpdatePageContext&&(this._listContext.refreshClientForm=!0);try{var L=JSON.stringify({defaultFullWebUrl:this._pageContext.webAbsoluteUrl,defaultListUrl:this._pageContext.listUrl,keyParts:n});ue.e.logData({name:"ListItemsDataSource._setContext",message:L})}catch(e){}return this._loadRemoteParentWeb({parentKey:v,remoteWebUrl:e.remoteWebUrl}).then(function(){return t._loadView({fieldNames:x,typeFilter:i,baseViewId:s,viewXml:o,viewPath:T,listFullUrl:t._listContext.urlParts.fullListUrl})}).then(function(){if(f){t._listContext.sortField=f;t._listContext.isAscending=!1===l?"false":"true"}else if(t._isUsingView()){t._listContext.sortField=null;t._listContext.isAscending=null}})};t.prototype._loadRemoteParentWeb=function(e){var t,n=this,r=e.parentKey,i=e.remoteWebUrl;delete this._listContext.remoteParentWeb;var s=this.itemUrlHelper.getItemUrlParts(r),o=s.fullListUrl;if(i){var u=new URL(i).origin;o=u+s.serverRelativeListUrl}s.isCrossList&&s.siteRelation!==W.t.sameSite&&(t=this.resources.consumeAsync(Z.bypass).then(function(e){return e.getSiteForList(o,s.siteRelation)}).then(function(e){n._listContext.remoteParentWeb=e;var t=new(n.resources.consume(U.r));n._subsiteItemResultProcessor.processSubsite({subsite:e,requestKey:r,observer:t});t.flush()},function(e){}));return N.n.as(t).then(function(){})};t.prototype._loadView=function(e){var t,n=this,r=e.fieldNames,i=e.typeFilter,s=e.baseViewId,o=e.viewXml,u=e.viewPath,a=e.listFullUrl;this._setViewIdAndPath(s,u);var f=r.filter(function(e){return"name.FileSystemItemId"!==e});(i.filters.length||f.length)&&s&&!o&&(t=this._listDataSource.getView({id:s},a).then(function(e){o=e.getEffectiveViewXml();n._listContext.viewResult=e}));return N.n.as(t).then(function(){n._listContext.viewXmlForRequest=o})};t.prototype._getViewXml=function(){var e=this._listContext,t=e.fieldNames,n=void 0===t?[]:t,i=e.typeFilter,s=void 0===i?{filters:[]}:i,o=e.viewXmlForRequest,u=e.sortField,a=e.isAscending,f=e.groupByOverride;if(!u&&!this._isUsingView()&&!this._isTeamSiteLike()){u="LinkFilename";a="true"}var c=n.filter(function(e){return"name.FileSystemItemId"!==e}),h="";if(this._isSpecifiedItemRequest()||!this._isUsingView())h=V.r({sortField:u,itemIds:this._listContext.itemIds,isAscending:a,pageSize:this._listContext.pageSize,fetchNextGroup:void 0,lastGroup:this._listContext.lastGroup,recurseInFolders:this._listContext.recurseInFolders,fieldNames:c,typeFilter:s,groupBy:this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,userIsAnonymous:this._userIsAnonymous,requestMetaInfo:Object(k.isFeatureEnabled)(k.EnablePowerPointWrsPreview)||Object(k.isFeatureEnabled)(k.EnableWordWrsPreview),requestCommentFlags:this._enableComments});else if(o)if(u||f||s.filters.length||c.length){var p=new l.e(o);u&&p.updateSort(null,{overwriteAll:!0});f&&p.updateGroupBy({isCollapsed:!1,group1:{fieldName:f}});s.filters.length&&p.addFilters([V.n(s)]);c.length&&p.replaceFields(Object(r.__spreadArrays)(p.getEffectiveFieldNames(),c));h=p.getEffectiveViewXml()}else h=this._listContext.viewXmlForRequest;return h};t.prototype._getItem=function(e){var t=this,n=this.itemUrlHelper.getItemUrlParts(e.parentKey),r=this.peekUnwrapObservable(this._itemsStore.getItem(e.parentKey));if(e.newTargetListUrl||e.requestToken||r&&r.type===v.e.Folder||n.fullItemUrl===n.fullListUrl||r&&r.remoteItem||e.remoteItem||e.isMountPointFolder)return this._getAsFolder(e);if(r&&(r.type===v.e.File||r.type===v.e.Media||r.type===v.e.Unknown||r.type===v.e.Shortcut)||e.ignoreChildren){oe.n.mark("EUPL.OneUP.GetSingleItem.Start");return this._getSingleItem(e)}return this._getAsFolder(e).then(function(n){var r=t.peekUnwrapObservable(t._itemsStore.getItem(n.item.key));if(!w.e.hasPermission(r.permissions,w.e.openItems)&&!n.totalChildren){oe.n.mark("EUPL.NoOneUP.GetSingleItem.Start");return t._getSingleItem(e).then(function(e){var r=n&&t.peekUnwrapObservable(t._itemsStore.getItem(n.item.key));return r&&r.type!==v.e.Folder?e:n})}t._listContext.listTemplateType===m.t.mySiteDocumentLibrary&&t._getSingleItem(e).done();return n})};t.prototype._getAsFolder=function(e){var t=this,n=this._listContext;e.ignoreListContext&&(this._listContext={});return this._setContext(e).then(function(){return t._getItemInternal(e).then(function(r){e.ignoreListContext&&(t._listContext=n);return r})})};t.prototype._getRemoteItemUrl=function(e){return e.SiteUrl+"/_api/web/Lists/GetById(@a1)/RenderListDataAsStream?@a1="+e.ListId+"&RootFolderUniqueId=$"+e.UniqueId};t.prototype._getRemoteItemPostData=function(){return JSON.stringify({parameters:{RenderOptions:7}})};t.prototype._getSingleItem=function(e){var t,n=this,r=this.itemUrlHelper.getItemUrlParts(e.parentKey),i=new X.e({pageContext:this._pageContext}),s=this.itemUrlHelper.getUrlParts({path:r.serverRelativeListUrl,listUrl:r.fullListUrl}),o=this._urlDataSource.getKey(((t={}).id=s.serverRelativeItemUrl,t.listurl=s.normalizedListUrl,t)),u=V.r({sortField:void 0,itemIds:void 0,itemRefs:[r.serverRelativeItemUrl],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:this._enableComments,pageSize:1}),a=new M.e({name:"GetSingleItem"}),f={viewXml:u,needsSchema:!0,needsParentInfo:!0,isListDataRenderOptionChangeFeatureEnabled:Object(k.isFeatureEnabled)(k.ListDataRenderOptionChange)},l={urlParts:s},h=e.remoteItem?this._getRemoteItemUrl(e.remoteItem):i.getUrl(l,e),p=e.remoteItem?this._getRemoteItemPostData():i.getAdditionalPostData(f);return this._tryGetPrefetchedListViewData({url:h,parseResponse:function(e){var t=e.listData;return JSON.parse(t)},qosName:"GetSingleItemFromPrefetchedData",qos:a,additionalPostData:p,fallbackGetData:function(){var t={parentKey:o,postDataContext:f,skipServiceWorkerCache:!1,remoteItem:e.remoteItem,authToken:e.authToken,siteUrl:e.remoteWebUrl};e.skipCache&&(t.skipServiceWorkerCache=!0);var n={qosEvent:a,qosName:"GetData"};return i.getItem(t,l,n)}}).then(function(t){var r=new(n.resources.consume(U.r));n._processResponse({response:t,requestKey:o,observer:r});var i=t.ListData.Row,s=!i.length&&n._getError(-2147024894);if(s)r.update([new z.e(e.parentKey).succeed({item:{key:e.parentKey,type:v.e.Error,error:{type:2,data:s},isPlaceholder:!1}})]);else for(var u=(function(e){var t=e.ListTemplateType,n=Number(t);return isNaN(n)?void 0:n})(t),f=0,l=i;f<l.length;f++){var h=l[f];n._listItemBuilder.getItemResult({requestKey:o,queryType:c.e.Files,itemFromServer:h,listTemplateType:u,supportsNestedGroups:!1,observer:r})}n._processListTitleOverride({response:t,listUrl:n._getListUrl(o),requestKey:o,observer:r});r.flush();a.end({resultType:_.e.Success});return s?N.n.wrapError(s):{item:{key:e.parentKey},children:[],totalChildren:0}},function(t){var r=t?"string"==typeof t.code?t.code.split(","):t.error.code.split(","):[],i=r.length>1?Number(r[0]):-1,s=n._getError(i,void 0,t),o=new(n.resources.consume(U.r));o.update([new z.e(e.parentKey).succeed({item:{key:e.parentKey,type:v.e.Error,isPlaceholder:!1,error:{type:2,data:s}}})]);o.flush();return N.n.wrapError(s)})};t.prototype._isUsingView=function(){return!(!this._listContext.viewXmlForRequest&&!this._listContext.viewIdForRequest)};t.prototype._isTeamSiteLike=function(){return Object(y.n)(this._pageContext.webTemplate)};t.prototype._getItemInternal=function(e){var t=this,n=this._urlDataSource.getKeyParams(e.parentKey),i=this._urlDataSource.getQueryType(n),s=new M.e({name:"GetPrefetchedListViewData"}),o=new X.e({pageContext:this._pageContext}),u=i===c.e.Files,a=Object(h.e)(i),f=this._getPostDataContext(e),l=function(e){e.resultCode&&(e.resultCode="GetData."+e.resultCode);switch(e.resultType){case _.e.ExpectedFailure:we.t(e);break;case _.e.Failure:we.r(e)}},p=function(){var n=Object(r.__assign)({},e);n.postDataContext=t._getPostDataContext(e);e.skipCache&&(n.skipServiceWorkerCache=!0);var u={qosEvent:s,qosName:a?"SearchGetData":"GetData"};return o.getItem(n,t._listContext,u,l).then(function(n){return t._handleDataProcessing(n,i,e)})},d=o.getUrl(this._listContext,e);return(u&&this._isRequestingListViewData(d)?this._tryGetPrefetchedListViewData({url:d,parseResponse:function(n){var r,i=n.listData;try{"string"==typeof i&&(r=JSON.parse(i))}catch(e){if("{}"!==i.substring(0,2)){s.end({resultType:_.e.Failure,resultCode:"BadJSON",extraData:{responseText:i,prefetch:"true"}});throw e}r=JSON.parse(i.substring(2))}return t._handleDataProcessing(r,e.queryType,e)},qosName:"GetItemFromPrefetchedData",qos:s,additionalPostData:o.getAdditionalPostData(f),fallbackGetData:p}):p()).then(function(e){return e},function(e){if(void 0===e.code&&void 0===e.error)return N.n.wrapError(e);var n="string"==typeof e.code?e.code.split(","):e.error.code.split(","),r=n.length>1?Number(n[0]):-1;return N.n.wrapError(t._getError(r,void 0,e))})};t.prototype._tryGetPrefetchedListViewData=function(e){var t=this;0;oe.n.mark("EUPL.GetPrefetch.Start");var n=e.url,r=e.qos,i=e.fallbackGetData,s=e.additionalPostData,u=o.e.createHashCode(n,s);window.ListDataActualHash=u;var a=o.e.prefetchData(u);if(!a){if(o.e.shouldLogError){var f=-1===n.indexOf("?")?null:ie.e(n.substring(n.indexOf("?")+1));r.end({resultType:_.e.Failure,resultCode:"PrefetchNotStartedOrUrlOrPayLoadNotMatch",extraData:{AdditionalPostData:s||"null",QueryStrings:f?Object.getOwnPropertyNames(f):"null"}});o.e.shouldLogError=!1}0;return i()}o.e.shouldLogError=!1;var l=function(){var e=o.e.createHashCode("ListContenTypes","ListContenTypes"),n=o.e.prefetchData(e);n&&n.listData?t._contentTypes&&t._contentTypes(n.listData):a&&(a.contentTypesCallback=l)};l();var c=function(t,f){var l=function(l,c){if(200===l||c){r.end({resultType:_.e.Success});var h=oe.n.getResponseEnd();if(l&&!c){oe.n.summary.dataFetchServerTime=a.serverDuration;if(window.performance&&performance.timing){oe.n.summary.prefetchStart=a.startTimeMark-h;window.g_prefetchStart=oe.n.summary.prefetchStart}var p=P.default.getRUMOneLogger();if(p){var d=a.correlationId,v=new H(n,a.serverDuration,d,l,null,(new Date).toISOString());p.writeAPICallPerformanceData(v)}oe.n.mark("EUPL.Prefetch.End")}else if(c){if(window.g_deferDataLoadTime&&window.performance&&performance.timing){oe.n.summary.deferredListDataRender=Number(window.g_deferDataLoadTime)-h;window.g_deferredListDataRender=oe.n.summary.deferredListDataRender}oe.n.mark("EUPL.DeferredListData.End")}try{var m=e.parseResponse(a);t(m)}catch(e){f(e)}}else{(403===l?{resultType:_.e.ExpectedFailure,resultCode:"PrefetchUnauthorized"}:{resultType:_.e.Failure,resultCode:"PrefetchFailed"}).extraData={AdditionalPostData:s||"null",ResponseStatusCode:l};0;i().then(t,f)}o.e.clearPrefetchData(u)};a.responseCode||a.deferredListData?l(a.responseCode,a.deferredListData):a.completedCallback=l};return D.e.instrumentPromise({url:n,name:this.getDataSourceName()+"."+e.qosName},function(){return new N.n(c)},null,function(e){return e&&"Canceled"===e.name?{error:e,resultCode:"Canceled",resultType:_.e.ExpectedFailure}:{error:e,resultType:_.e.Failure}})};t.prototype._setViewIdAndPath=function(e,t){if(e){e=L.default.normalizeLower(e,!1);this._listContext.viewIdForRequest=e;this._listContext.viewResult&&this._listContext.viewResult.id!==e&&(this._listContext.viewResult=null)}e&&e!==L.default.Empty||!t||(this._listContext.viewPathForRequest=t)};t.prototype._getError=function(e,t,n){var r=n&&n.correlationId,i={ItemNotFoundTitle:u.e.ItemNotFoundTitle,ItemNotFoundSubText:u.e.ItemNotFoundSubText,InvalidViewTitle:u.e.InvalidViewTitle,InvalidViewSubText:u.e.InvalidViewSubText,InvalidListTitle:u.e.InvalidListTitle,InvalidListSubText:u.e.InvalidListSubText,QueryThrottledSubText:u.e.QueryThrottledSubText,QueryThrottledLinkText:u.e.QueryThrottledLinkText,DefaultTitle:u.e.DefaultTitle,DefaultSubText:u.e.DefaultSubText};-2147024860===e&&this._engagement.logData({name:"listView.Throttled",extraData:{correlationId:n.correlationId}});return Object(me.e)(e,i,r)};t.prototype._fetchNextGroup=function(){return this._listContext.isGrouped&&this._listContext.group&&"__next__"===this._listContext.group.groupingId&&!(this._groupReplace&&this._listContext.lastGroup&&this._listContext.lastGroup.count<this._itemsPerGroup.peek())&&!this._isSpecifiedItemRequest()};t.prototype._isSpecifiedItemRequest=function(){return this._listContext.itemIds&&this._listContext.itemIds.length>0};t.prototype._isExpandingGroup=function(){return this._listContext.group&&"__next__"!==this._listContext.group.groupingId};t.prototype._getGroupLevel=function(){var e=-1,t=this._listContext.groupByOverride?[this._listContext.groupByOverride]:this._listContext.groupBy,n=this._listContext.rawListSchema&&"TRUE"===this._listContext.rawListSchema.Collapse;if(t&&t.length>0){e=0;if(this._supportsNestedGroups){if(this._listContext.filterParams&&!n){var r=(i=A.default.getFilterFieldByName(this._listContext.filterParams,t[0]))&&t[1]&&A.default.getFilterFieldByName(this._listContext.filterParams,t[1]);(i&&1===t.length||r&&2===t.length)&&(e=-1)}}else if(this._listContext.filterParams){var i;if(i=A.default.getFilterFieldByName(this._listContext.filterParams,t[0])){e=(r=A.default.getFilterFieldByName(this._listContext.filterParams,t[1]))&&!n?-1:1}}}return e};t.prototype._cacheSpotlightItemsFromServerData=function(e){var t=e.requestKey,n=e.parentItem,r=e.queryType,i=e.spdata;if(this._spotlightDataSource&&i.SpotlightInfo&&this._listContext.viewIdForRequest&&n&&n.peek()&&n.peek().key){var s=[],o=this._spotlightDataSource;if(i.SpotlightInfo.Items&&i.SpotlightInfo.Items.Row&&i.SpotlightInfo.Order&&i.SpotlightInfo.Order.length){for(var u=i.SpotlightInfo.Items.Row,a=i.SpotlightInfo.Order,f=new(this.resources.consume(U.r)),l=[],c=0,h=u;c<h.length;c++){var p=h[c];l.push(this._listItemBuilder.getItemResult({requestKey:t,queryType:r,itemFromServer:p,groupBy:null,itemGroups:null,contentTypes:[],supportsNestedGroups:this._supportsNestedGroups,observer:f}).item)}f.flush();for(var d={},v=0,m=l;v<m.length;v++){var g=m[v].key;(w=this._itemsStore.getItem(g))&&(d[w.peek().properties.ID]=w)}for(var y=0,b=a;y<b.length;y++){var w;(w=d[b[y]])&&s.push(w)}}var E=this._listContext.viewIdForRequest===L.default.Empty?this._listContext.viewResult.id:this._listContext.viewIdForRequest;o.cacheSpotlightItems(n,E,s)}};t.prototype._getDeferredDataSource=function(){return this.resources.consumeAsync(ne)};t.prototype._getSearchDataSource=function(){return this.resources.consumeAsync(Q.e.bypass)};t.prototype._getSharedItemDataSource=function(){return this.resources.consumeAsync(te.bypass)};t.prototype._getVroomSharedItemDataSource=function(){return Object(Te.r)()?this._getSharedItemDataSource():this.resources.consumeAsync(ee.bypass)};t.prototype._getRecycleBinDataSource=function(){return this.resources.consumeAsync(K.e.bypass)};t.prototype._handleDataProcessing=function(e,t,n){var r=this;n.remoteItem&&(n.parentKey=e&&e.rootFolder?e.rootFolder:n.parentKey);var i,s=n.parentKey,o=e.ShouldLoadSPFramework,u=void 0!==o&&o,a=this._onePageContext&&this._onePageContext.handleOnePageNavigationFallback,f=!1;if(u){if(e.SPFrameworkClientInfo){this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(he.e));i=this._clientSideExtensionHelper.loadSPFrameworkForOnePageNavigation(e.SPFrameworkClientInfo)}else f=!0;if(f&&a){a("SPFramework");throw{code:"-4, onePageNavigationError"}}}var l=function(e){r._engagement.logData({name:"List."+e});e="EUPL."+e+".LoadModule.";oe.n.mark(e+"Start")},c=function(){var i=r._loadClientSideCustomizer(e,n.parentKey),o=r._getCustomFormatterModule(e);if(o||i){if(o&&i){l("MultipleCustomizers");return N.n.all([i,o]).then(function(e){var i=e[0],o=e[1],u=i;window.CustomFormatter=o.CustomFormatter;return r._onCustomLoadersEnd(n,u,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}if(o){l("CustomFormatter");return o.then(function(i){window.CustomFormatter=i.CustomFormatter;return r._onCustomLoadersEnd(n,e,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}l("ClientSideCustomizer");return i.then(function(e){return r._onCustomLoadersEnd(n,e,t,s,void 0)},function(i){return r._onCustomLoadersEnd(n,e,t,s,void 0)})}return r._processData(n,t,e)};return i?i.then(function(){return c()}).catch(function(e){a("SPFramework");throw{code:"-4, onePageNavigationError"}}):c()};t.prototype._onCustomLoadersEnd=function(e,t,n,r,i){oe.n.mark(i+"End");return this._processData(e,n,t)};t.prototype._getCustomFormatterModule=function(e){if(e&&e.ListSchema&&e.ListSchema.Field){for(var t=e.ListSchema.Field,r=!1,i=0;i<t.length;i++){var s=t[i];if(s.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterField."+s.FieldType,extraData:{templateId:this._getTemplateIdFromFormatter(s.CustomFormatter)}})}}if(e.ListSchema.CustomFormatter){r=!0;this._engagement.logData({name:"CustomFormatterViewLoad",extraData:{templateId:this._getTemplateIdFromFormatter(e.ListSchema.CustomFormatter)}})}if(r){this._engagement.logData({name:"CustomFormatterLoad"});return N.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("488")]).then(n.bind(null,3751))).then(xe.e)}}return null};t.prototype._getTemplateIdFromFormatter=function(e){try{var t=JSON.parse(e);if(t.templateId)return t.templateId}catch(e){}};t.prototype._loadClientSideCustomizer=function(e,t){var n,r=this,i=this._engagement;if(e.ListSchema)n=e.ListSchema.Field;else{var s=this._listContext.listSchema;n=s&&s.map(function(e){return{RealFieldName:e.realFieldName||e.internalName,ID:e.id,Type:e.serverFieldType,DisplayName:e.name,Name:e.name,ClientSideComponentId:e.clientSideComponentId,ClientSideComponentProperties:e.clientSideComponentProperties}})}if(n&&!(n.length<1)){if(this._prepareClientSideCustomizedFields(e,n)){var o=new M.e({name:"LoadFieldCustomizers"});oe.n.mark("EUPL.LoadFieldCustomizers.Start");this._clientSideExtensionHelper||(this._clientSideExtensionHelper=this.resources.consume(he.e));if(!this._clientSideExtensionHelper){console.log("Error on consuming ClientSideExtensionHelper");o.end({resultType:_.e.Failure,resultCode:"ConsumeClientSideExtensionHelperFailed"});oe.n.mark("EUPL.LoadFieldCustomizers.NoClientSideExtensionHelper.End");return N.n.wrap(e)}if(!window.moduleLoaderPromise){i.logData({name:"LoadSpfx.moduleLoaderPromiseNotFound",extraData:{SpModuleLoaderExists:!!window.spModuleLoader}});console.log("sp-client module loader promise does not exist")}return this._clientSideExtensionHelper.getListViewAdapter().then(function(t){try{if(!t){console.log("sp-client listViewHostApp failed to create listViewAdapter");o.end({resultType:_.e.Failure,resultCode:"FailToCreateListViewAdapter"});oe.n.mark("EUPL.LoadFieldCustomizers.Error.FailListViewAdapter.End");return e}oe.n.mark("EUPL.LoadFieldCustomizers.GotListViewAdapter");n.forEach(function(e,n,r){try{var i={id:e.ID,internalName:e.RealFieldName||e.Name,fieldType:e.FieldType,isRequired:!!e.Required&&"TRUE"===e.Required.toUpperCase(),isVisible:!0,displayName:e.DisplayName,clientSideComponentId:e.ClientSideComponentId,clientSideComponentProperties:e.ClientSideComponentProperties,onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(t){console.log("Fail to load customizer for column: "+e.Name+", componentId: "+e.ClientSideComponentId+", error: "+t.message)}},s=t.addColumnAdapter(i);if(!s)throw"addColumnAdapter returns null";if(i.clientSideComponentId&&i.clientSideComponentId!==L.default.Empty){e.ClientSideColumnAdapter=s;console.log("Add Spfx column adapter for "+e.RealFieldName)}}catch(t){console.log("Error on addColumnAdapter for column: "+e.Name+", error: "+t)}});return t.loadFieldCustomizers().then(function(t){console.log("fieldCustomizers loaded");o.end({resultType:_.e.Success});oe.n.mark("EUPL.LoadFieldCustomizers.End");r._logLoadFieldCustomizersResult(e);return e},function(t){console.log("fieldCustomizers failed to load, error: "+t);o.end({resultType:_.e.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersPromiseError",error:t});oe.n.mark("EUPL.LoadFieldCustomizers.PromiseError.End");return e})}catch(t){o.end({resultType:_.e.Failure,resultCode:"ListViewHostAppFailedToLoadCustomizersCatch",error:t});oe.n.mark("EUPL.LoadFieldCustomizers.Error.End");return e}})}return null}i.logData({name:"LoadSpfx.ListFieldsNotAvailable"})};t.prototype._logLoadFieldCustomizersResult=function(e){(e.ListSchema?e.ListSchema.Field:[]).forEach(function(e,t,n){if(e.ClientSideComponentId&&e.ClientSideColumnAdapter){var r="EUPL.LoadFieldCustomizers."+e.ClientSideComponentId+".";r+=e.ClientSideColumnAdapter.fieldCustomizerLoaded?"Loaded":"Failed";oe.n.mark(r)}})};t.prototype._prepareClientSideCustomizedFields=function(e,t){var n,r={},i=new pe.default(document.location.href),s=i.getQueryParameter("fieldCustomizers");try{if(n=JSON.parse(s))for(var o in n){var u=n[o],a="",f="";if("string"==typeof u)a=u;else if("object"==typeof u){u.id&&(a=u.id);if(u.properties){var l="";"object"==typeof u.properties&&(l=JSON.stringify(u.properties));f=l}}r[o]={internalName:o,clientSideComponentId:a,clientSideComponentProperties:f}}}catch(e){console.log("Error when parse query parameter: fieldCustomizers, error: "+e)}for(var c=!1,h=!1,p=0,d=t;p<d.length;p++){var v=d[p],m=v.RealFieldName,g=void 0;r.hasOwnProperty(m)&&(g=r[m]);if(g&&!v.CustomFormatter){v.ClientSideComponentId=g.clientSideComponentId;v.ClientSideComponentProperties=g.clientSideComponentProperties;c=!0}v.ClientSideComponentId&&v.ClientSideComponentId!==L.default.Empty&&!v.CustomFormatter&&(h=!0)}if(!h&&c){i.getQueryParameter("loadSPFX")||console.log("WARNING! SPFX is required to be loaded. Add 'loadSPFX=true' query parameter")}return c||h};t.dependencies=Object(r.__assign)(Object(r.__assign)({},s.e.dependencies),{itemsStore:g.t,pageContext:S.h,listContext:S.o,apiUrlHelper:ye.e,itemUrlHelper:W.n,itemParentHelper:be.e,urlDataSource:E.me,microServiceDataSource:p.e,microServiceDataSourceStore:d.e,listDataSource:de.resourceKey,listItemBuilder:I.e,listItemResultProcessor:q.e,subsiteItemResultProcessor:R.e,rumOneHelper:x.e,identity:E.S.optional,spotlightDataSource:E.fe.optional,onePageContext:S.c.optional,contentTypes:S.n.optional});return t})(s.e);t.default=Le;function Ae(e){return!!e.ListData}var Oe=Object(T.s)("ListItemsDataSource",Le)},"3654":function(e,t,n){"use strict";var r=n(1738);n.d(t,"e",function(){return r})}}]);