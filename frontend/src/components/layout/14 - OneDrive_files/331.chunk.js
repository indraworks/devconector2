(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["331"],{"1303":function(e,t,n){"use strict";n.r(t);var r=n(0),i=(n(1475),n(1440)),s=n(1496),o=n(1482),u=n(1463),a=n(109),f=n(787),l=n(325),c=n(1616),h=n(1457),p=n(1493),d=n(1461),v=n(1536),m=n(1600);function g(e,t){for(var n=t.start,r=Math.min(t.end,e.length),i=n;i<r;i++)if(!e[i])return!1;return!0}var y,b=n(1042),w=n(18),E=n(1477),S=n(380),x=n(1595),T=n("knockout-lib"),N=n(786),C=(function(){function e(e,t,n,r){this._context=e;this._store=t;this._isTokenBaseApi=n;this._tokenBasedExtraItemCount=r}e.prototype.initialize=function(e,t){this._skipDataFetch=!1;if(!this._context.group&&this._context.noIndexBasedDataFetch){var n=e&&e.content.peek().groupings,r=n&&n.length&&n[0].itemGroups;this._context.group=this._getGroupStartingOnIndex(t,r)}e&&e.isExpired&&(this._context.group=null);this._isExpandingGroup=this._context.noIndexBasedDataFetch&&this._context.group&&"__next__"!==this._context.group.groupingId&&!this._context.groupReplace;this._isFetchingNextGroup=this._context.group&&this._isTokenBaseApi&&"__next__"===this._context.group.groupingId;var i=e&&e.content.peek().groupings;this._isAllCollapsedQuery=i&&i.length>0&&i[0].isAllCollapsed&&i[0].isAllCollapsed.peek()&&!this._isExpandingGroup};e.prototype.isResultSetValid=function(e,t){var n=this._skipDataFetch;n||(n=this._isAllCollapsedQuery?!this._isExpandingGroup&&!this._context.requestToken:(this._isTokenBaseApi||!this._context.skipInMemoryCache)&&g(e,t)&&!(this._isFetchingNextGroup&&this._context.endIndex>e.length));return n};e.prototype.computeNewChildren=function(e,t,n,r,i){var s,o=!1;this._context.groupReplace&&(this._isFetchingNextGroup=!!e.nextRequestToken);s=i&&!n.isExpired?n.content.peek().items:[];if(e.nextRequestToken){!t.requestToken&&s.length>e.totalChildren&&(s[e.totalChildren]=null);e.totalChildren+=this._tokenBasedExtraItemCount;this._store.setNextRequestToken(t.parentKey,r,e.nextRequestToken);o=!0;n&&(n.isTokenBasedApi=o)}else this._store.setNextRequestToken(t.parentKey,r,"end");if(t.requestToken){t.startIndex=s.length-this._tokenBasedExtraItemCount;e.totalChildren+=s.length-this._tokenBasedExtraItemCount}if(this._isFetchingNextGroup||this._isAllCollapsedQuery){var u=e.children.length,a=e.startIndex+u;e.nextRequestToken&&(a+=this._tokenBasedExtraItemCount);e.totalChildren=Math.max(e.totalChildren,Math.max(s.length,a))}if(e.item&&e.totalChildren>=0){this._isExpandingGroup||(s.length>0&&0===e.totalChildren?s=[]:s.length=e.totalChildren);var f=void 0;f=t.groupReplace?t.startIndex:void 0!==e.startIndex?e.startIndex:this._isExpandingGroup?t.group.startIndex:t.startIndex;for(var l=0,c=0;l<s.length;l++)if(l>=f&&c<e.children.length){s[l]=this._store.getItem(e.children[c].key);if(Object(N.isFeatureEnabled)(N.SupportMountPointInMoveCopyPanel)){(s[l].peek().remoteItem||t.remoteItem)&&(s[l].peek().isMountPointFolder=!0);t.isMountPointFolder&&(s[l].peek().remoteWebUrl=t.remoteItem.SiteUrl)}c++}}return{allChildren:s,hasNextRequestToken:o}};e.prototype.computeNewGroupings=function(e,t,n,r,i){var s=this._isExpandingGroup?r.group:null,o=r.itemsPerGroup,u=e&&e.length>0?e[0].itemGroups:null,a=null;u&&u.length>0&&u[u.length-1].isPlaceholder&&(a=u.pop());var f=this._mergeGroupings(e,t,i,n);if(s&&f){f[0].isAllCollapsed(!1);s.state({isCollapsed:!1})}if(n&&n.length>0&&!n[n.length-1]&&(u=f&&f.length>0?f[0].itemGroups:null)&&u.length>0){var l=u[u.length-1];this._context.groupReplace&&this._isFetchingNextGroup&&(l.hasMoreData=!0);var c=n[l.startIndex+(-1!==o?Math.min(l.count,o):l.count)-1]&&!(this._context.groupReplace&&l.count<o),h=f[0].isAllCollapsed.peek();if(c||this._isFetchingNextGroup||h){var p=l.startIndex+l.count;a?a.startIndex=p:a={groupingId:"__next__",startIndex:p,count:1,isPlaceholder:!0,state:T.observable({isCollapsed:!1})};n.length<p&&(n.length=p+1);u.push(a)}}return f};e.prototype._mergeGroupings=function(e,t,n,r){var i=e;if(i&&i.length>0){if(t&&t.length>0)for(var s=0;s<t.length;s++){var o=i[s].isAllCollapsed.peek();i[s].itemGroups=n?this._retainItemGroupState(i[s].itemGroups,t[s].itemGroups):this._mergeItemGroups(i[s].itemGroups,t[s].itemGroups,o,null,r)}}else i=t;return i};e.prototype._mergeItemGroups=function(e,t,n,r,i){var s=e;if(e&&e.length>0){if(t&&t.length>0)for(var o=function(e){var t=!1;n&&e.state({isCollapsed:!0});for(var o=function(i){var o=s[i];if(e.groupingId===o.groupingId){if(u._context.noIndexBasedDataFetch||!u._context.isTokenBasedApi){if(u._context.groupReplace){o.count+=e.count;o.hasMoreData&&i<s.length-1&&(o.hasMoreData=!1)}else o.count=e.count;o.children=u._mergeItemGroups(o.children,e.children,n,o);if(0===i)o.startIndex=r?r.startIndex:0;else{var a=s[i-1],f=a.startIndex+a.count-o.startIndex;o.startIndex+=f;o.children&&o.children.forEach(function(e){e.startIndex+=f})}}else{var l=e.startIndex+u._context.startIndex,c=e.startIndex+u._context.startIndex+e.count;o.startIndex=Math.min(o.startIndex,l);o.count=Math.max(c,o.startIndex+o.count)-o.startIndex}t=!0;return"break"}},a=0;a<s.length;a++){if("break"===o(a))break}if(!t){var f=s[s.length-1],l=f.startIndex+f.count-e.startIndex;e.startIndex+=l;e.children&&e.children.forEach(function(e){e.startIndex+=l});var c=Math.min(e.count,30),h=0;if(i)for(var p=e.startIndex;p<e.startIndex+c;p++)i[p]||h++;h&&(e.emptyItemCount=h);s.push(e)}},u=this,a=0,f=t;a<f.length;a++){o(f[a])}}else s=t;return s};e.prototype._retainItemGroupState=function(e,t,n){var r=t;if(t&&t.length>0&&e&&e.length>0){for(var i={},s=0,o=e;s<o.length;s++){var u=o[s];i[u.groupingId]=u}for(var a=0,f=r;a<f.length;a++){var l=f[a],c=i[l.groupingId];if(c){l.state(c.state.peek());l.children=this._retainItemGroupState(c.children,l.children,c)}}}return r};e.prototype._getGroupStartingOnIndex=function(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var r=t[n];if(!(r&&r.startIndex<=e))break;var i=r.startIndex+r.count-1;if(r.children){if(i>=e)return this._getGroupStartingOnIndex(e,r.children)}else{if(r.startIndex===e)return r.state.peek().isCollapsed?null:r;if(i>=e){var s=n<t.length-1?t[n+1]:null;if(s&&!s.state.peek().isCollapsed){this._skipDataFetch=!0;return null}}}}return null};return e})(),k=n(10),L=n(4),A=n(1518);(function(){try{"serviceWorker"in navigator&&navigator.serviceWorker.getRegistration().then(function(e){e&&e.navigationPreload.getState().then(function(e){y=e.enabled})})}catch(e){}})();var O=(function(){function e(){this._isOneDriveWinApp=-1!==navigator.userAgent.indexOf("OneDriveWinApp")}e.prototype.isServiceWorkerActive=function(){var e="serviceWorker"in navigator&&!!navigator.serviceWorker.controller&&"activated"===navigator.serviceWorker.controller.state;this.isServiceWorkerActive=function(){return e};return e};e.prototype.getServiceWorkerInfo=function(){return{isServiceWorkerRegistered:localStorage&&!!localStorage.getItem("isServiceWorkerRegisteredKey")||!1,isServiceWorkerFlightEnabled:this._isOneDriveWinApp?!Object(L.sr)(L.M):Object(L.sr)(L.re),isSWExperimentationFlightEnabled:Object(L.sr)(L.ie),isServiceWorkerExperimentOn:!!Object(L.sr)(L.ie)&&this._isOdbServiceWorkerExperimentOn(),isDocLibServiceWorkerFlightEnabled:Object(L.sr)(L.$),isDocLibSWExperimentationFlightEnabled:!1,isDocLibServiceWorkerExperimentOn:!1,isNavigationPreloadEnabled:y||void 0,swNavigationInfo:this.getSWNavigationInfo()||void 0}};e.prototype.getServiceWorkerStatus=function(){var e="unknown";try{e="serviceWorker"in navigator?navigator.serviceWorker.controller?navigator.serviceWorker.controller.state:"unavailable":"unsupported"}catch(e){console.error(e)}return e};e.prototype.invalidateFileMetadataCache=function(){this._invalidateCache("FileMetadata")};e.prototype._invalidateCache=function(e){var t=navigator.serviceWorker.controller;t&&t.postMessage(JSON.stringify({operation:"invalidate",cacheName:e}))};e.prototype._isOdbServiceWorkerExperimentOn=function(){this._odbServiceWorkerExperiment||(this._odbServiceWorkerExperiment=new A.ABExperiment({name:"ODBServiceWorkerExperimentV2",startDate:"7/01/2019",targetType:A.TargetType.user,version:A.ABExpHash.v2}));return this._odbServiceWorkerExperiment.IsExperimentOn()};e.prototype.getSWNavigationInfo=function(){var e=performance&&performance.getEntriesByType("navigation");if(e&&e.length>0){var t=e[0];return{workerStart:t.workerStart,fetchStart:t.fetchStart,requestStart:t.requestStart}}};return e})(),M=new k.t({name:"ServiceWorkerAgent",factory:new w.i(O)});n.d(t,"resourceKey",function(){return D});var _=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._registeredProjections={};r._pendingGetItemRequests={};r._store=n.itemsStore;r._operationProvider=n.operationProvider;r._schemaDataSource=n.schemaDataSource;r._updateQuota=n.updateQuota;r._groupThrottle=n.groupThrottle;r._smartFiltersStore=n.smartFiltersStore;r._serviceWorkerAgent=n.serviceWorkerAgent;return r}t.prototype.getItem=function(e){return this._getItem(e)};t.prototype.getItemSetKey=function(e,t){var n="";n+="parentKey="+e.parentKey;function r(e,t){t&&(n+="&"+e+"="+t)}r("ownerId",e.ownerId);r("groupingType",e.groupingType);n+="&sortField="+(e.sortField||"");n+="&isAscending="+("boolean"==typeof e.isAscending?e.isAscending:"");var i=e.filters;if(i)for(var s in i)n+="&"+s+"="+i[s];r("groupBy",e.groupBy);r("viewId",e.baseViewId);r("viewXml",e.viewXml);r("additionalFiltersXml",e.additionalFiltersXml);var o=!t&&e.itemSetProjections;if(o){var u="";for(var a in o)u+=a+"_"+o[a];n+="&projection="+u}e.supportsNestedGroups&&(n+="&ng=1");return n};t.prototype.getSpecifiedItems=function(e){e&&e.needToClearParentSmartFiltersInfo&&e.parentKey&&this._smartFiltersStore&&this._smartFiltersStore.invalidate(e.parentKey);return this._getItemDataSource().then(function(t){return t.getSpecifiedItems(e)})};t.prototype.getItemSync=function(e){var t=this.getItemSetKey(e),n=e.parentKey,r=this._store.getItem(n),i=this._getItemSet(t,e);if(!r){var s=new o.e(n),u=e.queryType,a=void 0===u?s.queryType:u;s.queryType=a;this._store.setItem(s);r=this._store.getItem(n)}if(!i){var f=r.peek(),l=f&&f.folder,c=l&&l.childCount||0;(i=new m.e(t,e,c)).item=r;var h=e.needSchema;if(void 0===h||h){var p=this._schemaDataSource,d=p&&p.getColumns(f);d&&d.length>0&&i.schema(d)}this._store.setItemSet(t,i)}return i};t.prototype.invalidateItem=function(e,t){var n=void 0===t?{}:t,i=n.triggerFetch,s=void 0!==i&&i,o=n.emptyAllOtherSets,u=void 0!==o&&o,a=n.refreshSchema,f=void 0!==a&&a,l=n.updateGrouping,c=void 0!==l&&l,h=n.purgeCache,p=void 0!==h&&h;u&&this._store.emptyAllOtherSets([e]);if(f){(v=this._store.getItemSetFromItemKey(e))&&v.schema([])}c||this._store.invalidateItem(e,{purgeCache:p});this._smartFiltersStore&&this._smartFiltersStore.invalidate(e);var d=this._serviceWorkerAgent;d&&d.isServiceWorkerActive()&&d.invalidateFileMetadataCache();if(s){var v=this._store.getItemSetFromItemKey(e);this._getItem(Object(r.__assign)(Object(r.__assign)({parentKey:e},v&&v.context||{}),{skipCache:!0,updateGrouping:c}))}};t.prototype.removeFromRecent=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromRecent(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.removeMountPoint=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeMountPoint(e)}).then(function(n){n&&t.invalidateItem(e.parentKey);return n})};t.prototype.createMountPoint=function(e){return this._getItemDataSource().then(function(t){return t.createMountPoint(e)}).then(function(e){return e},function(e){return a.n.wrapError(e)})};t.prototype.createDocument=function(e,t,n,r,i){var s=this;return this._getItemDataSource().then(function(o){return o.createDocument(e,t,n,r).then(function(t){if(i&&o.updateContentType){var n=t.match(/{(.*)}/),r=n&&n[1];return r?o.updateContentType(e,r,i).then(function(){s.invalidateItem(e);s._updateQuota(!0);return t}):t}s.invalidateItem(e);s._updateQuota(!0);return t})})};t.prototype.createCustomDocument=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.createCustomDocument(e,t,n)}).then(function(t){if(!t)return a.n.wrapError();r.invalidateItem(e);r._updateQuota(!0);return r.getItem({parentKey:e}).then(function(e){return r.peekUnwrapObservable(r._store.getItem(t))})})};t.prototype.updateBundle=function(e,t){var n=this,r=[new E.e(e.item.key,e.item)];t.update(r);return this._getItemDataSource().then(function(t){return t.updateBundle(e)}).then(function(){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);r=r.map(function(e){return e.succeed()});t.update(r)},function(i){n.invalidateItem(e.item.parent?e.item.parent.key:e.item.key);var s=new Error(i);r=r.map(function(e){return e.fail(s)});t.update(r);return a.n.wrapError(s)})};t.prototype.removeFromSharedList=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.removeFromSharedList(e)}).then(function(n){t.invalidateItem(e.parentKey);return n})};t.prototype.updateViewCount=function(e){return this._getItemDataSource().then(function(t){return t.updateViewCount(e)})};t.prototype.reportAbuse=function(e){var t=new p.e,n=this._operationProvider.register({name:e.item.name||"",type:d.e.reportAbuse,payloads:{reportAbuse:{item:e.item}},iconName:e.item.iconName,batch:t}),r=this._getItemDataSource().then(function(t){return t.reportAbuse(e)});n.state(h.e.started);n.progress.maximum(1);return r.then(function(e){n.state(h.e.completed);n.progress.current(1);return e},function(e){n.state(h.e.failed);n.error(new v.e({message:e}));return a.n.wrapError(e)})};t.prototype.requestReview=function(e){for(var t=this,n=new p.e,r=e.items.map(function(e){var r=t._operationProvider.register({name:e.name||"",type:d.e.requestReview,payloads:{requestReview:{item:e}},iconName:e.iconName,batch:n});r.progress.maximum(1);r.progress.current(0);return r}),i=this._getItemDataSource().then(function(t){return t.requestReview(e)}),s=0,o=r;s<o.length;s++){o[s].state(h.e.started)}return i.then(function(n){for(var i=0,s=r;i<s.length;i++){var o=s[i];o.progress.current(1);o.state(h.e.completed)}var u=e.items[0].parent;u&&t.invalidateItem(u.key);return n},function(e){for(var t=0,n=r;t<n.length;t++){var i=n[t];i.error(new v.e({message:e}));i.state(h.e.failed)}return a.n.wrapError(e)})};t.prototype.saveSortOrder=function(e){return this._getItemDataSource().then(function(t){return t.saveSortOrder(e)}).then(function(e){return e},function(e){})};t.prototype.addCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.addCoverPhotos,this._addCoverPhotos)};t.prototype.removeCoverPhotos=function(e){return this._updateCoverPhotos(e,d.e.removeCoverPhotos,this._removeCoverPhotos)};t.prototype.changeFolderType=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.changeFolderType(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.updateItemProperty=function(e){var t=this;return this._getItemDataSource().then(function(t){return t.updateItemProperty(e)}).then(function(n){t.invalidateItem(e.item.key,{triggerFetch:!0});return n})};t.prototype.getOpenInClientDetails=function(e){return this._getItemDataSource().then(function(t){return t.getOpenInClientDetails(e)}).then(function(e){return e},function(e){})};t.prototype.getWorkProgress=function(e){return this._getItemDataSource().then(function(t){return t.getWorkProgress(e)})};t.prototype.processReferral=function(e,t){return this._getItemDataSource().then(function(n){return n.processReferral(e,t)})};t.prototype.getItemOcrTextContent=function(e){return this._getItemDataSource().then(function(t){return t.getItemOcrTextContent(e)})};t.prototype.updateItemOcrInfo=function(e,t,n){var r=this;return this._getItemDataSource().then(function(r){return r.updateItemOcrInfo(e,t,n)}).then(function(t){r.invalidateItem(e.key,{triggerFetch:!0});return t},function(e){return e})};t.prototype.rotateItems=function(e,t){var n=this,r={},i=e.items.map(function(e){return r[e.key]=new E.e(e.key,e)});t.update(i);return this._getItemDataSource().then(function(t){return t.rotateItems(e)}).then(function(){i=i.map(function(e){return e.succeed()});t.update(i)},function(e){var s=e.data||[];i=[];for(var o=0,u=s;o<u.length;o++){var a=u[o],f=r[a.key];n._store.setItem(f.input);delete r[a.key];i.push(f.fail(a.error))}for(var l in r){f=r[l];delete r[l];i.push(f.succeed())}t.update(i)})};t.prototype.registerProjection=function(e,t){this._registeredProjections[e]=t};t.prototype.computeProjectedItemSet=function(e,t,n,r){var i=n.itemSetProjections,s=r?null:this._store.getItemSet(e),o=!s||s.isPlaceholder||s.isExpired||s.version!==t.version;if(!s||o){if(!s){(s=new m.e(e,n)).item=t.item;s.isTokenBasedApi=t.isTokenBasedApi;s.isPlaceholder=t.isPlaceholder;s.isExpired=t.isExpired;s.version=t.version}for(var u in i){var a=this._registeredProjections[u];a&&a.projectItemSet(s,t,i[u])}r||this._store.setItemSet(e,s)}return s};t.prototype.redeemPermissionToken=function(e){return this._getItemDataSource().then(function(t){return t.redeemPermissionToken(e)})};t.prototype._getItem=function(e){var n,i=this,s=b.e(e),o=this._store;if(e.keyAlias){n=this.getItemSync({parentKey:e.keyAlias}).item;e.parentKey=n.peek().key}else n=this.getItemSync(e).item;var u=e.skipCache,f=void 0!==u&&u,c=this.getItemSetKey(e),h=e.itemSetProjections?this.getItemSetKey(e,!0):c,p=this._getItemSet(c,e),d=p&&p.content.peek().items,v=e.isTokenBasedApi||!!p&&!!p.isTokenBasedApi,y=!f&&n&&!n.peek().revision&&p&&!p.isExpired&&!p.isPlaceholder&&(!e.requestAllChildren||g(d,{start:0,end:d.length})),w=e.startIndex,E=void 0===w?0:w,x=e.pageSize,T=void 0===x?100:x,N=e.endIndex||E+T;N=d&&d.length>0&&!v?Math.min(d.length,N):N;E=Math.max(0,Math.min(N,E));var k=o.getNextRequestToken(h);e.requestToken="end"===k?"":k;var L=new C(e,o,v,t.TOKEN_BASED_API_EXTRA_ITEMS);L.initialize(p,E);var A=!1,O=p&&p.content.peek();if(O&&(1===O.partialResultStatus||2===O.partialResultStatus)){A=!0;1===O.partialResultStatus&&p.content({items:O.items,groupings:O.groupings,partialResultRequestCount:0,partialResultStatus:2})}if(y&&!A&&L.isResultSetValid(d,{start:E,end:N}))return a.n.wrap(p);if(n&&n.peek().isStub){var M=e.startKey;if(M){if(o.getItem(M)){p.content.peek().items=[o.getItem(M)];p.isPlaceholder=!0;p.isExpired=!1;var _=this._schemaDataSource,D=_&&_.getColumns(n.peek());D&&D.length>0&&p.schema(D);p.content.valueHasMutated&&p.content.valueHasMutated()}}return a.n.wrap(p)}var P=p&&!p.isExpired&&p.content.peek().groupings;P&&P.length>0&&(e.isGrouped=!0);this._normalizeContext(e,d,E,N,!y);var H=this._getRequestKey(e),B=this._pendingGetItemRequests[H];if(B)return e.itemSetProjections?B.getPromise().then(function(t){return i.computeProjectedItemSet(c,t,e)}):B.getPromise();v&&!k&&(e.startIndex=0);this._pendingGetItemRequests[H]=B=new S.e;this.resources.consumeAsync(l.y.bypass).then(function(t){return t.getItem(Object(r.__assign)(Object(r.__assign)({},e),{itemSetKey:c}))}).then(function(t){if(s.updateContextBasedOnResult&&e.updateContextBasedOnResult){s.updateContextBasedOnResult(s,t);e.updateContextBasedOnResult(e,t);c=i.getItemSetKey(s)}var r=e.itemSetProjections?i.getItemSetKey(e,!0):c;n=o.getItem(e.parentKey);var u=o.getItemSet(r);y=!(!n||!u);var a=L.computeNewChildren(t,e,u,r,!!y),f=a.allChildren,l=a.hasNextRequestToken;l&&(v=l);if(t.item&&!e.ignoreChildren&&!e.skipStoreResults){if(!y){(u=new m.e(r,e)).item=o.getItem(e.parentKey);u.isTokenBasedApi=v;o.setItemSet(r,u)}var h=!!u.isExpired;u.sortField=t.sortField;u.isAscending=t.isAscending;u.isPlaceholder=!1;u.isExpired=!1;var p=e.needSchema;if(void 0===p||p){var d=t.schema;u.schema(d&&d.length>0&&d||[]);t.customViewRenderer?u.customViewRenderer=i.observables.create(t.customViewRenderer):u.customViewRenderer=i.observables.create(void 0)}var w=t.groupings;v&&e.mergeGroupings&&(w=L.computeNewGroupings(u.content.peek().groupings,t.groupings,f,e,h));t.contentTypes&&u.contentTypes&&u.contentTypes(t.contentTypes);var E=u.content.peek(),S=E.partialResultStatus,x=E.partialResultRequestCount,T=void 0===x?0:x;if(!(w&&w.length&&!!w[0])){if(l&&(t.children&&t.children.length<30||!t.children)){var N=T+1;N<=5?T=N:S=1}else void 0===S||0===S||l?2===S&&t.children&&30===t.children.length&&(S=0):S=3}u.content({items:f,groupings:w,partialResultRequestCount:T,partialResultStatus:S});var C=u.version,k=void 0===C?0:C;u.version=k+1}delete i._pendingGetItemRequests[H];if(e.requestAllChildren&&!g(f,{start:0,end:t.totalChildren})){var A=b.e(e),O=A.startIndex,M=void 0===O?0:O;A.startIndex=M+100;return i._getItem(A)}if(t.isFromBrowserCache){s.skipCache=!0;return i._getItem(s)}e.itemSetProjections&&(u=i.computeProjectedItemSet(c,u,e));return u},function(e){delete i._pendingGetItemRequests[H];return a.n.wrapError(e)}).then(function(e){B.complete(e)},function(t){i._groupThrottle&&!i._groupThrottle()&&t&&t.errorCode===Number(-2147024860)&&!e.noGroupReplace?i._groupThrottle(!0):B.error(t)});return B.getPromise()};t.prototype._normalizeContext=function(e,t,n,r,i){var s=e.pageSize||100;if(!e.avoidSeamSnapping){if(!i&&!(n-n%s==r-r%s)&&t)for(;n<r&&t[n];)n++;e.startIndex=n-n%s}"number"!=typeof e.pageSize&&(e.pageSize=100);for(var o=e.startIndex,u=void 0===o?0:o;r-u>e.pageSize;)e.pageSize+=100};t.prototype._getRequestKey=function(e){var t=this.getItemSetKey(e,!0);e.requestToken?t+=e.requestToken:t+="&startIndex="+e.startIndex;return t+="&pageSize="+e.pageSize};t.prototype._getItemSet=function(e,t){var n=this._store,r=n.getItemSet(e);if(t.itemSetProjections){var i=this.getItemSetKey(t,!0),s=n.getItemSet(i);s&&(r=this.computeProjectedItemSet(e,s,t))}return r};t.prototype._updateCoverPhotos=function(e,t,n){for(var r=this,i=new p.e,s=e.target,o=e.items.map(function(e){var n=r._operationProvider.register({name:e.name||"",type:t,payloads:{coverPhotos:{parent:s,item:e}},iconName:e.iconName,batch:i});n.progress.maximum(1);n.progress.current(0);return n}),u=n.call(this,e),a=0,f=o;a<f.length;a++){f[a].state(h.e.started)}return u.then(function(e){r.invalidateItem(s.key);for(var t=0,n=o;t<n.length;t++){var i=n[t];i.progress.current(1);i.state(h.e.completed)}return e},function(){for(var e=0,t=o;e<t.length;e++){t[e].state(h.e.failed)}})};t.prototype._addCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.addCoverPhotos(e)})};t.prototype._removeCoverPhotos=function(e){return this._getItemDataSource().then(function(t){return t.removeCoverPhotos(e)})};t.prototype._getItemDataSource=function(){return this.resources.consumeAsync(l.B)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{groupThrottle:f.g.optional,schemaDataSource:l.ee.optional,itemsStore:u.t,operationProvider:s.e,smartFiltersStore:c.e.optional,updateQuota:x.e,serviceWorkerAgent:M.optional});t.TOKEN_BASED_API_EXTRA_ITEMS=2;return t})(i.n),D=(t.default=_,Object(w.s)("ItemProvider",_))},"1304":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(78),s=n(276),o=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;r._pageContext=n.pageContext;r._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl;r._itemUrlHelper=n.itemUrlHelper;return r}t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,r=e.fullItemUrl,s=this;(n||t===i.r.crossSite)&&(s=s.method("SP.RemoteWeb",r));return s.segment("web")};t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)};t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})};return t})(s.e),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,s=n.itemUrlHelper,u=n.pageContext,a=n.encodeWebAbsoluteUrl,f=n.apiUrlType,l=void 0===f?(function(e){Object(r.__extends)(t,e);function t(){return e.call(this,{},{itemUrlHelper:s,pageContext:u,encodeWebAbsoluteUrl:a})||this}return t})(o):f;i._apiUrlType=l;return i}t.prototype.build=function(){return new this._apiUrlType};return t})(s.t)},"1440":function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"i",function(){return h});n.d(t,"r",function(){return p});n.d(t,"e",function(){return v});var r=n(0),i=n(10),s=n(18),o=n(148),u=n(210),a=n(1466),f=n(561),l="@ms/odsp-shared/lib/base/BaseModel",c=new i.t({name:l+".asyncType",factory:new i.e(u.default)}),h=new i.t({name:l+".observablesFactoryType",factory:new s.r(a.e,{asyncType:c.optional})}),p=new i.t({name:l+".eventGroupType",factory:new i.e(o.default)}),d=new i.t({name:l+".errorHandler"}),v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.id,s=void 0===i?"":i;r.id=s;r._BaseModel_dependencies=n;return r}Object.defineProperty(t.prototype,"async",{get:function(){return this._BaseModel_getAsync()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"events",{get:function(){return this._BaseModel_getEvents()},enumerable:!0,configurable:!0});Object.defineProperty(t.prototype,"observables",{get:function(){return this._BaseModel_getObservables()},enumerable:!0,configurable:!0});t.prototype.subscribe=function(e,t,n){return this.observables.subscribe(e,t,{isBeforeChange:n})};t.prototype.createComputed=function(e,t){return this.observables.compute(e,t)};t.prototype.createPureComputed=function(e,t){return this.observables.pureCompute(e,t)};t.prototype.createBackgroundComputed=function(e,t){return this.observables.backgroundCompute(e,t)};t.prototype.addDisposable=function(e){return this.scope.attach(e)};t.prototype.trackPromise=function(e){var t=!1,n=this.scope.attach({dispose:function(){!t&&e.cancel&&e.cancel()}}),r=function(){t=!0;n.dispose()};e.done(r,r);return e};t.prototype.wrapObservable=function(e){return this.observables.wrap(e)};t.prototype.peekUnwrapObservable=function(e){return Object(a.r)(e)};t.prototype.createObservable=function(e){return this.observables.create(e)};t.prototype.unwrapObservable=function(e){return Object(a.i)(e)};t.prototype.isObservable=function(e){return Object(a.n)(e)};t.prototype._BaseModel_getAsync=function(){var e=new(this.scope.attached(this._BaseModel_getAsyncType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getAsync=function(){return e};return e};t.prototype._BaseModel_getEvents=function(){var e=new(this.scope.attached(this._BaseModel_getEventGroupType()))(this,this._BaseModel_getErrorHandler());this._BaseModel_getEvents=function(){return e};return e};t.prototype._BaseModel_getObservables=function(){var e=new(this.scope.attached(this._BaseModel_getObservablesFactoryType()))({owner:this});this._BaseModel_getObservables=function(){return e};return e};t.prototype._BaseModel_getAsyncType=function(){return this._BaseModel_dependencies.asyncType||this.resources&&this.resources.consume(c.optional)||u.default};t.prototype._BaseModel_getEventGroupType=function(){return this._BaseModel_dependencies.eventGroupType||this.resources&&this.resources.consume(p.optional)||o.default};t.prototype._BaseModel_getObservablesFactoryType=function(){return this._BaseModel_dependencies.observablesFactoryType||this.resources&&(this.resources.consume(h.optional)||Object(i.s)(a.e,{asyncType:this._BaseModel_getAsyncType()}))||a.e};t.prototype._BaseModel_getErrorHandler=function(){return this._BaseModel_dependencies.errorHandler||this.resources&&this.resources.consume(d.optional)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},f.e.dependencies),{asyncType:c.optional,observablesFactoryType:h.optional,eventGroupType:p.optional,errorHandler:d.optional});return t})(f.e);t.n=v},"1441":function(e,t,n){"use strict";var r=n(0),i=n(1440),s=n(23),o=n(1514),u=n("knockout-lib");var a={init:function(e,t,n,r,i){u.applyBindingsToNode(e,{attr:{"data-automationType":t()}},i);if(i){var s=i.$component;if(s){var o=u.utils.unwrapObservable(t());if(o){var a=s.__automationTypeBinding$elements;a||(a=s.__automationTypeBinding$elements={});var f=a[o];f||(f=a[o]=[]);f.push(e);u.utils.domNodeDisposal.addDisposeCallback(e,function(){var t=f.indexOf(e);if(-1!==t){delete f[t];f.splice(t,1)}})}}}}},f=n(1442),l=n(13),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.element.getAttribute("class");n.element.setAttribute("class",n._expandIconClassNames(r));return n}t.prototype._expandIconClassNames=function(e){var t={};if(e&&e.indexOf("ms-Icon--")>=0){for(var n=e.split(" "),r=[],i=0,s=n;i<s.length;i++){var o=s[i];this._lastClassesAdded&&this._lastClassesAdded[o]||r.push(o);if(0===o.indexOf("ms-Icon--")){var u=o.substring(9),a=Object(l.C)(u);if(a&&-1===n.indexOf(a)){t[a]=!0;r.push(a)}}}this._lastClassesAdded=t;return r.join(" ")}return e};t.after=["css","class"];return t})(f.e),h=n(114);n.d(t,"e",function(){return p});var p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.bindingHandlers={};r.automationId=t&&t.automationId||void 0;r.addBindingHandlers({automation:o.e,automationType:a,icon:c});return r}t.prototype.getAutomationElement=function(e){return Object(o.t)(this,e)};t.prototype.format=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return Object(s.format)(e,t)};t.prototype.addBindingHandlers=function(e){Object(h.e)(this.bindingHandlers,e)};return t})(i.n);t.t=p},"1442":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1440),s=n("knockout-lib"),o=n(1494),u=n(10),a=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.element=t.element;r.valueAccessor=t.valueAccessor;r.allBindingsAccessor=t.allBindingsAccessor;r.bindingContext=t.bindingContext;r.controlsDescendantBindings=!1;return r}t.init=function(e,t,n,r,i){var a=new u.n(o.e(i)),f=new(this.supportsDependencies?a.resolved(this):a.injected(this))({element:e,allBindingsAccessor:n,valueAccessor:t,bindingContext:i});s.utils.domNodeDisposal.addDisposeCallback(e,function(){return f.dispose()});return{controlsDescendantBindings:f.controlsDescendantBindings}};t.dependencies=Object(r.__assign)({},i.n.dependencies);t.supportsVirtualElements=!1;t.supportsDependencies=!1;return t})(i.n);t.t=a},"1443":function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n("knockout-lib"),i=n(890);function s(e){var t=e.tagName,n=e.template,i=e.viewModel,s=e.synchronous,o=void 0!==s&&s;r.components.register(t,{viewModel:i,template:n,synchronous:o});return e}function o(e,t){var n=document.createElement("script");n.setAttribute("type","text/html");n.id=e;i.e.setText(n,t);document.head.appendChild(n)}},"1445":function(e,t,n){"use strict";var r=n(0),i=(n(1644),n(1442)),s=n(10),o=n(1483),u=n(109),a=n(1531),f=n(255),l=n(90),c=n("knockout-lib");function h(e,t){return{definitionKey:e,params:t}}n.d(t,"t",function(){return d});n.d(t,"e",function(){return v});n.d(t,"r",function(){return h});var p=(function(){function e(e){var t=e.viewModelType;this.dependencies=Object(r.__assign)(Object(r.__assign)({},t.dependencies||{}),e.dependencies||{});this._automationName=e.automationName;this._viewModelType=e.viewModelType;this._template=e.template}e.prototype.create=function(e){var t=this,n=e.resources,i=(function(t){Object(r.__extends)(i,t);function i(i){return t.call(this,i,Object(r.__assign)(Object(r.__assign)({},e||{}),{resources:new s.n(n)}))||this}return i})(this._viewModelType),o=function(){return t._getTemplateNodes()},u=this._automationName;return{instance:new((function(){function e(){}e.prototype.toSpecification=function(e){return{automationName:u,viewModelType:i,getTemplateNodes:o,params:e}};return e})())}};e.prototype._getTemplateNodes=function(){var e=c.utils.parseHtmlFragment(this._template);this._getTemplateNodes=function(){return e};return e};return e})();function d(e){return new s.t({name:e.name,factory:new p({template:e.template,automationName:e.automationName,viewModelType:e.viewModelType,dependencies:e.dependencies})})}var v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.controlsDescendantBindings=!0;var i=r.element;r._transcludedTemplateNodes=Array.prototype.slice.call(c.virtualElements.childNodes(i));c.virtualElements.emptyNode(i);r._resolvedSpecification=r._getResolvedSpecification();r._initializeRenderComponent();return r}t.prototype._getResolvedSpecification=function(){var e=this,t=this.resources,n=this.observables,i=n.create();i.equalityComparer=m;var s=new o.e;n.compute(function(){var o,a,f,c=e.valueAccessor();if(g(c)){o=n.unwrap(c.specification);a=c.placeholder;f=c.error}else o=n.unwrap(c);e.observables.ignore(function(){var n;if(o)if(y(o)){var c=o.params,h=o.definitionKey.local,p=t.consume(h.optional);if(p)i(p.toSpecification(c));else{if(a)if(y(a)){var d=t.consume(a.definitionKey.optional.local);d&&i(Object(r.__assign)(Object(r.__assign)({},d.toSpecification(a.params)),{isPlaceholder:!0}))}else i(Object(r.__assign)(Object(r.__assign)({},a),{isPlaceholder:!0}));n=t.consumeAsync(h).then(function(e){return e.toSpecification(c)})}}else i(o);else i(void 0);s.debounce(n?e.trackPromise(n.then(function(e){i(e)},function(e){if(!u.n.isCanceled(e)){l.default.log(e);if(f)if(y(f)){var n=t.consume(f.definitionKey.optional.local);n&&i(Object(r.__assign)(Object(r.__assign)({},n.toSpecification(Object(r.__assign)(Object(r.__assign)({},f.params),{error:e}))),{isError:!0}))}else i(Object(r.__assign)(Object(r.__assign)({},f),{params:Object(r.__assign)(Object(r.__assign)({},f.params),{error:e}),isError:!0}))}})):u.n.wrap())})});return i};t.prototype._initializeRenderComponent=function(){var e,t=this,n=this.element,r=this.observables,i=this._transcludedTemplateNodes;r.compute(function(){var r=t._resolvedSpecification();t.observables.ignore(function(){if(e){e.dispose();c.virtualElements.emptyNode(n)}if(r){var s=r.getTemplateNodes().map(function(e){return e.cloneNode(!0)}),o=(e=t.scope.attach(new f.e)).attach(new r.viewModelType(r.params));e.attach(new a.e({viewModel:o,element:n,bindingContext:t.bindingContext,name:r.automationName}));for(var u=t.bindingContext.createChildContext(o,void 0,function(e){e.$component=o;e.$componentTemplateNodes=i}),l=document.createDocumentFragment(),h=0,p=s;h<p.length;h++){var d=p[h];l.appendChild(d)}c.virtualElements.setDomNodeChildren(n,[l]);c.applyBindingsToDescendants(u,n);var v=t.valueAccessor();if(g(v)){var m=v.afterRender;!m||r.isPlaceholder||r.isError||m()}}})})};t.supportsVirtualElements=!0;return t})(i.t);function m(e,t){return!e&&!t||e===t||!(!e||!t)&&(e.getTemplateNodes===t.getTemplateNodes&&e.viewModelType===t.viewModelType&&e.params===t.params)}function g(e){return!!e&&"object"==typeof e&&"specification"in e}function y(e){return!!e.definitionKey}t.n=v},"1449":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e,t){return e===t}function i(e,t){if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(n!==t.length)return!1;for(;n;)if(e[--n]!==t[n])return!1;return!0}},"1457":function(e,t,n){"use strict";var r;(function(e){e[e.created=0]="created";e[e.started=1]="started";e[e.completed=2]="completed";e[e.failed=3]="failed";e[e.canceled=4]="canceled";e[e.expired=5]="expired"})(r||(r={}));t.e=r},"1461":function(e,t,n){"use strict";var r;(function(e){e[e.multiple=0]="multiple";e[e.renameItems=1]="renameItems";e[e.deleteItems=2]="deleteItems";e[e.pointInTimeRestore=3]="pointInTimeRestore";e[e.restoreItems=4]="restoreItems";e[e.uploadItems=5]="uploadItems";e[e.moveItems=6]="moveItems";e[e.copyItems=7]="copyItems";e[e.rotateItems=8]="rotateItems";e[e.addItemsToAlbum=9]="addItemsToAlbum";e[e.addCoverPhotos=10]="addCoverPhotos";e[e.removeCoverPhotos=11]="removeCoverPhotos";e[e.createAlbumFromFolder=12]="createAlbumFromFolder";e[e.createColumn=13]="createColumn";e[e.editColumn=14]="editColumn";e[e.deleteColumn=15]="deleteColumn";e[e.checkInItem=16]="checkInItem";e[e.checkOutItem=17]="checkOutItem";e[e.undoCheckOutItem=18]="undoCheckOutItem";e[e.createFolder=19]="createFolder";e[e.updateBundle=20]="updateBundle";e[e.shareItem=21]="shareItem";e[e.reportAbuse=22]="reportAbuse";e[e.requestReview=23]="requestReview";e[e.setAlbumCoverPhoto=24]="setAlbumCoverPhoto";e[e.createAlbum=25]="createAlbum";e[e.uploadVideos=26]="uploadVideos";e[e.saveItem=27]="saveItem";e[e.createItem=28]="createItem";e[e.publishItem=29]="publishItem";e[e.unPublishItem=30]="unPublishItem";e[e.applyOfficeLens=31]="applyOfficeLens";e[e.removeOfficeLens=32]="removeOfficeLens";e[e.updateMetadata=33]="updateMetadata";e[e.makeHomepage=34]="makeHomepage";e[e.triggerFlow=35]="triggerFlow";e[e.downloadAsZip=36]="downloadAsZip";e[e.saveAutoAlbum=37]="saveAutoAlbum";e[e.discardAutoAlbum=38]="discardAutoAlbum";e[e.addToOneDrive=39]="addToOneDrive";e[e.removeFromSharedList=40]="removeFromSharedList";e[e.setupApprovalFlow=41]="setupApprovalFlow";e[e.setupReminderFlow=42]="setupReminderFlow";e[e.sharepointPointInTimeRestore=43]="sharepointPointInTimeRestore";e[e.sharingReport=44]="sharingReport";e[e.editViewColumns=45]="editViewColumns";e[e.runModelOnItems=46]="runModelOnItems";e[e.importModel=47]="importModel"})(r||(r={}));t.e=r},"1463":function(e,t,n){"use strict";n.d(t,"t",function(){return w});var r=n(0),i=n(1482),s=n(232),o=n(1466),u=n(10),a=n(18),f=n(274),l=n(1449),c=n(231),h=n(1704),p=n(1476),d=n(786),v=n(642),m=Object(d.isFeatureEnabled)(d.ReadOnlyItemsStore);function g(e){return e&&e.item&&e.item.peek().key}function y(e){e.isExpired=!0;var t=e.content,n=t.peek();n.groupings=null;n.items=[];t.valueHasMutated()}var b=(function(e){Object(r.__extends)(t,e);function t(){var t=e.call(this,"ItemsStore")||this;t._itemSetsKeys={};t._observables=new o.e({owner:t});t._vaultItemsToPurge=[];window.odstore=t;return t}t.prototype.dispose=function(){this._observables.dispose()};t.prototype.setItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return this._handleSetItem.apply(this,Object(r.__spreadArrays)([e],t))};t.prototype.getItem=function(e){return this.getValue("item="+e)};t.prototype.setItemSet=function(e,t){var n="result="+e;this.setValue(n,t);this._itemSetsKeys[n]=1};t.prototype.getItemSetFromItemKey=function(e){var t;for(var n in this._itemSetsKeys){var r=(t=this.getValue(n)).content&&t.content.peek(),i=r&&r.items;if(i)for(var s=0,o=i;s<o.length;s++){var u=o[s];if(u&&u.peek().parentKey===e)return t}}};t.prototype.getItemSet=function(e){return this.getValue("result="+e)};t.prototype.getAllItemSetKeys=function(){var e=[];for(var t in this._itemSetsKeys)e.push(t.slice("result=".length));return e};t.prototype.setNextRequestToken=function(e,t,n){var r="token="+t;n?this.setValue(r,n):this.remove(r)};t.prototype.getNextRequestToken=function(e){return this.getValue("token="+e)};t.prototype.invalidateItem=function(e,t){var n=(void 0===t?{}:t).purgeCache,r=void 0!==n&&n;return this._handleItemInvalidation(e,this.getItem(e),r)};t.prototype.invalidateItemSet=function(e){var t=this.getValue("result="+e);t&&y(t)};t.prototype.emptyAllOtherSets=function(e){var t;for(var n in this._itemSetsKeys)(t=this.getValue(n)).item&&(0===e.length||e.indexOf(t.item.peek().key)<0)&&y(t)};t.prototype.invalidateLocation=function(e){var t;for(var n in this._itemSetsKeys){var r=g(t=this.getValue(n));if(r){var i=f.e(r),s=i&&i.locationFilter;s&&s.indexOf(e)>=0&&(t.isExpired=!0)}}};t.prototype.invalidateTag=function(e){var t;for(var n in this._itemSetsKeys){var r=g(t=this.getValue(n));if(r){var i=f.e(r);i&&i.tagFilter===e&&(t.isExpired=!0)}}};t.prototype.invalidateAllPhotos=function(){var e;for(var t in this._itemSetsKeys){var n=(e=this.getValue(t)).item&&e.item.peek();if(n&&n.key&&n.key.indexOf("allmyphotos")>=0){e.isExpired=!0;this._invalidateItem(n)}}};t.prototype.invalidateAllVault=function(){for(var e=0,t=Object(r.__spreadArrays)(this._vaultItemsToPurge);e<t.length;e++){var n=t[e],s=void 0;if(n.vault&&n.vault.root){(s=new i.e(n.key)).name=n.name;s.displayName=n.displayName;s.dateModified=" ";s.folder={};s.vault={isLocked:!0,root:{}}}this._purgeItem(n,s)}this._vaultItemsToPurge=[]};t.prototype._handleItemInvalidation=function(e,t,n){var r=this;if(t){var i=t.peek(),s=!1,o=[];if(i){o.push(i);switch(i.type){case c.e.Folder:case c.e.Media:s=!0}}for(var u in this._itemSetsKeys){var a=this.getValue(u),f=a.item&&a.item.peek(),l=f&&f.key;if(l&&(l===e||s&&l.indexOf("allmyphotos")>-1)){l===e?this.setNextRequestToken(e,a.key,""):o.push(f);a.isExpired=!0}}o.forEach(n?function(e){return r._purgeItem(e)}:function(e){return r._invalidateItem(e)})}};t.prototype._purgeItem=function(e,t){var n=t||new i.e(e.key);this.setItem(n)};t.prototype._invalidateItem=function(e){var t=new i.e(e.key);Object(p.default)(t,e);Object(p.default)(t,{revision:e.revision+1});this.setItem(t)};t.prototype._handleSetItem=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var i=[];m&&!Object.isFrozen(e)&&Object.freeze(e);e.vault&&this._vaultItemsToPurge.push(e);e.remoteItem&&(e.iconUrl=v.n+"20/linkedfolder.svg");for(var s=function(t){var n="item="+t,r=m?"item_write="+t:n,s=o.getValue(n),u=o.getValue(r);if(u)u(e);else{(u=o._observables.create(e)).equalityComparer=l.t;o.setValue(r,u);s=m?o._observables.pureCompute(function(){return u()}):u;o.setValue(n,s)}i.push(s)},o=this,u=0,a=Object(h.e)(Object(r.__spreadArrays)([e.key],t));u<a.length;u++){var f=a[u];s(f)}return i[0]};return t})(s.default),w=new u.t({name:"ItemsStore",factory:new a.i(b)});t.e=b},"1466":function(e,t,n){"use strict";var r=n(0),i=(n(1475),n(90)),s=n("knockout-lib");s.onError=function(e){i.default.log(e)};var o=n(255),u=n(210),a=n(1449),f=n(114);n.d(t,"r",function(){return l});n.d(t,"i",function(){return c});n.d(t,"n",function(){return h});n.d(t,"t",function(){return p});function l(e){return h(e)?e.peek():e}function c(e){return s.unwrap(e)}function h(e){return s.isObservable(e)}function p(e){return{defaultValue:e,reducer:function(e,t){return t}}}var d=(function(){function e(e,t){void 0===e&&(e={});void 0===t&&(t={});this._owner=e.owner;this._asyncType=t.asyncType}Object.defineProperty(e.prototype,"scope",{get:function(){return this._scope||(this._scope=new o.e)},enumerable:!0,configurable:!0});e.prototype.subscribe=function(e,t,n){var r,i=(void 0===n?{}:n).isBeforeChange;void 0!==i&&i&&(r="beforeChange");return this.scope.attach(e.subscribe(t,this._owner,r))};e.prototype.create=function(e){return s.observable(e)};e.prototype.createArray=function(e){return s.observableArray(e)};e.prototype.createCallback=function(e){var t=0,n=this.create({}),i=e.defaultValue,s=e.reducer,o=this.pureCompute(function(){return Object.keys(n()).map(function(e){return n()[e]}).reduce(function(e,t){return s(e,c(t))},c(i))});o.equalityComparer=a.t;return Object(f.e)(o,{register:function(e){var i,s=""+ ++t;n(Object(r.__assign)(Object(r.__assign)({},n.peek()),((i={})[s]=e,i)));return{dispose:function(){var e=n.peek(),t=s,i=(e[t],Object(r.__rest)(e,["symbol"==typeof t?t:t+""]));n(i)}}}})};e.prototype.compute=function(e,t){var n=this,r={owner:this._owner,disposeWhen:function(){return n.scope.isDisposed}},i=(function(e){return"object"==typeof e})(e)?e:{read:e},o=s.utils.extend(r,i);t&&s.utils.extend(o,t);var u=s.computed(o);return this.scope.attach(u)};e.prototype.pureCompute=function(e,t){var n={pure:!0};t&&s.utils.extend(n,t);return this.compute(e,n)};e.prototype.backgroundCompute=function(e,t){var n={deferEvaluation:!0};t&&s.utils.extend(n,t);return this._setupBackgroundTask(this.compute(e,n))};e.prototype.wrap=function(e){return h(e)?e:this.create(e)};e.prototype.peekUnwrap=function(e){return h(e)?e.peek():e};e.prototype.unwrap=function(e){return c(e)};e.prototype.isObservable=function(e){return h(e)};e.prototype.ignore=function(e){return(function(e){return s.ignoreDependencies(e)})(e)};e.prototype.dispose=function(){this._scope&&this._scope.dispose()};e.prototype._setupBackgroundTask=function(e){var t=this;this._backgroundTasks||(this._backgroundTasks=[]);this._backgroundTasks.push(e);this._backgroundTasksTimeoutId||(this._backgroundTasksTimeoutId=this._getAsync().setImmediate(function(){return t._runBackgoundTasks()}));return e};e.prototype._runBackgoundTasks=function(){for(;this._backgroundTasks.length;)this._backgroundTasks.shift()();delete this._backgroundTasksTimeoutId;delete this._backgroundTasks};e.prototype._getAsync=function(){var e=this._asyncType||u.default,t=this.scope.attach(new e(this));this._getAsync=function(){return t};return t};return e})();t.e=d},"1468":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(1463),i=n(18),s=(function(){function e(e,t){this._itemsStore=t.itemsStore}e.prototype.getParent=function(e){if(e){var t=this._itemsStore.getItem(e.key),n=t&&t.peek(),r=n&&(n.parentKey||n.parent&&n.parent.key);return r?this._itemsStore.getItem(r):void 0}};e.prototype.getFacetedAncestorOrSelf=function(e,t,n){void 0===n&&(n="");return this.getAncestorOrSelf(e,function(e){return n?e[t]&&e[t][n]:!!e[t]})};e.prototype.getAncestorOrSelf=function(e,t){for(var n,r=e&&e.key;r;){var i=this._itemsStore.getItem(r),s=i&&i.peek();if(!s)break;if(t(s)){n=i;break}r=s&&(s.parentKey||s.parent&&s.parent.key)}return n};e.dependencies={itemsStore:r.t};return e})(),o=Object(i.s)("ItemParentHelper",s)},"1475":function(e,t,n){"use strict";n("knockout-projections-lib")},"1476":function(e,t,n){"use strict";n.r(t);n.d(t,"GraftOperationType",function(){return r});n.d(t,"remove",function(){return s});n.d(t,"optional",function(){return o});n.d(t,"backup",function(){return u});n.d(t,"replace",function(){return a});n.d(t,"default",function(){return f});var r,i=n(0);(function(e){e[e.none=0]="none";e[e.replace=1]="replace";e[e.optional=2]="optional";e[e.remove=3]="remove";e[e.backup=4]="backup"})(r||(r={}));function s(){return{graftOperationType:3}}function o(e){return{graftOperationType:2,value:e}}function u(e){return{graftOperationType:4,value:e}}function a(e){return{graftOperationType:1,value:e}}function f(e,t){if(!l(e))throw new Error("Value for 'base' passed to 'graft' is not an object.");if(!l(t))throw new Error("Value for 'extension' passed to 'graft' is not an object");if(t===e)return e;for(var n=0,r=Object.keys(t);n<r.length;n++){var s=r[n],o=t[s],u=e[s];if(o!==u){var a=o;if(p(a))if(1===a.graftOperationType){u=void 0;o=g=a.value}else if(d(a)){var g=a.value;if(void 0!==e[s])continue;o=g}else{if(!m(a)){if(v(a)){delete e[s];continue}throw new Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.")}if(void 0===(g=a.value))continue;o=g}var y=void 0;if(c(o))y=new Date(o.getTime());else if(h(o)){var b=u;h(b)||(b=[]);b.splice.apply(b,Object(i.__spreadArrays)([0,b.length],o));y=b}else if(l(o)){var w=u;l(w)||(w={});f(w,o);y=w}else y=o;e[s]=y}}return e}function l(e){return"object"==typeof e&&!!e}function c(e){return e instanceof Date}function h(e){return Array.isArray(e)}function p(e){return l(e)&&!!e.graftOperationType}function d(e){return 4===e.graftOperationType}function v(e){return 3===e.graftOperationType}function m(e){return 2===e.graftOperationType}},"1477":function(e,t,n){"use strict";var r=(function(){function e(e,t){if((function(e){return!!e&&"object"==typeof e})(e)){this.key=e.key;this.input=e.input;this.output=e.output;this.status=e.status;this.error=e.error}else{this.key=e;this.input=t;this.status=0}}e.prototype.succeed=function(t){var n=new e(this);n.output=t;n.status=1;delete n.error;return n};e.prototype.fail=function(t){var n=new e(this);n.error=t;n.status=2;return n};e.prototype.cancel=function(){var t=new e(this);delete t.error;t.status=3;return t};e.prototype.restart=function(){return new e(this.key,this.input)};e.prototype.changeInput=function(t){var n=t(this.input),r=new e(this.key,n);r.output=this.output;r.status=this.status;r.error=this.error;return r};e.prototype.changeOutput=function(t){var n=t(this.output),r=new e(this.key,this.input);r.output=n;r.status=this.status;r.error=this.error;return r};e.prototype.compare=function(e){return!e||this.input!==e.input||this.output!==e.output||this.error!==e.error||this.status!==e.status?{previous:e,current:this}:null};return e})();t.e=r},"1481":function(e,t,n){"use strict";n.d(t,"e",function(){return x});var r=n(0),i=n(1442),s=n(109),o=n(380),u=n(822),a=n(791),f=n("react-lib"),l=n("react-dom-lib"),c=n(91),h=n("knockout-lib"),p=n(235),d=n(1483),v=n(129),m=n(211),g=n(90),y=n(550),b=n(278),w=n(1520),E=n(1602),S=new((function(){function e(){this._promises={}}e.prototype.load=function(e){var t=e.path,n=e.getModule,r=window.require.toUrl(t+"_unmapped"),i=this._promises,a=i[r];a||(a=i[r]=s.n.as(Object(u.e)({path:t,getModule:n}))).done(void 0,function(e){delete i[r]});var f=new o.e;a.done(function(e){return f.complete(e)},function(e){return f.error(e)});return f.getPromise()};e.prototype._loadSync=function(e,t){var n;if(t.defined&&t.defined(e)){var r=t(e);if(r)if("object"==typeof r){if(Object.keys(r).length>0){var i=Object(a.e)(r);i&&(n=i)}}else n=r}return n};return e})());function x(e){var t=e.applyBindings,n=e.bindingContext,i=e.children,s=Object(r.__rest)(e,["applyBindings","bindingContext","children"]),o=f.useRef(null),u=Object(E.e)(),a=u[0],l=u[1],c=Object(w.e)({children:i}),p=f.useCallback(function(e){return f.createElement(f.Fragment,null,e.children)},[]);f.useEffect(function(){if(o.current&&t){if(i){var e=document.createElement("div");e.setAttribute("data-bind","react: Children");o.current.appendChild(e)}var s=t(o.current,n.extend(Object(r.__assign)({$react:a},i?{$data:{bindingHandlers:{react:T},Children:{componentType:p,props:c}}}:{})));return function(){s&&s.dispose();o.current&&h.cleanNode(o.current)}}},[]);var d=Object(b.e)(function(){return f.createElement("div",Object(r.__assign)({key:"root",ref:o,role:"presentation","data-is-ko-react-root":"true"},s))},s);return f.createElement(f.Fragment,null,d,l)}var T=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.controlsDescendantBindings=!0;var r,i=n.observables;n._value=i.pureCompute(function(){return i.unwrap(n.valueAccessor())});if(n._value.peek().useDOMContext){var o=Object(y.e)(n.element,function(e){return"true"===e.getAttribute("data-is-ko-react-root")});o&&(r=h.contextFor(o))}else r=n.bindingContext;n._context=r&&r.$react;n._transcludedTemplateNodes=Array.prototype.slice.call(h.virtualElements.childNodes(n.element));h.virtualElements.emptyNode(n.element);n._renderDependencies=n.createObservable();n._componentProps=i.pureCompute(function(){return i.unwrap(n._value().props)});n._componentProps.equalityComparer=p.t;n._rootProps=i.pureCompute(function(){return i.unwrap(n._value().rootProps)});n._rootProps.equalityComparer=p.t;var u=n.scope.attach(new d.e);n.createComputed(function(){var e,t=n._value();if((function(e){return!!e.componentType})(t)){var r=n.observables.unwrap(t.componentType);n._componentNameForLogging=r.displayName||"";c.n.mark("EUPL.ReactBinding.LoadStart."+n._componentNameForLogging);e=s.n.wrap(r)}else{t.getModule||console.error("ReactBinding instantiated with componentPath "+t.componentPath+" but missing getModule");n._componentNameForLogging=t.componentPath;c.n.mark("EUPL.ReactBinding.LoadStart."+n._componentNameForLogging);e=S.load({path:t.componentPath,getModule:t.getModule})}n.trackPromise(u.debounce(s.n.all({componentType:e}).then(function(e){c.n.mark("EUPL.ReactBinding.Loaded."+n._componentNameForLogging);var t=n._context;n.addDisposable({dispose:t?function(){t.unmount(n.element)}:function(){l.unmountComponentAtNode(n.element)}});n._renderDependencies(e)})))});n.createComputed(n._computeRenderComponent);return n}t.prototype._computeRenderComponent=function(){var e=this,t=this._renderDependencies();if(t){var n=t.componentType,i=this._componentProps(),s=this._rootProps(),o=this._transcludedTemplateNodes;c.n.mark("EUPL.ReactBinding.AsyncRender."+this._componentNameForLogging);try{this.observables.ignore(function(){var t=o.length>0?function(e,t){h.applyBindingsToNode(e,{template:{nodes:o}},t)}:void 0,u=f.createElement(v.e,{resources:e.resources},f.createElement(m.e,{onError:function(t){var n=e._value.peek().error;n&&n(t)},componentName:e._componentNameForLogging},f.createElement(n,Object(r.__assign)({},Object(r.__assign)(Object(r.__assign)({},i),t?{children:f.createElement(x,Object(r.__assign)({bindingContext:e.bindingContext,applyBindings:t},s||{}))}:{})))));e._context?e._context.render(u,e.element):l.render(u,e.element)})}catch(e){g.default.logError(e)}}};return t})(i.t);t.t=T},"1482":function(e,t,n){"use strict";var r=n(24),i=function(e){void 0===e&&(e="");this.isDropEnabled=!1;this.permissions={High:0,Low:0};this.key=e;this.revision=0;this.queryType=r.e.Files;this.displayType=r.e.Files;this.isPlaceholder=!0;this.properties={};this.recycleBinProperties={};this.reputationProperties={};this.statistics={views:0,viewsUnique:0,viewsLast2Weeks:0,viewsLast2WeeksUnique:0,viewsLastWeek:0,viewsLastWeekUnique:0,viewsLastMonth:0,viewsLastMonthUnique:0};this.urls={};this.state={upload:{status:5},removing:!1}};t.e=i},"1483":function(e,t,n){"use strict";var r=n(380),i=(function(){function e(){}e.prototype.debounce=function(e){var t=this;this.clear();this._originalPromise=e;var n=new r.e(function(){return t._originalPromise.cancel()});this._originalPromise.done(function(e){t._clear(!1);n.complete(e)},function(e){t._clear(!1);n.error(e)});return n.getPromise()};e.prototype.clear=function(){this._clear(!0)};e.prototype.isExecuting=function(){return Boolean(this._originalPromise)};e.prototype._clear=function(e){if(this.isExecuting()){e&&this._originalPromise.cancel();this._originalPromise=null}};return e})();t.e=i},"1493":function(e,t,n){"use strict";var r=(function(){function e(){this.id=++e._lastBatchId}e._lastBatchId=0;return e})();t.e=r},"1494":function(e,t,n){"use strict";var r=n(0),i=n("knockout-lib");"boolean"==typeof i.options.preferJQueryEvents?i.options.preferJQueryEvents=!1:"boolean"==typeof i.options.useOnlyNativeEvents&&(i.options.useOnlyNativeEvents=!0);var s=n(10),o=n(632),u=n(1531);n.d(t,"e",function(){return a});function a(e){var t,n;if(e&&e.$data&&e.$data.resources)return e.$data.resources;for(;(!(n=e.$data)||"object"!=typeof n||!(t=n.resources))&&e.$parentContext;)e=e.$parentContext;return t}var f={loadViewModel:function(e,t,n){n(function(n,f){void 0===n&&(n={});var l,c=i.contextFor(f.element),h=i.utils.unwrapObservable(n.resources)||a(c),p={owner:e,useFactoriesOnKeys:!0},d=h?new s.n(h,p):new s.n(p);n=Object(r.__assign)(Object(r.__assign)({},n),{resources:d});l=(function(e){return"function"==typeof e.createViewModel})(t)?t.createViewModel(n,f):new(d.injected(t))(n);var v=new u.e({name:e,viewModel:l,element:f.element,bindingContext:c});return Object(o.e)(l,function(){v.dispose();d.dispose()})})}};i.components.loaders.unshift(f)},"1496":function(e,t,n){"use strict";var r=n(0),i=n(1440),s=n(1457),o=n(1493),u=n(1461),a=n(109);function f(){return a.n.wrap()}var l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.key=t.key;var r=n.observables,i=t.count,s=void 0===i?r.create(1):i,o=t.isAvailable,u=void 0===o?r.create(!0):o,a=t.onExecute,l=void 0===a?f:a;n.count=s;n.isAvailable=u;n._onExecute=l.bind(t.operation);return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this._onExecute=f};t.prototype.execute=function(){return this._onExecute()};return t})(i.n),c=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,{})||this,i=n.observables;n.name=t.name;n.iconName=t.iconName;n.state=i.create(s.e.created);n.warning=i.create("");n.error=i.create();n.count=i.create(1);var a=Object(r.__assign)({minimum:0,maximum:0,current:0},t.progress||{});n.progress={minimum:i.create(a.minimum),maximum:i.create(a.maximum),current:i.create(a.current)};n.type=i.create(t.type||u.e.multiple);n.batch=t.batch||new o.e;n._initializeActions(t.actions);n.payloads=i.create(t.payloads||{});n.visibility=i.create(t.visibility||0);return n}t.prototype.dispose=function(){this.actions({});this.payloads({});e.prototype.dispose.call(this)};t.prototype._initializeActions=function(e){void 0===e&&(e={});var t={};for(var n in e){var r=e[n];t[n]=this.scope.attach(new l({key:n,operation:this,isAvailable:r.isAvailable,onExecute:r.execute}))}this.actions=this.observables.create(t)};return t})(i.n),h=n("knockout-lib");function p(e,t){var n,r=function(e){t(t.peek()+e)},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(e.peek()-n)});r(e.peek());return{dispose:function(){i.dispose();s.dispose();r(-e.peek())}}}n(1475);var d=n(632),v=(function(){function e(e,t){var n=this;this._source=e;this._getKey=t;this._groupsByKeyId={};this.groups=h.observableArray();this._initializeGroups();Object(d.e)(this.groups,function(){n._mapping.dispose()})}e.group=function(t,n){return new e(t,n).groups};e.prototype._initializeGroups=function(){var e=this;this._mapping=this._source.map({mappingWithDisposeCallback:function(t){var n=e._getKey(t),r=JSON.stringify(n),i=e._groupsByKeyId[r];if(i)i.values.push(t);else{i={key:n,values:h.observableArray([t])};e._groupsByKeyId[r]=i;e.groups.push(i)}return{mappedValue:r,dispose:function(){if(i.values.peek().length>1)i.values.remove(t);else{delete e._groupsByKeyId[r];e.groups.remove(i)}}}}})};return e})(),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.operations=t.operations;n.name="";n.iconName="";n.progress={minimum:n.createObservable(0),maximum:n.createObservable(0),current:n.createObservable(0)};n.batch=t.batch;n.error=n.createObservable();n.count=n.createObservable(0);n._initializeType();n.payloads=n.createPureComputed(n._computePayloads);n.actions=n.createObservable({});n.states=n.createObservable({created:0,started:0,completed:0,failed:0,canceled:0,expired:0});n._initializeOperations();n.state=n.createPureComputed(n._computeState);n.visibility=n.createPureComputed(n._computeVisibility);return n}t.prototype._initializeType=function(){var e=this.addDisposable(v.group(this.operations,function(e){return e.type()}));this.type=this.createPureComputed(function(){return 1===e().length&&e()[0].key||u.e.multiple})};t.prototype._computePayloads=function(){var e=this.operations()[0];return e&&e.payloads()||{}};t.prototype._initializeOperations=function(){var e=this;this.addDisposable(this.operations.map({mappingWithDisposeCallback:function(t){var n=e.createPureComputed(function(){return s.e[t.state()]}),r=e.addDisposable(p(t.progress.minimum,e.progress.minimum)),i=e.addDisposable(p(t.progress.maximum,e.progress.maximum)),o=e.addDisposable(p(t.progress.current,e.progress.current)),u=e.addDisposable((function(e,t){var n,r=function(e,n){var r=t.peek();void 0!==e&&r[e]--;void 0!==n&&(r[n]=(r[n]||0)+1);t.valueHasMutated()},i=e.subscribe(function(){n=e.peek()},null,"beforeChange"),s=e.subscribe(function(){r(n,e.peek())});r(void 0,e.peek());return{dispose:function(){i.dispose();s.dispose();r(e.peek(),void 0)}}})(n,e.states)),a=e.addDisposable((function(e,t){var n=e.peek(),r=e.subscribe(function(){n=e.peek()},null,"beforeChange"),i=h.computed(function(){!t()&&e()&&t(e())}),s=e.subscribe(function(e){!e&&n&&t.peek()===n&&t(void 0)});return{dispose:function(){i.dispose();s.dispose();r.dispose()}}})(t.error,e.error)),f=e.addDisposable(p(t.count,e.count)),l=e.createComputed(function(){var n=!1,r=e.actions.peek();for(var i in t.actions())if(!(i in r)){r[i]=e._initializeAction(i);n=!0}n&&e.actions.valueHasMutated()});return{mappedValue:t,dispose:function(){n.dispose();r.dispose();i.dispose();o.dispose();u.dispose();l.dispose();a.dispose();f.dispose()}}}}))};t.prototype._computeState=function(){var e=this.states();return e.started||e.created&&(e.failed||e.completed||e.canceled)?s.e.started:e.created?s.e.created:e.failed?s.e.failed:e.completed?s.e.completed:e.canceled?s.e.canceled:s.e.expired};t.prototype._computeVisibility=function(){return this.operations().reduce(function(e,t){var n=t.visibility.peek();return n<e?n:e},2)};t.prototype._initializeAction=function(e){var t=this.addDisposable(this.operations.filter(function(t){var n=t.actions()[e];return n&&n.isAvailable()}));return this.addDisposable(new l({count:this.createPureComputed(function(){return t().length}),key:e,operation:this,isAvailable:this.createPureComputed(function(){return!!t().length}),onExecute:function(){return a.n.all(t().slice().map(function(t){var n=t.actions.peek()[e];return n&&n.execute()||a.n.wrap()}))}}))};return t})(i.n),g=n(18);n.d(t,"e",function(){return b});var y=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this,i=r.observables,s=new o.e;r._observers=i.createArray();var u=r.operations=i.createArray(),a=r.scope.attached(m),f=r.groups=r.addDisposable(v.group(u,function(e){return e.batch}).map({mappingWithDisposeCallback:function(e){var t=new a({batch:e.key,operations:e.values});return{mappedValue:t,dispose:function(){t.dispose()}}}}));r.overall=new(r.managed(m))({batch:s,operations:f});r.isLocked=r.createPureComputed(r._computeIsLocked);r.createBackgroundComputed(r._computeRemoveAllWhenUnlocked).extend({deferred:!0});return r}t.prototype.lock=function(){var e=this,t={};this._observers.push(t);return{dispose:function(){e._observers.remove(t)}}};t.prototype.register=function(e){var t=new c(e);2!==t.visibility.peek()&&this.operations.push(t);return t};t.prototype.deleteGroupOperation=function(e){var t=Object(r.__spreadArrays)(e.operations.peek());this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype.cleanup=function(e){void 0===e&&(e=!1);for(var t=[],n=0,r=this.groups.peek();n<r.length;n++){var i=r[n],o=i.state.peek();if(o===s.e.completed||!e&&(o===s.e.expired||o===s.e.canceled||o===s.e.failed))for(var u=i.operations.peek(),a=void 0,f=0;f<u.length;f++){a=!0;var l=u[f];if(o===s.e.failed&&l.actions)for(var c=l.actions.peek(),h=Object.keys(c),p=0;p<h.length;p++)if("cancel"!==h[p]&&c[h[p]].isAvailable.peek()){a=!1;break}a&&t.push(u[f])}}this.operations.removeAll(t);t.forEach(function(e){e.dispose()})};t.prototype._computeRemoveAllWhenUnlocked=function(){this.isLocked()||this.cleanup()};t.prototype._computeIsLocked=function(){return this._observers().length>0};return t})(i.n),b=Object(g.s)("OperationProvider",y)},"1514":function(e,t,n){"use strict";n.d(t,"t",function(){return i});var r=n("knockout-lib");function i(e,t){var n=e.__automationBinding$elements;return n&&n[t]}t.e={init:function(e,t,n,i,s){r.applyBindingsToNode(e,{attr:{"data-automationId":t()}},s);if(s){var o=s.$component;if(o){var u=r.utils.unwrapObservable(t());if(u){var a=o.__automationBinding$elements;a||(a=o.__automationBinding$elements={});a[u]=e;r.utils.domNodeDisposal.addDisposeCallback(e,function(){a[u]&&delete a[u]})}}}}}},"1517":function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(69),i=n(638),s=n(1304),o=n(10),u=n(18),a=n(12).e.isActivated("335D0ECA-48E7-459E-9687-BE609CBBC94E","10/24/2018","Encode webUrl for api of $batch's additionalPostData"),f=new o.t({name:"ApiUrlHelper.encodeWebAbsoluteUrl",factory:new o.e(!a)}),l=Object(u.s)("ApiUrlHelper",s.e,{itemUrlHelper:i.n,pageContext:r.h,encodeWebAbsoluteUrl:f});s.e},"1518":function(e,t,n){"use strict";n.r(t);n.d(t,"TargetType",function(){return r});n.d(t,"ABExpHash",function(){return i});n.d(t,"EXPERIMENTS_WITH_V1_HASHING",function(){return d});n.d(t,"ABExperiment",function(){return v});var r,i,s=n(0),o=n(171),u=n(1638),a=n(1572),f=n(88),l=n(105),c=n(90),h=n(135),p=n(1643);(function(e){e[e.user=1]="user";e[e.tenant=2]="tenant";e[e.farm=3]="farm";e[e.site=4]="site"})(r||(r={}));(function(e){e[e.v1=1]="v1";e[e.v2=2]="v2"})(i||(i={}));var d=["ChangeFlowToAutomate2","DocLibServiceWorkerExperimentV2","FileHoverCardAssign","flowOdbCommandBarCoachmarkExperiment","flowOdbCommandBarCoachmarkExperiment2","flowRemindMeCoachmarkExperiment","flowRemindMeCoachmarkExperiment2","flowRequestSignOffCoachmarkExperiment2","FluentLightBoxExperiment","NewCreateSiteEntryPointExperiment"],v=(function(){function e(t,n){var u=t.name,a=n&&!h.default.isFeatureEnabled(n);f.e.isActivated("ecfe2fe1-07c6-4117-98d8-27582d0384f7","10/25/2018")||this._isValidName(t.name)||c.default.log("Experiment name '"+t.name+"' is invalid.");var p=d.indexOf(t.name)>-1?i.v1:i.v2;this._experimentData=t=Object(s.__assign)({segmentPopulation:.5,targetType:r.user,version:p},t);a&&(t.name+="AA");this._isOn=!1;if(e._pageContext)switch(this._experimentData.targetType){case r.user:this._isOn=this._isUserExperimentOn();break;case r.tenant:this._isOn=this._isTenantExperimentOn();break;case r.farm:this._isOn=this._isFarmExperimentOn();break;case r.site:this._isOn=this._isSiteExperimentOn()}else o.e.logData({name:this._experimentData.name+".Experiment.HostSettingsMissing"});a&&(this._isOn=!1);var v=Object(l.deserializeQuery)((window.location.search||"").substr(1)),m=(v.enableExp||"").split(","),g=(v.disableExp||"").split(",");-1!==m.indexOf(u)?this._isOn=!0:-1!==g.indexOf(u)&&(this._isOn=!1)}e.init=function(t){e._pageContext=Object(s.__assign)(Object(s.__assign)({},t),{userLoginName:t.userLoginName||"missing_user",siteSubscriptionId:t.siteSubscriptionId||"missing_tenant",farmLabel:t.farmLabel||"missing_farm",siteId:t.siteId||"missing_site"})};e.Init=function(t){e.init(t)};e.prototype.getExperimentData=function(){return this._experimentData};e.prototype.isOn=function(){return this._isOn};e.prototype.IsExperimentOn=function(){return this._isOn};e.prototype._isUserExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",r=this._experimentData,s=r.name,o=r.version;o===i.v1?n=s+"_"+t.userLoginName+"_"+t.siteSubscriptionId+"_"+t.farmLabel:o===i.v2&&(n=s+t.userLoginName);return this._isExperimentOn(n)};e.prototype._isTenantExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",r=this._experimentData,s=r.name,o=r.version;o===i.v1?n=s+"_"+t.siteSubscriptionId+"_"+t.farmLabel:o===i.v2&&(n=s+t.siteSubscriptionId);return this._isExperimentOn(n)};e.prototype._isFarmExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n="",r=this._experimentData,s=r.name,o=r.version;o===i.v1?n=s+"_"+this._getSiteId()+"_"+t.siteSubscriptionId+"_"+t.farmLabel:o===i.v2&&(n=s+this._getSiteId());return this._isExperimentOn(n)};e.prototype._isSiteExperimentOn=function(){var t=e._pageContext;if(!t)return!1;var n=this._experimentData.name+"_"+this._getSiteId()+"_"+t.siteSubscriptionId+"_"+t.farmLabel;return this._isExperimentOn(n)};e.prototype._isValidName=function(e){return!/[^A-Za-z0-9]/.test(e)};e.prototype._getSiteId=function(){var t=e._pageContext;return this._experimentData.siteId?this._experimentData.siteId:t.siteId};e.prototype._isExperimentOn=function(e){if(!e)return!1;var t=0;this._experimentData.version===i.v1?t=this._getHashNumber(e):this._experimentData.version===i.v2&&(t=this._getHashNumberMurmur(e));var n=t<=this._experimentData.segmentPopulation;this._logData(n);return n};e.prototype._getHashNumber=function(e){if(0===e.length)return 1;for(var t=5381,n=0;n<e.length;++n){t=(t<<5)+t+e.charCodeAt(n);t&=t}return(t&=65535)/65535};e.prototype._getHashNumberMurmur=function(e){return p.v3(e,1)/4294967295};e.prototype._getExperimentType=function(){return this._experimentData.targetType===r.user?a.e.User:this._experimentData.targetType===r.site?a.e.Site:a.e.Unknown};e.prototype._logData=function(e){u.e.logData({name:"",isInRamp:e,experiment:this._experimentData.name,variant:e.toString(),assignmentType:this._getExperimentType(),assignmentId:this._experimentData.targetType===r.site?this._getSiteId():""})};return e})()},"1520":function(e,t,n){"use strict";n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});n.d(t,"n",function(){return c});n(0);var r=n("react-lib"),i=n(129),s=n(1466),o=n(1440),u=n(114),a=n(197);function f(e){var t=c(),n=t.peekUnwrap(e),i=r.useState(function(){return n})[1];r.useEffect(function(){if(t.isObservable(e)){i(function(){return e.peek()});var n=t.subscribe(e,function(e){i(function(){return e})});return function(){n.dispose()}}},[e]);return n}function l(e){var t=c(),n=r.useRef(),i=n.current||(n.current=Object(u.e)(t.create(e),{equalityComparer:a.e}));r.useEffect(function(){i(e)},[e]);return i}function c(){var e=Object(i.t)(),t=r.useRef(),n=t.current||(t.current=new(e.consume(o.i.optional)||s.e));r.useLayoutEffect(function(){return function(){n.dispose()}},[]);return n}},"1531":function(e,t,n){"use strict";var r=0,i=(function(){function e(e){var t=this._viewModel=e.viewModel,n=t.__ResourceComponentLoader$componentId=""+ ++r;t.__ResourceComponentLoader$componentBindingElement=e.element;t.__ResourceComponentLoader$childComponents={};t.__ResourceComponentLoader$componentName=e.name;for(var i=e.bindingContext;i&&(!i.$data||i.$data===t||!i.$data.__ResourceComponentLoader$childComponents);)i=i.$parentContext;if(i){var s=this._parentViewModel=i.$data;s.__ResourceComponentLoader$childComponents[n]=t;t.__ResourceComponentLoader$parentComponentViewModel=s}}e.prototype.dispose=function(){var e=this._viewModel,t=this._parentViewModel,n=e.__ResourceComponentLoader$componentId,r=t&&t.__ResourceComponentLoader$childComponents;n&&r&&delete r[n];if(e){delete e.__ResourceComponentLoader$parentComponentViewModel;delete e.__ResourceComponentLoader$childComponents;delete e.__ResourceComponentLoader$componentBindingElement;delete e.__ResourceComponentLoader$componentName}};return e})();t.e=i},"1536":function(e,t,n){"use strict";var r=function(e){this.errorType=e.errorType||0;this.message=e.message;this.payloads=e.payloads||{}};t.e=r},"1565":function(e,t,n){"use strict";var r='\x3c!--ko if:areCSS3TransitionsSupported--\x3e<div class="ProgressSpinnerFlat" role="progressbar"><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div><div aria-hidden="true">•</div></div>\x3c!--/ko--\x3e\x3c!--ko if:!areCSS3TransitionsSupported--\x3e<img data-bind="attr:{src:loadingUrl,alt:loadingString}">\x3c!--/ko--\x3e',i=n(127);Object(i.n)([{rawString:".ProgressSpinnerFlat{position:relative;box-sizing:border-box;padding:2px 0;overflow:hidden;height:6px;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";font-size:15px}.ProgressSpinnerFlat>div{position:relative;line-height:0;cursor:default;animation:progress 3.4s infinite cubic-bezier(0,.75,1,.25)}[dir=ltr] .ProgressSpinnerFlat>div{left:-50px}[dir=rtl] .ProgressSpinnerFlat>div{right:-50px}[dir=rtl] .ProgressSpinnerFlat>div{animation:progressRtl 3.4s infinite cubic-bezier(0,.75,1,.25)}.ProgressSpinnerFlat>div:nth-child(1){animation-delay:.1s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(1){margin-left:40px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(1){margin-right:40px}.ProgressSpinnerFlat>div:nth-child(2){animation-delay:.2s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(2){margin-left:30px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(2){margin-right:30px}.ProgressSpinnerFlat>div:nth-child(3){animation-delay:.3s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(3){margin-left:20px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(3){margin-right:20px}.ProgressSpinnerFlat>div:nth-child(4){animation-delay:.4s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(4){margin-left:10px}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(4){margin-right:10px}.ProgressSpinnerFlat>div:nth-child(5){animation-delay:.5s}[dir=ltr] .ProgressSpinnerFlat>div:nth-child(5){margin-left:0}[dir=rtl] .ProgressSpinnerFlat>div:nth-child(5){margin-right:0}@keyframes progress{from{left:-50px}25%{left:-50px}to{left:100%}}@keyframes progressRtl{from{right:-50px}25%{right:-50px}to{right:100%}}"}]);var s=n(0),o=n(1441),u=n(325),a=n(1629),f=n(272),l=(function(e){Object(s.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.platformDetection,s=void 0===i?r.resources.consume(f.e):i;r.areCSS3TransitionsSupported=s.areCSS3TransitionsSupported;r.loadingUrl=window.require.toUrl("odsp-media/images/loading/loadingdots.gif");r.loadingString=a.e.LoadingText;return r}t.resources=Object(s.__assign)(Object(s.__assign)({},o.t.dependencies),{platformDetection:f.e,settingsDataSource:u.ne});return t})(o.t),c=n(1443),h=n(1445);n.d(t,"t",function(){return d});var p=Object(c.e)({tagName:"ms-progressSpinnerFlat",template:r,viewModel:l,synchronous:!0}),d=Object(h.t)({automationName:"ms-progressSpinnerFlat",name:"ProgressSpinnerFlat",template:r,viewModelType:l});t.e=p},"1572":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Unknown=0]="Unknown";e[e.User=1]="User";e[e.Site=2]="Site"})(r||(r={}))},"1595":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1440),i=new(n(10).t)({name:"UserStateProvider.key.updateQuota",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType);return{instance:t.create(!1),disposables:t}}}})},"1600":function(e,t,n){"use strict";var r=n(1609),i=n("knockout-lib"),s=n(1449),o=function(e,t,n){this.key=e||"";this.content=i.observable(new r.e(n));this.content.equalityComparer=s.t;this.schema=i.observableArray([]);this.schema.equalityComparer=s.e;this.context=i.utils.extend({},t);this.contentTypes=i.observableArray([]);this.isPlaceholder=!0;this.version=0};t.e=o},"1602":function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n("react-lib"),s=n("react-dom-lib"),o=n(67),u=n(150),a=0,f=Object(o.e)(function(e){return""+ ++a});function l(){var e=i.useState(function(){return{}}),t=e[0],n=e[1],o=Object(u.e)(function(e,t){n(function(n){var i,o=f(t);return Object(r.__assign)(Object(r.__assign)({},n),((i={})[o]=s.createPortal(e,t),i))})}),a=Object(u.e)(function(e){n(function(t){var n=f(e);t[n];return Object(r.__rest)(t,["symbol"==typeof n?n:n+""])})}),l=i.useRef(),c=l.current||(l.current={render:o,unmount:a}),h=i.useMemo(function(){return i.createElement(i.Fragment,null,Object.keys(t).map(function(e){return i.createElement(i.Fragment,{key:e},t[e])}))},[t]);return i.useMemo(function(){return[c,h]},[c,h])}},"1609":function(e,t,n){"use strict";var r=function(e){this.items=new Array(e||0);this.groupings=null;this.partialResultRequestCount=0;this.partialResultStatus=0};t.e=r},"1616":function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(10),i=(new r.t("dataStore"),new r.t("userSettingsStore")),s=new r.t("userInfoStore"),o=new r.t("smartFiltersStore")},"1625":function(e,t,n){"use strict";var r=n("knockout-lib"),i=(function(){function e(){this._originalProvider=new r.bindingProvider;this._bindingHandlers={};this._bindingContexts=[]}e.getInstance=function(){return e._instance};e.prototype.nodeHasBindings=function(e){return this._originalProvider.nodeHasBindings(e)};e.prototype.getBindings=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindings(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingAccessors=function(e,t){try{this._bindingContexts.push(t);var n=this._originalProvider.getBindingAccessors(e,t);return n&&this._remapKeys(n,t)}finally{this._bindingContexts.pop()}};e.prototype.getBindingHandler=function(e){var t=this._bindingContexts.slice(-1)[0];if(t){var n=this._getLocalBindingHandlers(t);if(n){var i=n[e];e=i&&this.getUniqueKeyForBindingHandler(i,e)||e}}return this._bindingHandlers[e]||r.bindingHandlers[e]};e.prototype.getUniqueKeyForBindingHandler=function(t,n){var i=e._BINDING_PROVIDER_UNIQUE_KEY,s=t[i]=t[i]||n+"-local-"+ ++e._lastUniqueKeyOrdinal;this._bindingHandlers[s]={init:t.init&&t.init.bind(t),update:t.update&&t.update.bind(t),options:t.options,preprocess:t.preprocess&&t.preprocess.bind(t)};this._bindingHandlers[s].after=t.after;t.supportsVirtualElements&&(r.virtualElements.allowedBindings[s]=!0);return s};e.prototype._remapKeys=function(e,t){var n=e,r=this._getLocalBindingHandlers(t);if(r){n={};for(var i in e){var s=r[i];n[s&&this.getUniqueKeyForBindingHandler(s,i)||i]=e[i]}}return n};e.prototype._getLocalBindingHandlers=function(e){for(var t;!(t="object"==typeof e.$data&&e.$data.bindingHandlers)&&e.$parentContext;)e=e.$parentContext;return t};e._instance=new e;e._BINDING_PROVIDER_UNIQUE_KEY="__localBindingProvider__uniqueKey";e._lastUniqueKeyOrdinal=0;return e})(),s=i.getInstance();r.getBindingHandler=s.getBindingHandler.bind(s);r.bindingProvider.instance=s},"1638":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(264),i=n(1572),s=Object(r.e)({eventName:"Experiment,",shortEventName:"Experiment"},{name:{isPrefixingDisabled:!0,type:1},isInRamp:{isPrefixingDisabled:!0,type:3},experiment:{isPrefixingDisabled:!0,type:1},variant:{isPrefixingDisabled:!0,type:1},assignmentType:{isPrefixingDisabled:!0,type:6,typeRef:i.e},assignmentId:{isPrefixingDisabled:!0,type:1}});t.t=s},"1643":function(e,t,n){(function(){function t(e,t){var n,r,i,s,o,u,a,f;n=3&e.length;r=e.length-n;i=t;o=3432918353;u=461845907;f=0;for(;f<r;){a=255&e.charCodeAt(f)|(255&e.charCodeAt(++f))<<8|(255&e.charCodeAt(++f))<<16|(255&e.charCodeAt(++f))<<24;++f;i=27492+(65535&(s=5*(65535&(i=(i^=a=(65535&(a=(a=(65535&a)*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*u+(((a>>>16)*u&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16)}a=0;switch(n){case 3:a^=(255&e.charCodeAt(f+2))<<16;case 2:a^=(255&e.charCodeAt(f+1))<<8;case 1:i^=a=(65535&(a=(a=(65535&(a^=255&e.charCodeAt(f)))*o+(((a>>>16)*o&65535)<<16)&4294967295)<<15|a>>>17))*u+(((a>>>16)*u&65535)<<16)&4294967295}i^=e.length;i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295;i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295;return(i^=i>>>16)>>>0}var n=t;n.v2=function(e,t){for(var n,r=e.length,i=t^r,s=0;r>=4;){n=1540483477*(65535&(n=255&e.charCodeAt(s)|(255&e.charCodeAt(++s))<<8|(255&e.charCodeAt(++s))<<16|(255&e.charCodeAt(++s))<<24))+((1540483477*(n>>>16)&65535)<<16);i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16));r-=4;++s}switch(r){case 3:i^=(255&e.charCodeAt(s+2))<<16;case 2:i^=(255&e.charCodeAt(s+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(s)))+((1540483477*(i>>>16)&65535)<<16)}i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16);return(i^=i>>>15)>>>0};n.v3=t;e.exports=n})()},"1644":function(e,t,n){"use strict";var r=n("knockout-lib");n(1494),n(1625);window.__ko=r},"1651":function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return o});var r=n(1440),i=n(10),s=n(923),o=new i.t({name:"IsDetailsPaneExpanded.isDetailsPaneExpanded",factory:{dependencies:{detailsPaneId:s.e,observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},"1704":function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){var t;t={};for(var n=[],r=0,i=e;r<i.length;r++){var s=i[r],o=""+s;if(!t[o]){t[o]=!0;n.push(s)}}return n}},"1739":function(e,t,n){"use strict";n.d(t,"e",function(){return p});var r=n(0),i=(n(1644),n("react-lib")),s=n(1445),o=n("knockout-lib"),u=n(10),a=n(1520),f=n(1481),l=n(150),c=n(129);function h(e){var t=e.specification,n=e.placeholder,r=Object(c.t)(),u=Object(a.e)(t),h=i.useState(function(){return(function(){var e=document.createElement("div");o.applyBindings({},e);var t=o.contextFor(e);o.removeNode(e);return t})()})[0],p=Object(l.e)(function(e,t){return new(r.resolved(s.n))({element:e,valueAccessor:function(){return{specification:u,placeholder:n}},bindingContext:t})});return i.createElement(f.e,{bindingContext:h,applyBindings:p},e.children)}function p(e){var t=e.resources,n=Object(r.__rest)(e,["resources"]),s=i.createElement(h,Object(r.__assign)({},n));return t?i.createElement(c.e,{resources:t},s):s}t.t=p;new u.t({name:"Knockout",factory:new u.e(p)})},"1798":function(e,t,n){"use strict";var r;(function(e){e[e.Lock=1]="Lock";e[e.Unlock=2]="Unlock";e[e.Manage=3]="Manage";e[e.FreDialog=4]="FreDialog";e[e.ShowFiles=5]="ShowFiles";e[e.Reset=6]="Reset";e[e.Debug=7]="Debug";e[e.FilesRemaining=8]="FilesRemaining"})(r||(r={}));t.e=r},"1895":function(e,t,n){"use strict";var r=n(127);Object(r.n)([{rawString:".od-Error{text-align:center}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}])},"2084":function(e,t,n){"use strict";n.r(t);var r='<div class="od-Error"><div class="od-Error-image"><img data-bind="attr:{src:imageUrl,alt:errorTitle,class:errorClassName}"></div><div class="od-Error-title" data-bind="text:errorTitle"></div>\x3c!--ko if:errorDetailedText--\x3e<div class="od-Error-subText" data-bind="text:errorDetailedText,css:{\'od-Error-subtext--accessremoved\':isAccessRemoved}"></div>\x3c!--/ko--\x3e\x3c!--ko if:errorHtml--\x3e<div class="od-Error-subText" data-bind="html:errorHtml"></div>\x3c!--/ko--\x3e\x3c!--ko if:showAction--\x3e<form class="od-Error-button" data-bind="attr:{action:actionUrl}" method="get"><button class="od-Button" data-bind="click:onButtonClick" type="submit"><span class="od-Button-label" data-bind="text:actionText"></span></button></form>\x3c!--/ko--\x3e<div class="od-Error-code" data-bind="visible:correlationIdText,text:correlationIdText"></div><div class="od-Error-code" data-bind="visible:showErrorCode,text:errorCodeText"></div></div>',i=(n(1895),n(0)),s=n(1441),o=n(1799),u=n(90),a=n(171),f=n(23),l=n(1651),c=n(149),h=n(18),p=n(325),d=(function(){function e(e,t){this._errorDataSource=t.errorDataSource;this._defaultErrorAction={text:o.e.DefaultActionText,url:t.urlDataSource.getRootUrl()}}e.prototype.getAction=function(e){return this._errorDataSource?this._errorDataSource.getAction(e):this._defaultErrorAction};return e})(),v=Object(h.s)("ErrorProvider",d,{errorDataSource:p.c.optional,urlDataSource:p.me}),m=n(787),g=n(1798),y=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this,i=t.error;r._navigation=r.resources.consume(c.e);r._actionMap=r.resources.consume(m.e.optional);var s,h,p,d,g,y,w=r.resources.consume(v);r.errorClassName="od-Error-imageTag";if(b(i)){s=i.errorTitle;h=i.errorCode;p=i.errorDetailedText;d=i.errorDetailedHtml;g=i.correlationId;y=w.getAction(i)}else i.message&&(p=i.message);s||(s=o.e.DefaultTitle);r.errorTitle=s;r.errorDetailedText=p;r.errorHtml=d;r.errorCode=h;p||d||(p=o.e.DefaultSubText);r.errorDetailedText=p;r.showAction=!!y&&!y.hideButton&&!t.hideAction;if(y){r.actionText=y.text;r.actionUrl=y.url}r.showErrorCode=h&&r.errorTitle===o.e.DefaultTitle;if(r.showErrorCode){u.default.log(i,"ServerError",""+h);r.errorCodeText=f.format(o.e.errorCodeText,h)}else r.errorCodeText="";r.correlationIdText=g?f.format(o.e.errorCorrelationIdText,g):"";if("accessremoved"===h){r.isAccessRemoved=!0;r.imageUrl=window.require.toUrl("odsp-media/images/error/error2.svg")}else{r.isAccessRemoved=!1;r.imageUrl=r._getRandomImage()}if(b(i)&&i.actionUrl&&161===i.errorCode){r.resources.consume(l.resourceKey)(!1);r.actionText=o.e.UnlockButtonText;r.errorDetailedText=o.e.UnlockRequiredErrorText;r.errorCodeText="";r.errorTitle=o.e.UnlockRequiredErrorTitle;r.imageUrl=window.require.toUrl("odsp-media/images/error/vault/vaultclosed.svg");r.errorClassName="od-Error-vaultImage";a.e.logData({name:"Vault.Bookmarked.Loaded"})}return r}t.prototype.onButtonClick=function(){if(this.showAction)if(161===this.errorCode&&this._actionMap){a.e.logData({name:"Vault.Bookmarked.Unlock"});new(this.managed(this._actionMap.VaultAction))({actionType:g.e.Unlock}).execute(null)}else{this._navigation.navigateTo(this.actionUrl)}return!1};t.prototype._getRandomImage=function(){var e=Math.ceil(3*Math.random());return window.require.toUrl("odsp-media/images/error/error"+e+".svg")};return t})(s.t);function b(e){return!(!e||!e.errorTitle&&void 0===e.errorCode)}var w=n(1443),E=n(1445);n.d(t,"resourceKey",function(){return x});var S=w.e({tagName:"ms-error",template:r,viewModel:y,synchronous:!0}),x=Object(E.t)({name:"Error",automationName:"ms-error",template:r,viewModelType:y});t.default=S},"2106":function(e,t,n){"use strict";n.d(t,"e",function(){return v});var r=n(0),i=n("react-lib"),s=n(35),o=n(36),u=n(324),a=n(29),f=n(166),l=n(39),c=n(129),h=n(156),p=n(8);function d(e){var t=e.pageLoadContinueSignal,n=e.pageLoadReadySignal,s=Object(c.t)();n&&n.resolve();var o=Object(u.t)();i.useEffect(function(){var e=s.consume(h.e);e&&e.pageLoaded();o(Object(l.u)()).then(function(){var e;t&&t.resolve();o(Object(f.e)({items:(e={},e[p.a]=Object(r.__assign)({},p.r.pack(!0)),e)}))})},[]);return null}var v=Object(s.t)(function(e,t){var n=Object(a.e)(e,{pageLoadConfiguration:o.u}).pageLoadConfiguration||{},r=n.pageLoadReadySignal,s=void 0===r?void 0:r,u=n.pageLoadContinueSignal,f=void 0===u?void 0:u;return i.createElement(d,{pageLoadContinueSignal:f,pageLoadReadySignal:s})})},"2179":function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(1440),s=n(109),o=n(18),u=n(1517),a=n(638),f=n(485),l=n(787),c=n(1468),h=n(69),p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._apiUrlHelper=n.apiUrlHelper;r._dataRequestor=r.scope.attach(new n.dataRequestorType({qosName:"PolicyTipDataSource"}));r._itemParentHelper=n.itemParentHelper;r._itemUrlHelper=n.itemUrlHelper;r._viewParams=n.viewParams;r._sharingContextInformation=n.sharingContextInformation;return r}t.prototype.getExternalSharingStatus=function(){return this._isPseudo()?s.n.wrap({isExternalSharingTipEnabled:!0,externalSharingTipsLearnMoreUrl:"http://bing.com"}):this._dataRequestor.getData({url:this._apiUrlHelper.build().segments("web","DataLeakagePreventionStatusInfo").toString(),qosName:"GetExternalSharingStatus"}).then(function(e){var t=e&&e.d;return t?{isExternalSharingTipEnabled:t.ExternalSharingTipsEnabled,externalSharingTipsLearnMoreUrl:t.ExternalSharingTipsLearnMoreUrl}:null})};t.prototype.getPolicyTip=function(e){if(this._isPseudo())return s.n.wrap({issueDescriptions:["Item contains the following sensitive information: U.S. Social Security Number (SSN)","Item is shared with people outside your organization","Item contains sensitive document properties"],overrideOption:2,lastScanned:new Date,policyInfoUrl:"http://bing.com",explanationText:"This item conflicts with a policy in your organization. Access to this item is blocked for everyone except its owner, last modifier, and the site owner."});if(!this._sharingContextInformation&&!e)return s.n.wrap(null);var t=this._getApiRoot(e).segment("getdlppolicytip");return this._dataRequestor.getData({url:t.toString(),qosName:"GetPolicyTip"}).then(function(e){var t=e&&e.d;if(!t||null===t.GetDlpPolicyTip)return s.n.wrap(null);var n=t.MatchedConditionDescriptions,r=t.OverrideOptions,i=void 0===r?0:r,o=t.GeneralText,u=t.AppliedActionsText,a=Date.parse(t.LastProcessedTime);return{issueDescriptions:n&&n.results,overrideOption:Number(i),policyInfoUrl:t.ComplianceUrl,explanationText:o&&u?o+" "+u:o||u||"",lastScanned:isNaN(a)?void 0:new Date(a)}})};t.prototype.updatePolicy=function(e){if(this._isPseudo())return s.n.wrap(0===e.action?2:1===e.action?3:0);var t=this._getApiRoot(e.item).segment("overridepolicytip");return this._dataRequestor.getData({url:t.toString(),additionalPostData:JSON.stringify({userAction:e.action,justification:e.justification}),method:"POST",qosName:"UpdatePolicyTip"}).then(function(e){var t=e&&e.d,n=t&&t.OverridePolicyTip;return"number"==typeof n?n:null})};t.prototype._getApiRoot=function(e){var t;if(this._sharingContextInformation)if(this._sharingContextInformation.uniqueId){var n=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",r={guid:this._sharingContextInformation.uniqueId};t=this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(n,r).segment("ListItemAllFields")}else t=this._sharingContextInformation.listUrl?this._apiUrlHelper.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",this._sharingContextInformation.itemUrl).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):this._apiUrlHelper.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);else{var i=this._itemUrlHelper.getItemUrlParts(e.key),s=this._getParentListId(e);t=this._apiUrlHelper.build().webByItemUrl(i).method("Lists",s).method("GetItemById",e.properties.ID)}return t};t.prototype._getParentListId=function(e){var t=this.peekUnwrapObservable(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return t?t.list.id:e&&e.properties&&e.properties.listId};t.prototype._isPseudo=function(){return"1"===this._viewParams.peek().showpolicytips};return t})(i.n),d=Object(o.s)("PolicyTipDataSource",p,{apiUrlHelper:u.e,dataRequestorType:f.n,itemParentHelper:c.e,itemUrlHelper:a.n,viewParams:l.H,sharingContextInformation:h.p.optional})},"2194":function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(10),i=n(18),s=new r.t({name:"OneUp.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("399")]).then(n.bind(null,2657)).then(function(e){return e.resourceKey.local})})});t.e=s},"2233":function(e,t,n){"use strict";var r=n(0),i=n(109),s=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getBundles=function(){var e;return(e={})[1]={path:"../../../bundles/odb/DeferredControls",getModule:function(){return i.n.resolve(Promise.all([n.e("deferred.resx-deferred"),n.e("deferred.office-ui-fabric-react"),n.e("deferred.odsp-common"),n.e("odsp.knockout.lib"),n.e("deferred")]).then(n.bind(null,3326)))},isLoaded:this.createObservable(!1)},e};return t})(n(1440).n);t.e=s},"3015":function(e,t,n){"use strict";n.r(t);var r="\x3c!--ko control:controlBindingOptions--\x3e\x3c!--/ko--\x3e",i=n(0),s=n(1441),o=n(18),u=n(1445),a=n(2084),f=n(2194),l=n(1565),c=n(2233),h=n(1799),p=n(2179),d=n(44),v=n(1303),m=n(1600),g=n(1609),y=n(787),b=n(325),w=n(382),E=n(91),S=n(90),x=n(109),T=n(149),N=(function(e){Object(i.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:u.n});var i=r,s=i.observables,N=i.resources,C=N.consume(b.me),k=N.consume(v.resourceKey),L=N.consume(T.e).viewParams,A=C.getCurrentItemKey(L),O=C.getFocusItemKey(L);if(!O){r.controlBindingOptions={specification:Object(u.r)(a.resourceKey,{error:new Error(h.e.ItemNotFoundTitle)})};return r}var M=function(e,t){var n=C.getKeyParams(e);t&&delete n.view;return{parentKey:e,ownerId:C.getOwnerId(e),queryType:C.getQueryType(n),ignoreChildren:t}},_=M(O,!0),D=k.getItemSync(_).item,P=k.getItemSync(M(A,!1)),H=N.consume(w.e),B=new m.e;B.item=P.item;s.compute(function(){var e=new g.e;e.items=[D];B.content(e)});E.n.mark("DataManager.GetData.Started");r.trackPromise(k.getItem(_).then(function(){E.n.mark("DataManager.GetData.Done")},function(e){e.errorTitle||x.n.isCanceled(e)||S.default.log(e)}));N.expose(b.i,new(r.managed(c.e)));N.exposeFactory(b.$,new o.e(p.e));N.expose(y.s,P.item);N.expose(y.o,s.create(P));N.expose(y.m,s.create(B));N.expose(y.v,s.create(D));r.controlBindingOptions={specification:Object(u.r)(f.e,{}),placeholder:Object(u.r)(l.t,{}),afterRender:function(){H.pageLoaded(d.e[d.e.OneUp])}};return r}return t})(s.t),C=n(1443);n.d(t,"resourceKey",function(){return L});var k=Object(C.e)({tagName:"od-spo-oneup",template:r,viewModel:N,synchronous:!0}),L=Object(u.t)({automationName:"",name:"OneUp_1",template:r,viewModelType:N});t.default=k},"3876":function(e,t,n){"use strict";n.r(t);n.d(t,"KnockoutOneUp",function(){return h});var r=n("react-lib"),i=n(35),s=n(1739),o=n(1445),u=n(3015),a=n(129),f=n(904),l=n(2106);function c(e){var t=Object(a.t)(),n=r.useState(function(){return Object(o.r)(u.resourceKey,{})})[0];return r.createElement(r.Fragment,null,r.createElement(f.e,{bypass:!0},r.createElement(s.e,{specification:n,resources:t})),r.createElement(l.e,null))}var h=Object(i.t)(function(e,t){return r.createElement(c,null)})}}]);