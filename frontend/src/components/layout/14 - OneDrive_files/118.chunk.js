(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["118"],{"1593":function(e,t,n){"use strict";var r=n(0),i=n(1440),s=n(18),o=n(109),u=n("knockout-lib"),a=(function(){function e(e){var t=this,n=e.noTitle,r=void 0!==n&&n,i=e.title,s=void 0===i?u.observable(""):i,a=e.elementDescribedBy,f=void 0===a?"":a,l=e.hasCommandBar,c=void 0!==l&&l,h=e.size,p=void 0===h?"Small":h,d=e.scrollMode,v=void 0===d?"auto":d,m=e.showCloseButton,g=void 0===m||m,y=e.includePadding,b=void 0===y||y,w=e.preserveLightDismiss,E=void 0!==w&&w,S=e.stickyCloseButton,x=void 0!==S&&S,T=e.component,N=void 0===T?null:T,C=e.maximizePanelContent,k=void 0!==C&&C,L=e.panelContentSize,A=void 0===L?u.observable({width:0,height:0}):L,O=e.isBlocking,M=e.disableEscape,_=void 0!==M&&M,D=e.overridePanelStyle;this.size=p;this.title=u.isObservable(s)?s:u.observable(s);this.elementDescribedBy=f;this.maximizePanelContent=k;this.panelContentSize=A;this.noTitle=r;this.hasCommandBar=c;this.component=N;this.scrollMode=v;this.showCloseButton=g;this.includePadding=b;this.preserveLightDismiss=E;this.stickyCloseButton=x;this.isBlocking=O;this.disableEscape=_;this.overridePanelStyle=D;this.state=u.observable(0);this._promise=new o.n(function(e){var n=u.computed(function(){if(1===t.state()){e(!0);n.dispose()}},t)})}e.prototype.wait=function(){return this._promise};return e})(),f=n(1489);n.d(t,"e",function(){return c});var l=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.currentPanels=r.observables.createArray();r._needsOverlayContent=n.needsOverlayContent;return r}t.prototype.requestPanel=function(e){this._needsOverlayContent.needsOverlayContent(!0);var t=new a(e),n=this.currentPanels;n.push(t);var r=function(){return n.remove(t)};t.wait().then(r,r);return t};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{needsOverlayContent:f.e});return t})(i.n),c=Object(s.s)("PanelProvider",l)},"2023":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=String.fromCharCode(9)},"2072":function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return u});n.d(t,"r",function(){return a});n.d(t,"o",function(){return l});n.d(t,"u",function(){return c});n.d(t,"s",function(){return h});n.d(t,"i",function(){return p});n.d(t,"l",function(){return d});n.d(t,"h",function(){return v});n.d(t,"c",function(){return m});n.d(t,"f",function(){return g});n.d(t,"a",function(){return y});n.d(t,"t",function(){return b});n(2023);var r=n(2073);function i(e){return o("https://"+w()+s()+"/redir?resid="+e)}function s(){return 1===Object(r.e)()?"storage.live-int.com":"onedrive.live.com"}function o(e){return"u!"+window.btoa(e).replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_")}function u(e){void 0===e&&(e="v1.0");return"https://"+w()+(1===Object(r.e)()?"storage.live-int.com":"api.onedrive.com")+"/"+e}function a(){return"/picker/accountchooser"===document.location.pathname.toLowerCase()}function f(e){return"photos"===e.v}function l(e){return"places"===e.id&&f(e)}function c(e){return"tags"===e.id&&f(e)}function h(e){return"allmyphotos"===e.qt||"allmyphotos"===e.parQt}function p(e){return"albums"===e.id&&f(e)}function d(e){return!!e.id&&"albums"!==e.id&&"tags"!==e.id&&"places"!==e.id&&!!e.cid&&f(e)&&!h(e)}function v(e){return h(e)&&!!e.tagFilter&&f(e)}function m(e){return!!e.locationFilter&&f(e)}function g(e){return!!e.onThisDay&&f(e)}function y(e){return"FilePickerView"===e.v&&"allmyphotos"===e.qt}function b(e){var t=e.id;if(t){var n=t.indexOf("!");if(n>-1)return t.slice(0,n)}}function w(){switch(Object(r.e)()){case 2:return"soak2.test.";case 3:return"soak3.test.";case 1:return"newapi.dev.";default:return""}}},"2073":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=window.FilesConfig&&window.FilesConfig.env;function i(){switch(r&&r.toLowerCase()){case"soak3":return 3;case"soak2":return 2;case"dev":return 1;default:return 0}}},"2979":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(71),i=n(10),s=window&&window.FilesConfig||{};s.skyDrivePickerOAuth||(s.skyDrivePickerOAuth="oauth");!s.oauthToken&&window&&(s.oauthToken=new r.default(window.location.href).getQueryParameter("access_token"));var o=s,u=window&&window.$Config||{};new i.t({name:"Config.files",factory:new i.e(o)}),new i.t({name:"Config.config",factory:new i.e(u)})},"3129":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(109),i=n(47),s=n(18),o=n(325),u=(function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)};e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?r.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.e.Success}}):r.n.resolve({resultType:i.e.Success})};return e})(),a=Object(s.s)("ItemRedeemer",u,{ticketRedeemer:o.ve.async.optional})},"3161":function(e,t,n){"use strict";n.d(t,"l",function(){return c});n.d(t,"n",function(){return h});n.d(t,"r",function(){return p});n.d(t,"t",function(){return d});n.d(t,"i",function(){return v});n.d(t,"o",function(){return m});n.d(t,"s",function(){return g});n.d(t,"u",function(){return y});n.d(t,"f",function(){return b});n.d(t,"e",function(){return w});n.d(t,"a",function(){return E});var r=n(0),i=n(274),s=n(2979),o=n(24),u=n(644),a=n(44),f=n(2072),l=n(786),c=s.e&&"UnAuth"!==s.e.hcid&&s.e.hcid||"";function h(e){var t;void 0===e&&(e={});var n=((t={}).id=e.id||"root",t.cid=e.cid||c,t.groupId=e.groupId||"",t.qt=(""+(e.qt||"")).toLowerCase(),t.did=e.did||"",t.q=e.q||"",t.sft=e.sft||"",t.beginDate=e.beginDate||"",t.endDate=e.endDate||"",t.ft=e.ft||"",t.ext=e.ext||"",t.df=e.df||"",t.sp=e.sp||"",t.ocid=e.ocid||"",t["WT.mc_id"]=e["WT.mc_id"]||"",t.locationFilter=e.locationFilter||"",t.tagFilter=e.tagFilter||"",t.onThisDay=e.onThisDay||"",t.sc=e.sc||"",t.startDate=e.startDate||"",t.internalPath=e.internalPath||"",t.u=e.u||"",t.searchsessionid=e.searchsessionid||"",t);return i.t(n,void 0,!0)}function p(e){return i.e(e)}function d(e){var t=Object(r.__assign)({},e);if(t.parId||t.parQt||t.parCid){delete t.id;delete t.qt;delete t.internalPath;if(t.parId){t.id=t.parId;delete t.parId}if(t.parQt){t.qt=t.parQt;delete t.parQt}if(t.parCid){t.cid=t.parCid;delete t.parCid}}delete t.u;return h(t)}function v(e){var t;switch(e.v){case"1":case"FolderPickerView":case"2":case"FilePickerView":case"pickerconsent":t=a.e.FilePicker;break;case"3":t=a.e.Files;break;case"photos":t=a.e.Photos;break;case"managestorage":t=a.e.StorageInfo;break;case"photopreferences":t=a.e.PhotoPreferences;break;case"error":t=a.e.Error;break;case"RansomwareDetection":t=a.e.RansomwareDetection;break;case"winphonebackup":t=a.e.WinPhoneBackup;break;case"syncplaceholders":t=a.e.SyncPlaceholders;break;case"upgrade":t=a.e.StorageOptions;break;case"restore":t=a.e.Restore;break;case"appdata":t=a.e.AppData;break;case"TextFileEditor":t=a.e.TextFileEditor;break;case"syncpremiumupsell":t=a.e.SyncOnboarding;break;case"validatepermission":t=a.e.ValidatePermission;break;case"requestaccess":t=a.e.RequestAccess;break;case"unlock":t=a.e.Unlock;break;case"ManageVault":t=a.e.ManageVault;break;case"traceme":t=a.e.TraceMe;break;default:t=Object(f.r)()?a.e.AccountChooser:a.e.Files}return t}function m(e){var t;switch(p(d(e)).qt){case"mru":t=o.e.Recent;break;case"recyclebin":t=o.e.RecycleBin;break;case"sharedby":t=o.e.SharedWithMe;break;case"sharedbyme":t=o.e.SharedByMe;break;case"search":t=o.e.Search;break;case"allmyphotos":t=o.e.AllMyPhotos;break;default:t=Object(f.o)(e)||Object(f.u)(e)?o.e.AllMyPhotos:Object(f.r)()?"false"===e.load_login?o.e.AccountChooserMobileSDK:o.e.AccountChooserPicker:o.e.Files}return t}function g(e){return"photos"===e.v&&Object(u.e)(m(e))?0:Object(l.isFeatureEnabled)(l.EnableTagsInODC)&&Object(f.u)(e)?2:Object(f.h)(e)?6:Object(f.o)(e)?3:Object(f.c)(e)?7:Object(f.f)(e)?9:Object(f.s)(e)?0:Object(f.i)(e)?1:Object(f.l)(e)?5:"photos"===e.v?0:null}function y(e){var t,n;void 0===e&&(e=o.e.Files);var r=((t={})[o.e.Files]="",t[o.e.Recent]="mru",t[o.e.SharedWithMe]="sharedby",t[o.e.SharedByMe]="sharedbyme",t[o.e.RecycleBin]="recyclebin",t[o.e.AllMyPhotos]="allmyphotos",t);return h(((n={}).qt=r[e],n))}function b(e){return!("sharedby"!==e.qt&&w(e)||E(e))}function w(e){var t=e.cid;return!t||t===c}function E(e){return Object(f.s)(e)||Object(f.i)(e)||Object(f.l)(e)||Object(f.u)(e)||Object(f.o)(e)||Object(f.f)(e)}},"3577":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1440),s=n(3129),o=n(109),u=n(786),a=n(47),f=n(3161),l=n(1593),c=n(1447),h=n(1699),p=n(325),d=n(787),v=n(1455),m=n(1462),g=n(687),y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(p.me);n._panelProvider=n.resources.consume(l.e);n._engagement=n.resources.consume(c.e);n._actionMap=n.resources.consume(d.e);n._selectionHelper=new(n.child(m.e))({canFallback:!1,allowMultiSelect:!0});return n}t.prototype.launchPanel=function(e,t){return Object(r.__awaiter)(this,void 0,o.n,function(){var i,s,o,f,l,c,h,p,d,m,y,b,w,E,S,x=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:this._logEngagement(e,t);i=this._selectionHelper.currentItem.peek();s=this.observables.create({items:e,parentKey:i.key,targetId:null,targetKey:null,cid:this._urlDataSource.getOwnerId(),group:i.isGroup?1:0,isAsync:!1,isMove:t});o=t?v.e.moveItemDialogTitle:v.e.copyItemDialogTitle;f=t?v.e.moveItemsDialogTitle:v.e.copyItemsDialogTitle;l=1===e.length?o:f;c=Object(u.isFeatureEnabled)(u.MoveCopyFolderSelectionUX);h=Object(u.isFeatureEnabled)(u.EnableModernMoveCopyPicker);p=h?"Action.LaunchMoveCopyPanel.ModernMoveCopyPicker":c?"Action.LaunchMoveCopyPanel.UseFolderSelectUX":"Action.LaunchMoveCopyPanel.UseFolderTreeUX";d={name:p+=t?".Move":".Copy",extraData:{ItemCount:null!==e?e.length:0}};this._engagement.logData(d);Object(g.n)(d);m={context:s,onComplete:function(){S.state(1)},isMove:t};y=h?{title:l,itemKey:i.key,isMove:t,cancel:function(){S.state(1)},complete:function(e){s().targetKey=e?e[0].key:void 0;s().targetId=e?x._getTargetId(e[0]):void 0;new(x.managed(x._actionMap.MoveCopyAction))(m).execute({})}}:{context:s,onComplete:function(){S.state(1)},title:l,resources:this.resources};return h?[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("484")]).then(n.bind(null,4054))]:[3,2];case 1:w=r.sent().default.tagName;return[3,7];case 2:return c?[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("385")]).then(n.bind(null,4044))]:[3,4];case 3:E=r.sent().default.tagName;return[3,6];case 4:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("386")]).then(n.bind(null,4052))];case 5:E=r.sent().default.tagName;r.label=6;case 6:w=E;r.label=7;case 7:b=w;return[2,(S=this._panelProvider.requestPanel({hasCommandBar:!c,scrollMode:c?"hidden":"auto",noTitle:!0,title:l,showCloseButton:!h,component:{name:b,params:y}})).wait().then(function(){return{resultType:a.e.Success}})]}})})};t.prototype._getTargetId=function(e){return Object(f.r)(e.key).id};t.prototype._logEngagement=function(e,t){var n=this._engagement,r=e.filter(function(e){return h.e.isShortcutItem(e)}).length;r>0&&(t?n.logData({name:"ShortcutLink.MoveInitiateAggregate",extraData:{count:r}}):n.logData({name:"ShortcutLink.CopyInitiateAggregate",extraData:{count:r}}))};return t})(i.n),b=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.name=t.actionName;n._isMove=t.isMove;n._selectionHelper=t.selectionHelper;n._itemReedemer=n.resources.consume(s.e);n._launchMoveCopyPanelHelper=new(n.managed(y));return n}t.prototype.execute=function(){var e=this;return this._selectionHelper.resolveSelection().then(function(t){return e._itemReedemer.redeemItems(t,e).then(function(){return e._launchMoveCopyPanelHelper.launchPanel(t,e._isMove)})})};return t})(i.n);t.default=b}}]);