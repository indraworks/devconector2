(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["383"],{"2002":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r="ListsAction"},"4127":function(e,t,n){"use strict";n.r(t);var r={};n.r(r);n.d(r,"NPSCampaignProd",function(){return y});n.d(r,"NPSCampaignDogfood",function(){return b});n.d(r,"NPSCampaignForceNomination",function(){return w});n.d(r,"NPSCampaignDebugForSPO",function(){return E});n.d(r,"NPSCampaignForSPO",function(){return S});n.d(r,"NPSCampaignForLists",function(){return T});n.d(r,"NPSCampaignForListsDebug",function(){return N});n.d(r,"NPSSuiteSurvey",function(){return C});n.d(r,"AllPhotosFPSSurvey",function(){return k});n.d(r,"ODBDarkModeFPSSurvey",function(){return L});n.d(r,"ODBMoveFPSSurvey",function(){return A});n.d(r,"ODBCopyFPSSurvey",function(){return O});n.d(r,"ODCMoveFPSSurvey",function(){return M});n.d(r,"ODCCopyFPSSurvey",function(){return _});var i=n(0),s=n(127);Object(s.n)([{rawString:"#obf-TPromptContainer:focus{outline:1px solid "},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#obf-ToastContainer{background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:";border:1px solid "},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}#obf-ToastContainer #obf-TFormComment{background-color:"},{theme:"menuBackground",defaultValue:"#ffffff"},{rawString:"}#obf-ToastContainer #obf-TFormTitle,#obf-ToastContainer #obf-TPromptTitle{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon>span{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input[type=radio]:checked+label>.obf-ChoiceGroupIcon{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}#obf-ToastContainer #obf-TFormRating,#obf-ToastContainer #obf-TPromptText,#obf-ToastContainer #obf-ToastCancel svg path{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";fill:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}#obf-ToastContainer .obf-Link{color:"},{theme:"themeDark",defaultValue:"#005a9e"},{rawString:"}#obf-ToastContainer .obf-TextInput{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}#obf-ToastContainer .obf-TextInput::placeholder{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}#obf-ToastContainer .obf-Link:focus,#obf-ToastContainer .obf-SubmitButton:focus{outline-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}#obf-ToastContainer .obf-ChoiceGroup input:focus+label{outline-color:"},{theme:"black",defaultValue:"#000000"},{rawString:"}#obf-ToastContainer .obf-SubmitButton[disabled],#obf-ToastContainer .obf-SubmitButton[disabled]:active,#obf-ToastContainer .obf-SubmitButton[disabled]:focus,#obf-ToastContainer .obf-SubmitButton[disabled]:hover{background-color:"},{theme:"neutralQuaternaryAlt",defaultValue:"#e1dfdd"},{rawString:";color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}"}]);var o=n(1440),u=n(97),a=n(47),f=n(1447),l=n(382),c=n(272),h=n(3356),p=n(1532),d=n(3689),v=n(2002),m={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.FeedbackPromptPrimary,Question:d.e.FeedbackPromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.NPSQuestion,RatingValuesAscending:[d.e.SurveyResponse1,"2","3","4",d.e.SurveyResponse5]},Question:{Question:d.e.CommentsBoxText}}},g={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SPListAction",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.FeedbackPromptPrimary,Question:d.e.FeedbackPromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.NPSQuestionForSPO,RatingValuesAscending:[d.e.SurveyResponse1,"2","3","4",d.e.SurveyResponse5]},Question:{Question:d.e.CommentsBoxTextForSPO}}},y={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:m},b={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},w={CampaignId:"520978bb-a341-4304-8733-25b60ca048a5",StartTimeUtc:"2018-11-29T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3}},SurveyTemplate:m},E={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:g},S={CampaignId:"a546f732-aac7-49d2-9da5-9a55220505a0",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:g},x={Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:v.e,Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.FeedbackPromptPrimaryLists,Question:d.e.FeedbackPromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.NPSQuestionForLists,RatingValuesAscending:[d.e.SurveyResponse1,"2","3","4",d.e.SurveyResponse5]},Question:{Question:d.e.CommentsBoxTextLists}}},T={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:6,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:x},N={CampaignId:"d443d624-9997-4028-98d0-a990cd23631f",StartTimeUtc:"2020-09-17T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:x},C={CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-03-21T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MeaningfulNpsAction",Count:1,IsAggregate:!0},{Type:0,Activity:"NewNpsSession",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.FeedbackPromptPrimary,Question:d.e.FeedbackPromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.M365SuiteNpsQuestion,RatingValuesAscending:[d.e.SurveyResponse1,"2","3","4",d.e.SurveyResponse5]},Question:{Question:d.e.M365SuiteNpsCommentBox}}}},k={CampaignId:"f603ed6a-6f11-4e88-8f4d-7050fda6a676",StartTimeUtc:"2019-10-10T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"EnteredAllPhotosView",Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.AllPhotosFpsPrimaryHeader,Question:d.e.FeedbackPromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.AllPhotosPrimaryQuestion,RatingValuesAscending:[d.e.AllPhotosResponse1,"2","3","4",d.e.AllPhotosResponse5]},Question:{Question:d.e.AllPhotosSecondaryQuestion}}}},L={CampaignId:"b62950b8-1449-423c-b06f-6f2cb8444ec3",StartTimeUtc:"2020-10-20T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBDarkModeOnPageLoad",Count:2,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.DarkModePromptPrimary,Question:d.e.DarkModePromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.DarkModePrimaryQuestion,RatingValuesAscending:[d.e.AllPhotosResponse1,"2","3","4",d.e.AllPhotosResponse5]},Question:{Question:d.e.DarkModeCommentBox}}}},A={CampaignId:"e9808919-b9be-44a7-85fa-2a11dbf35d41",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.MovePromptPrimary,Question:d.e.MovePromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.MovePrimaryQuestion,RatingValuesAscending:[d.e.AllPhotosResponse1,"2","3","4",d.e.AllPhotosResponse5]},Question:{Question:d.e.MoveCommentBox}}}},O={CampaignId:"bf829135-ea3a-43e7-8592-6d62259a0a92",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODBCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.CopyPromptPrimary,Question:d.e.CopyPromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.CopyPrimaryQuestion,RatingValuesAscending:[d.e.AllPhotosResponse1,"2","3","4",d.e.AllPhotosResponse5]},Question:{Question:d.e.CopyCommentBox}}}},M={CampaignId:"54eeb279-6ab7-4f26-880c-0643d3d60e53",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCMoveActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.MovePromptPrimary,Question:d.e.MovePromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.MovePrimaryQuestion,RatingValuesAscending:[d.e.AllPhotosResponse1,"2","3","4",d.e.AllPhotosResponse5]},Question:{Question:d.e.MoveCommentBox}}}},_={CampaignId:"ffd1b867-3ee8-4ca9-a04c-2467930dfc54",StartTimeUtc:"2020-12-30T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ODCCopyActionTrigger",Count:1,IsAggregate:!0}]},Content:{Prompt:{Title:d.e.CopyPromptPrimary,Question:d.e.CopyPromptSecondary,YesLabel:d.e.YesLabel,NoLabel:d.e.NoLabel},Rating:{Question:d.e.CopyPrimaryQuestion,RatingValuesAscending:[d.e.AllPhotosResponse1,"2","3","4",d.e.AllPhotosResponse5]},Question:{Question:d.e.CopyCommentBox}}}},D=n(687),P=n(786),H=n(484),B=n(18),j=n(69),F=n(128),I=n(943),q=n(28),R=n(88);n.d(t,"FloodgateDataSource",function(){return U});n.d(t,"resourceKey",function(){return z});var U=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._engagement=n.engagement;r._userInfoProvider=n.userInfoProvider;r._platformDetection=n.platformDetection;r._sessionId=F.default.generate();r._appId=n.appId;r._pageContext=n.pageContext;r._isItemsScopeEnabledInAllPhotosPivotResource=n.isItemsScopeEnabledInAllPhotosPivotResource;r._onSurveyActivated=function(e){var t=e.survey.surveyInfo.data.backEndIdentifier,n=r._pageContext&&r._pageContext.isSPO;r._userInfoProvider.getSurveyStatusUserFact(t,n,!0).then(function(i){if(i.activated){for(var s=!1,o=0,u=r._campaignDefinitions;o<u.length;o++){var a=u[o];if(a.CampaignId===t){var f=1e3*a.NominationScheme.CooldownPeriod.IntervalSeconds;s=(new Date).getTime()>i.dateLastModified.getTime()+f}}if(!s){r._engagement.logData({name:"Floodgate.SurveyBlockedByUserFact",extraData:{id:t},isIntentional:!0});return}}r._ratingComponent=e.survey&&e.survey.getRatingComponent&&e.survey.getRatingComponent();e.launch();var l={activated:!0,dateLastModified:new Date};!R.e.isActivated("069E3BF0-5DF9-4305-A165-C4280E18F2DE","10/26/20","Skip setSurveyStatus SPO")&&n?r._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t},isIntentional:!0}):r._userInfoProvider.setSurveyStatusUserFact(t,l).then(function(e){r._engagement.logData({name:"Floodgate.SurveyShown",extraData:{id:t,userFactUpdated:e},isIntentional:!0})})})};r._onSurveyDismissed=function(e,t){var n=new u.e({name:"Floodgate.SurveyCompleted"});if(t){var i=r._getEngine();if(i){var s=i.launchedSurveys,o=-1;for(var f in s)s[f].surveyInfo.data.backEndIdentifier===e&&(o=s[f].rating.selectedIndex+1);n.end({extraMetrics:{surveyResponse:o,sessionId:r._sessionId},resultType:a.e.Success});r._engagement.logData({name:"Floodgate.SurveySubmitted",extraData:{id:e,response:o,sessionId:r._sessionId},isIntentional:!0})}if(r._pageContext&&r._pageContext.isSPO&&r._ratingComponent&&r._ratingComponent.getSelectedRating){var l=r._ratingComponent.getSelectedRating();-1!==l.indexOf("5")?r._engagement.logData({name:"SharePointNPSPromoter",extraData:{rating:l}}):-1===l.indexOf("1")&&-1===l.indexOf("2")&&-1===l.indexOf("3")||r._engagement.logData({name:"SharePointNPSDetractor",extraData:{rating:l}})}}else{n.end({resultCode:"SurveyClosed",resultType:a.e.ExpectedFailure});r._engagement.logData({name:"Floodgate.SurveyClosed",isIntentional:!0})}};r._campaignDefinitions=[];if(t.customCampaignDefinitions)r._campaignDefinitions=t.customCampaignDefinitions;else{r._campaignDefinitions=[];var i=r._getActiveOneDriveNpsCampaign();i&&r._campaignDefinitions.push(i);if(r._pageContext&&r._pageContext.isSPO){var s=r._pageContext.farmName&&r._pageContext.farmName.indexOf("MSIT_SPDF")>-1,o=Object(P.isFeatureEnabled)(P.NPSCampaignForLists);if(s){r._campaignDefinitions.push(E);o&&r._campaignDefinitions.push(N)}else{r._campaignDefinitions.push(S);o&&r._campaignDefinitions.push(T)}}Object(P.isFeatureEnabled)(P.AllPhotosFpsCampaign)&&r._campaignDefinitions.push(k);P.IsODBWebApp.ODB&&Object(P.isFeatureEnabled)(P.ODBDarkMode)&&r._campaignDefinitions.push(L);if(Object(P.isFeatureEnabled)(P.FPSMoveCopy)){r._campaignDefinitions.push(A);r._campaignDefinitions.push(O);r._campaignDefinitions.push(M);r._campaignDefinitions.push(_)}r._userInfoProvider.getIsPremium(!1).then(function(e){r._isPremium=e;e&&Object(P.isFeatureEnabled)(P.NPSSuiteSurvey)&&r._campaignDefinitions.push(C)})}return r}t.prototype.recordUserAction=function(e,t){var n=this;this.waitForFloodgateInit().then(function(){var t=n._getEngine();t&&t.getActivityListener().logActivity(e)})};t.prototype.waitForFloodgateInit=function(){this._initPromise||(this._initPromise=this._initFloodgate());return this._initPromise};t.prototype.processViewParams=function(e){e.resetAllSurveyStatuses&&this._resetAllSurveyStatuses();var t=e.resetSurveyStatusById;t&&this._resetSurveyStatusByCampaignId(t);if(Object(P.isFeatureEnabled)(P.NPSCampaignForLists)){"createList"===e.origin&&this.recordUserAction(v.e)}};t.prototype._initFloodgate=function(){var e=this;return n.e("1").then(n.t.bind(null,4012,7)).then(function(){var t=new u.e({name:"Floodgate.Initialized"});if(!window.OfficeBrowserFeedback||!window.OfficeBrowserFeedback.floodgate){t.end({resultCode:"FloodgateNotLoaded",resultType:a.e.ExpectedFailure,extraData:{error:"Floodgate SDK not loaded."}});e._engagement.logData({name:"Floodgate.SdkNotLoaded",extraData:{error:"Floodgate SDK not loaded."}});return Promise.resolve()}try{localStorage.setItem("test","test");localStorage.removeItem("test")}catch(n){t.end({resultCode:"LocalStorageDisabled",resultType:a.e.ExpectedFailure,extraData:{error:"Local storage not enabled."}});e._engagement.logData({name:"Floodgate.LocalStorageNotEnabled",extraData:{error:"Local storage not enabled."}});return Promise.resolve()}window.OfficeBrowserFeedback.initOptions={appId:e._appId,stylesUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/styles/officebrowserfeedback.css"),intlUrl:window.require.toUrl("@ms-ofb/officebrowserfeedback/intl")+"/",environment:e._computeCurrentEnvironment(),sessionId:e._sessionId,locale:H.default.language,primaryColour:I.n.themePrimary,secondaryColour:I.n.themeSecondary,build:e._computeBuildVersion()};var n={newAllPhotosExperience:e._isItemsScopeEnabledInAllPhotosPivotResource,isPremium:e._isPremium},r=Object(D.t)();r&&(n=Object(i.__assign)(Object(i.__assign)({},n),{lastActionBeforeNPSSurvey:Object(D.e)(r.actionName),extension:r.extension,objectType:r.objectType,currentPage:r.currentPage}));window.OfficeBrowserFeedback.initOptions.applicationGroup={appData:JSON.stringify(n)};var s=window.FilesConfig&&window.FilesConfig.df;e._pageContext&&e._pageContext.isSPO&&(s=e._pageContext.farmName.indexOf("MSIT_SPDF")>-1);window.OfficeBrowserFeedback.initOptions.telemetryGroup={audienceGroup:s?"Dogfood":"Production",officeUILang:e._computeLanguage()};e._pageContext&&e._pageContext.isSPO&&e._pageContext.aadTenantId?window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId=e._pageContext.aadTenantId:window.OfficeBrowserFeedback.initOptions.telemetryGroup.tenantId="00000000-0000-0000-0000-000000000000";e._pageContext&&e._pageContext.isSPO&&void 0!==e._pageContext.listBaseType&&(Object(q.r)(e._pageContext.listBaseType)?window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="Libraries":window.OfficeBrowserFeedback.initOptions.telemetryGroup.featureArea="List");if(e._platformDetection){window.OfficeBrowserFeedback.initOptions.telemetryGroup.platform=e._platformDetection.osName;window.OfficeBrowserFeedback.initOptions.webGroup={browser:e._platformDetection.browserName}}window.OfficeBrowserFeedback.initOptions.telemetryGroup.channel="CC";window.OfficeBrowserFeedback.floodgate.initOptions={campaignDefinitions:e._campaignDefinitions,onDismiss:e._onSurveyDismissed,onSurveyActivatedCallback:{onSurveyActivated:e._onSurveyActivated}};return window.OfficeBrowserFeedback.floodgate.initialize().then(function(){return window.OfficeBrowserFeedback.floodgate.start().then(function(){var n=e._getEngine();if(!n)throw"Floodgate engine initialization failed silently.";n.getActivityListener().logActivityStartTime("AppUsageTime");e._setupEventListeners();t.end({resultType:a.e.Success});e._engagement.logData({name:"Floodgate.Initialized"})})}).catch(function(n){t.end({resultCode:"FloodgateInitializationFailure",resultType:a.e.Failure});e._engagement.logData({name:"Floodgate.FailedToInitialize",extraData:{error:n}})})})};t.prototype._getActiveOneDriveNpsCampaign=function(){return Object(P.isFeatureEnabled)(P.NPSCampaignForceNomination)?w:Object(P.isFeatureEnabled)(P.NPSCampaignDogfood)?b:y};t.prototype._getEngine=function(){if(window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate)return window.OfficeBrowserFeedback.floodgate.getEngine()};t.prototype._computeCurrentEnvironment=function(){0;return 0};t.prototype._computeBuildVersion=function(){var e=R.e.isActivated("92557910-4C5C-4204-8F39-A11BF1AD085E","10/26/20","STS regex"),t=window._spModuleLink&&window._spModuleLink.buildNumber||window.Flight&&window.Flight.version;if(t){var n=e?t.match(/\d{4}-\d{2}-\d{2}(-sts)?_\d{8}\.\d{3}/):t.match(/\d{4}-\d{2}-\d{2}_\d{8}\.\d{3}/);if(n)return n[0].replace(/-/g,"").replace("_",".")}};t.prototype._computeLanguage=function(){if(this._pageContext){if(this._pageContext.currentCultureLCID)return this._pageContext.currentCultureLCID;if(this._pageContext.currentLanguage)return this._pageContext.currentLanguage}else if($Config&&$Config.langPref)return $Config.langPref};t.prototype._setupEventListeners=function(){var e=this,t=this._getEngine();this.events.on(window,"blur",function(){if(t){t.getActivityListener().logActivityStopTime("AppUsageTime");window.OfficeBrowserFeedback.floodgate.stop()}});this.events.on(window,"unload",function(){if(t){t.getActivityListener().logActivityStopTime("AppUsageTime");window.OfficeBrowserFeedback.floodgate.stop()}});this.events.on(window,"focus",function(){window.OfficeBrowserFeedback&&window.OfficeBrowserFeedback.floodgate&&window.OfficeBrowserFeedback.floodgate.start().then(function(){window.OfficeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivityStartTime("AppUsageTime")}).catch(function(t){e._engagement.logData({name:"Floodgate.FailedToReinitialize",extraData:{error:t}})})})};t.prototype._resetSurveyStatusByCampaignId=function(e){this._userInfoProvider.setSurveyStatusUserFact(e,{activated:!1,dateLastModified:new Date}).then(function(t){t&&console.log("UserFact successfully reset: "+e)})};t.prototype._resetAllSurveyStatuses=function(){var e=new Set;for(var t in r){var n=r[t];if(!e.has(n.CampaignId)){e.add(n.CampaignId);this._resetSurveyStatusByCampaignId(n.CampaignId)}}};t.dependencies=Object(i.__assign)(Object(i.__assign)({},o.n.dependencies),{engagement:f.e,userInfoProvider:l.C,platformDetection:c.e,appId:h.e,pageContext:j.h.optional,isItemsScopeEnabledInAllPhotosPivotResource:p.n});return t})(o.n),z=Object(B.s)("FloodgateDataSource",U)}}]);