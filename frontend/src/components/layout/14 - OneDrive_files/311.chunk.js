(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["311"],{"4156":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(109),s=n(18),o=n(325),u=n(1510),a=n(72),f=(function(){function e(e,t){this._graphDataSource=t.graphDataSource;this._makeXHR=t.makeXHR||u.e.start}e.prototype.getContents=function(e,t){return this._makeXHR({url:t}).then(function(t){var n=t.status;if(!(n>=200&&n<300))return i.n.reject(t);try{var r=JSON.parse(t.responseText).metadata,s=r.delimiter,o=r.error,u=r.list,f=void 0===u?[]:u;return{delimiter:s,error:o,root:{children:f,date:e.dateModified,extension:e.extension,isFolder:!0,name:e.name,childCount:f.length,parentFolder:void 0,path:"",size:0}}}catch(e){return i.n.reject(new a.e({code:n+".InvalidResponse",message:e&&e.message,correlationId:l(t),isExpected:!0,extraData:{responseText:t.responseText}}))}}).catch(function(e){if(e instanceof a.e)return i.n.reject(e);var t,n=!1,r=e&&e.message,s="GetZipContents";if(e instanceof XMLHttpRequest){var o=e&&e.status;n=!!o&&o>=400&&o<500;o&&window.navigator.onLine||(n=!0);t=l(e);s=e.getResponseHeader("X-ErrorCode")||"";try{for(var u=JSON.parse(e.responseText),f=u&&u.error;f.innererror;)f=f.innererror;if(f){r=f.message;s=f.code}}catch(t){r=e.responseText?"Invalid JSON response":"Empty response";n=!0}s=o+"."+s}return i.n.reject(new a.e({code:s,message:r,isExpected:n,correlationId:t,extraData:{responseText:e instanceof XMLHttpRequest?e.responseText:""}}))})};return e})();function l(e){return e.getResponseHeader("X-CorrelationId")||void 0}Object(s.s)("ZipDataSource_1",f,{graphDataSource:o.b,makeXHR:void 0});var c=n(24),h=n(136);n.d(t,"resourceKey",function(){return d});var p=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._isOneDriveWinApp=Object(h.e)();return r}t.prototype.getContents=function(t,n){var r=this;return n?i.n.resolve().then(function(){if(t.queryType===c.e.SharedWithMe&&r._isOneDriveWinApp&&r._graphDataSource.refreshAccessToken)return r._graphDataSource.refreshAccessToken(t)}).then(function(i){var s=i&&i.accessToken;n.indexOf("access_token")<0&&s&&(n=n+"&access_token="+s);return e.prototype.getContents.call(r,t,n)}):i.n.reject(new Error("No data."))};return t})(f),d=(t.default=p,Object(s.s)("ZipDataSource",p,{graphDataSource:o.b,makeXHR:void 0}))}}]);