(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["415"],{"1454":function(e,t,n){"use strict";var r=n(0),i=n(1601),s=n(1796),o=n(1440),u=n(325),a=n(109),f=n(90),l=n(44),c=n(24),h=n(47),p=n(382),d=n(1447),v=n(72),m=n(12),g=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="BaseAction";var i=r,s=i.resources,o=i.observables,a=n.urlDataSource,f=void 0===a?s.consume(u.me.optional):a,l=n.instrumentationProvider,c=void 0===l?s.consume(p.u.optional):l;r._BaseAction_urlDataSource=f;r._BaseAction_instrumentationProvider=c;r.isQosLogged=!0;r.logStartEnd=!1;r._executingInstanceCount=o.create(0);var h={deferEvaluation:!0};r.isAvailable=o.pureCompute(r._computeIsAvailable,h);r.isToggled=o.pureCompute(r._computeIsToggled,h);r.isExecuting=o.pureCompute(r._computeIsExecuting,h);return r}t.prototype.execute=function(e){var t,n,r=this,i=this.isQosLogged?this.onCreateQosEvent(e):void 0,s=i&&!m.e.isActivated("E25DF3CA-AF06-4063-A8AE-BC792E58E3BB","5/7/2020","Obtain Engagement before launching action")?this.getEngagement():void 0,o=!m.e.isActivated("14943A66-AD8E-448D-84E4-A073B4A2EB23","5/21/2020","Log engagement before executing action");try{if(i&&o){this._logEngagementEvent(i.data.extraData,s);this.trackUserAction(this.name)}if(!(t=this.onExecute(e,i)))throw new Error("Action did not return a promise")}catch(e){f.default.log(e);n=e}if(t){this._executingInstanceCount(this._executingInstanceCount.peek()+1);t.then(function(e){r._executingInstanceCount(r._executingInstanceCount.peek()-1);if(i){if(!o){r._logEngagementEvent(i.data.extraData,s);r.trackUserAction(r.name)}i.end(e)}},function(t){r._executingInstanceCount(r._executingInstanceCount.peek()-1);t&&!a.n.isCanceled(t)&&f.default.log(t);if(i){o||r._logEngagementEvent(i.data.extraData,s);i.end(r.onCreateErrorEventArg(e,t,!1))}})}else{i&&i.end(this.onCreateErrorEventArg(e,n,!0));t=a.n.reject(n)}return t};t.prototype.onCreateQosEvent=function(e){var t=this._BaseAction_urlDataSource;return new i.e({name:this.name,pageType:t&&l.e[t.getPageType()]||"",queryType:t&&c.e[t.getQueryType()]||"",logStartEnd:this.logStartEnd})};t.prototype.onCreateErrorEventArg=function(e,t,n){return t&&a.n.isCanceled(t)?{resultType:h.e.ExpectedFailure,resultCode:"Canceled"}:t instanceof v.e?{resultType:t.isExpected?h.e.ExpectedFailure:h.e.Failure,resultCode:t.code,error:t.message,extraData:{CorrelationId:t.correlationId}}:{resultType:h.e.Failure,resultCode:n?"NoPromiseReturned":"PromiseFailed",error:t?""+(t.message||""):void 0}};t.prototype.onExecute=function(e,t){var n={resultType:h.e.Failure};return a.n.resolve(n)};t.prototype.onIsAvailable=function(){return!0};t.prototype.onIsToggled=function(){return!1};t.prototype.getEngagement=function(){return this.resources.consume(d.e)};t.prototype.trackUserAction=function(e){var t=this._BaseAction_instrumentationProvider;if(t){var n=this.getEngagement();t.userExecuteAction({name:e,engagement:n})}};t.prototype._computeIsAvailable=function(){return!!this.onIsAvailable()};t.prototype._computeIsToggled=function(){return!!this.onIsToggled()};t.prototype._computeIsExecuting=function(){return this._executingInstanceCount()>0};t.prototype._logEngagementEvent=function(e,t){void 0===t&&(t=this.isQosLogged?this.getEngagement():void 0);if(t){var n=this._BaseAction_instrumentationProvider;t.logData({name:this.name,isIntentional:this.isExecutionIntentional,location:"NA",usageType:s.e[s.e.Click],currentPage:n&&n.currentPageName()||"NA",previousPage:n&&n.previousPageName()||"NA",extraData:Object(r.__assign)(Object(r.__assign)({},e||{}),n&&n.getEngagementData()||{})})}};t.dependencies=Object(r.__assign)(Object(r.__assign)({},o.n.dependencies),{urlDataSource:u.me,instrumentationProvider:p.u.optional});return t})(o.n);t.e=g},"1462":function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(109),s=n(1440),o=n(787),u=n(1579),a=n(18),f=n(1482),l=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=r,s=i.resources,a=i.observables,l=n.getCurrentItem,c=void 0===l?s.consume(o.s.lazy.optional):l,h=n.getItemSetSelectionModel,p=void 0===h?s.consume(o.N.lazy.optional):h,d=n.getSelectionHelper,v=void 0===d?s.consume(u.t.lazy.optional):d,m=t.allowMultiSelect,g=void 0!==m&&m,y=t.canFallback,b=void 0!==y&&y,w=t.ignoreSelection,E=void 0!==w&&w,S=t.overrideItem,x=t.useCurrentSelectionGroup,T=void 0!==x&&x;r._allowMultiSelect=g;r._overrideItem=S;r._ignoreSelection=E;r._useCurrentSelectionGroup=T;r._placeholder=r.observables.create(new f.e);r._getSelectionModel=p;S||(r._selectionHelper=v&&v());b&&c&&(r._fallback=c());r.selection=a.pureCompute(r._computeSelection);r.firstItem=a.pureCompute(r._computeFirstItem);r.currentItem=a.pureCompute(function(){return(c&&c()||r._placeholder)()});return r}t.prototype.filterItems=function(e){var t=this.selection();if(!t.length)return!1;for(var n=this.observables,r=0,i=t;r<i.length;r++){var s=i[r],o=n.unwrap(s);if(!o)return!0;if(!e(o))return!1}return!0};t.prototype.resolveSelection=function(){var e=this;return this._resolveSelection().then(function(t){if(t&&t.length)return t;if(e._fallback){var n=e._fallback.peek();if(n)return[n]}return[]})};t.prototype.resolveFirst=function(){var e=this;return this._resolveSelection().then(function(t){return t&&t.length?t[0]:e._fallback?e._fallback.peek():void 0})};t.prototype.selectItems=function(e){var t=this._getSelectionModel();t&&t.setSelectedKeys(e.map(function(e){return e.key}))};t.prototype.clearSelection=function(){var e=this._getSelectionModel();e&&e.clear()};t.prototype.selectAll=function(){var e=this._getSelectionModel();e&&e.selectAll()};t.prototype._computeSelection=function(){var e=this._getCurrentSelection();return!this._allowMultiSelect&&e.length>1?[]:e||[]};t.prototype._computeFirstItem=function(){var e=this.selection();return e&&e[0]&&e[0]()};t.prototype._getCurrentSelection=function(){if(this._overrideItem)return[this._overrideItem];var e,t=this._getSelectionModel();if(t){if(this._useCurrentSelectionGroup&&t.getSelectionModelGroup()){var n=t.getSelectionModelGroup().currentSelection();n&&(t=n)}e=t.selection()}else e=[];(0===e.length||this._ignoreSelection)&&this._fallback&&(e=[this._fallback]);return e};t.prototype._resolveSelection=function(){var e=this;if(this._overrideItem)return i.n.resolve([this._overrideItem.peek()]);var t=this.observables.ignore(function(){return e._computeSelection()});if(this._ignoreSelection||!t.length)return i.n.resolve([]);var n=this._selectionHelper;return n?n.resolveSelection():i.n.reject(new Error("Unable to resolve selection."))};return t})(s.n),c=Object(a.o)("ItemSelectionHelper",l,Object(r.__assign)(Object(r.__assign)({},s.n.dependencies),{currentItem:o.s.lazy.optional,itemSetSelectionModel:o.N.lazy.optional,selectionHelper:u.t.lazy.optional}))},"1487":function(e,t,n){"use strict";n.d(t,"o",function(){return a});n.d(t,"t",function(){return f});n.d(t,"i",function(){return l});n.d(t,"s",function(){return c});n.d(t,"e",function(){return r});n.d(t,"r",function(){return i});n.d(t,"n",function(){return h});var r,i,s,o,u=n(10),a=new u.t("sortManager"),f=new u.t("dataManager"),l=new u.t("listViewContextMenuCommandSet"),c=(new u.t("topCommandSet"),new u.t("listViewContextMenuHelper"));new u.t("fileContent"),new u.t("contentRange"),new u.t("error");(function(e){(function(e){e.isLeftNavClosing=new u.t("base.leftNav.isLeftNavClosing");e.isLeftNavVisible=new u.t("base.leftNav.isLeftNavVisible");e.hideLeftNav=new u.t("base.leftNav.hideLeftNav");e.isLeftNavUserExpanded=new u.t("base.leftNav.isLeftNavUserExpanded");e.toggleIsLeftNavUserExpanded=new u.t("base.leftNav.toggleIsLeftNavUserExpanded")})(e.leftNav||(e.leftNav={}));(function(e){e.context=new u.t("base.suiteNav.context");e.isTopBarVisible=new u.t("base.suiteNav.isTopBarVisible");e.isTopBarHamburgerVisible=new u.t("base.suiteNav.isTopBarHamburgerVisible");e.isSuiteNavHamburgerVisible=new u.t("base.suiteNav.isSuiteNavHamburgerVisible");e.supportHamburgerInSuiteNav=new u.t("base.suiteNav.supportHamburgerInSuiteNav");e.isSuiteNavHidden=new u.t("base.suiteNav.isSuiteNavHidden")})(e.suiteNav||(e.suiteNav={}));(function(e){e.transclusionProvider=new u.t("base.commandBar.transclusionProvider");e.isDarkTheme=new u.t("base.commandBar.isDarkTheme");e.isSearchHidden=new u.t("base.commandBar.isSearchHidden")})(e.commandBar||(e.commandBar={}));(function(e){e.isInfoPaneAvailable=new u.t("base.infoPane.isInfoPaneAvailable");e.hidePreview=new u.t("base.infoPane.hidePreview")})(e.infoPane||(e.infoPane={}));(function(e){e.isFiltersPaneAvailable=new u.t("base.filtersPane.isFiltersPaneAvailable")})(e.filtersPane||(e.filtersPane={}));(function(e){e.isColumnCustomizationPaneExpanded=new u.t("base.columnCustomizationPane.isColumnCustomizationPaneExpanded");e.columnToFormat=new u.t("base.columnCustomizationPane.columnToFormat");e.viewToFormat=new u.t("base.columnCustomizationPane.viewToFormat")})(e.columnCustomizationPane||(e.columnCustomizationPane={}));(function(e){e.isPhotosOnly=new u.t("base.oneUpOverlay.isPhotosOnly")})(e.oneUpOverlay||(e.oneUpOverlay={}));(function(e){e.hasFooter=new u.t("base.footer.hasFooter")})(e.footer||(e.footer={}));e.isSPLightSpeed=new u.t("base.isSPLightSpeed");e.isScrollbarHidden=new u.t("base.isScrollbarHidden");e.addPaddingBottom=new u.t("base.addPaddingBottom");e.makeFlexBox=new u.t("base.makeFlexBox");e.contextMenuHelper=new u.t("base.contextMenuHelper");e.isRetrievingData=new u.t("base.isRetrievingData");e.isSmartBannerVisible=new u.t("base.isSmartBannerVisible")})(r||(r={}));(function(e){e.layoutType=new u.t("files.layoutType");e.isArrangeControlVisible=new u.t("files.isArrangeControlVisible")})(i||(i={}));(function(e){e.layoutType=new u.t("photos.layoutType")})(s||(s={}));(function(e){e.layoutType=new u.t("storageInfo.layoutType")})(o||(o={}));var h=new u.t("eventScope")},"1651":function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return o});var r=n(1440),i=n(10),s=n(923),o=new i.t({name:"IsDetailsPaneExpanded.isDetailsPaneExpanded",factory:{dependencies:{detailsPaneId:s.e,observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},"1762":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(1440),i=new(n(10).t)({name:"IsFiltersPaneExpanded.isFiltersPaneExpanded",factory:{dependencies:{observablesFactoryType:r.i},create:function(e){var t=new(0,e.observablesFactoryType)({});return{instance:t.create(!1),disposable:t}}}})},"1796":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Click=1]="Click";e[e.Tap=2]="Tap";e[e.Keyboard=3]="Keyboard";e[e.Drop=4]="Drop"})(r||(r={}))},"1963":function(e,t,n){"use strict";n.d(t,"e",function(){return f});n.d(t,"n",function(){return l});n.d(t,"r",function(){return c});n.d(t,"t",function(){return h});var r=n(0),i=n(47),s=n(97),o={};function u(e){return o[e]}function a(e,t){o[e]=t}function f(e){var t=u(e);if(t){t.end({resultType:i.e.Failure});t=void 0}if(!t){var n={name:e};a(e,t=new s.e(n))}return t}function l(e){p(e,i.e.Success)}function c(e,t){p(e,i.e.Failure,t)}function h(e,t){p(e,i.e.ExpectedFailure,t)}function p(e,t,n){var i=u(e);if(i){var s={resultType:t};n&&(s=Object(r.__assign)(Object(r.__assign)({},s),{resultCode:n.name||"Unknown",error:n.message||"Unknown",extraData:{errorStackTrace:n.stack}}));i.end(s);a(e,void 0)}}},"3447":function(e,t,n){"use strict";n.r(t);n.d(t,"ShowPropertiesAction",function(){return g});var r=n(0),i=n(1454),s=n(1651),o=n(1762),u=n(109),a=n(1462),f=n(1487),l=n(787),c=n(352),h=n(1447),p=n(47),d=n(148),v=n(24),m=n(1963),g=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="ShowProperties";var i=n.isInfoPaneExpanded,u=void 0===i?r.resources.consume(s.resourceKey):i,p=n.isSharingSectionExpanded,d=void 0===p?r.resources.consume(l.x.optional):p,v=n.isInfoPaneAvailable,m=void 0===v?r.resources.consume(f.e.infoPane.isInfoPaneAvailable.optional):v,g=n.isFiltersPaneExpanded,y=void 0===g?r.resources.consume(o.e):g,b=n.isColumnCustomizationPaneExpanded,w=void 0===b?r.resources.consume(f.e.columnCustomizationPane.isColumnCustomizationPaneExpanded.optional):b,E=n.rumOneHelper,S=void 0===E?r.resources.consume(c.e.optional):E,x=n.itemSelectionHelperType,T=void 0===x?r.resources.consume(a.e):x,N=n.engagement,C=void 0===N?r.resources.consume(h.e):N,k=t.useToggleBehavior,L=void 0!==k&&k,A=t.isSharingSectionExpanded,O=void 0!==A&&A,M=t.allowMultiSelect,_=void 0!==M&&M;r._isInfoPaneExpanded=u;r._isSharingSectionExpanded=d;r._isInfoPaneAvailable=m||r.observables.create(!0);r._isFiltersPaneExpanded=y;r._isColumnCustomizationPaneExpanded=w;r._rumOneHelper=S;r._useToggleBehavior=L;r._allowMultiSelect=_;r._shouldExpandSharingSection=O;r._itemSelectionHelper=new(r.scope.attached(T))({allowMultiSelect:r._allowMultiSelect,canFallback:!0,useCurrentSelectionGroup:!0});r._engagement=C;return r}t.prototype.onExecute=function(e){if(!this.isToggled.peek()){this._rumOneHelper&&this._rumOneHelper.logPropertiesPaneLaunch();this._isFiltersPaneExpanded&&this._isFiltersPaneExpanded(!1);this._isColumnCustomizationPaneExpanded&&this._isColumnCustomizationPaneExpanded(!1)}this._isSharingSectionExpanded&&this._isSharingSectionExpanded(this._shouldExpandSharingSection);var t=!this._useToggleBehavior||!this._isInfoPaneExpanded.peek();t&&m.e("LaunchInfoPane");this._engagement.logData({name:"DetailsPane.Click."+(t?"Open":"Close"),isIntentional:!0});this._isInfoPaneExpanded(t);d.default.raise(document.body,"resize",void 0,!0);return u.n.wrap({resultType:p.e.Success})};t.prototype.onIsAvailable=function(){var e=this._isInfoPaneAvailable();if(this._useToggleBehavior&&this._isInfoPaneExpanded())return!0;if(!e)return!1;var t=this._itemSelectionHelper.firstItem;if(!t())return!1;var n=[t];this._allowMultiSelect&&(n=this._itemSelectionHelper.selection());for(var r=0,i=n;r<i.length;r++){var s=i[r];if(s){var o=s();if(o&&(o.error||o.isPlaceholder&&o.queryType!==v.e.Search))return!1}}return!0};t.prototype.onIsToggled=function(){return this._isInfoPaneExpanded()};return t})(i.e);t.default=g}}]);